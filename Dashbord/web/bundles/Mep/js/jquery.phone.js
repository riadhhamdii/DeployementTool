(function($){$.addPhone=function(t,p){if(t.inp){return false}p=$.extend({path:"",label:"",name:"phone",description:"",defaultValue:"",required:0,isControl:0,isAutoComplete:0,autoCompleteProperties:new Array(),rules:new Array(),formatPhone:"",size:0,selectEvent:null},p);var i={populate:function(){$(t).find(".form-label-up").html(p.label);$(t).find(".question-input input:eq(0)").val(p.defaultValue);$(t).find(".description").html(p.description);if(p.formatPhone=="### - ### - ####"){$(t).find(".form-textbox").attr({alt:"phone"});$(t).find(".form-textbox").setMask();if($(t).find(".form-sub-label").size()==1){$(t).find(".form-textbox").setMask();$(t).find(".form-sub-label-container").after('<label class="form-sub-label formatPhone">&nbsp;### - ### - ####</label>')}}else{$(t).find(".formatPhone").remove();$(t).find(".form-textbox").removeAttr("alt");$(t).find(".form-textbox").unsetMask().val("")}if(parseInt(p.isAutoComplete)==1){for($x in p.autoCompleteProperties){switch(parseInt(p.autoCompleteProperties[$x].choice)){case 4:$.destroyAutocomplete("form-textbox");$(t).find(".form-textbox").attr({autocomplete:"on"});break;case 5:$.destroyAutocomplete("form-textbox");$value=(p.autoCompleteProperties[$x].value).split(",");$.initAutoComplete("form-textbox",p.path,$value);break;case 6:$.destroyAutocomplete("form-textbox");$.initAutoComplete("form-textbox",p.path,p.autoCompleteProperties[$x].value);break}}}else{$.destroyAutocomplete("form-textbox")}if(parseInt(p.required)==1){if(!$(t).find(".form-label-up").find("span:last").hasClass("form-required")){$rSpan=$("<span>").addClass("form-required").html("*");$(t).find(".form-label-up").append($rSpan)}}else{if($(t).find(".form-label-up").find("span:last").hasClass("form-required")){$(t).find(".form-label-up").find("span:last").remove()}}if(p.size!=0){if(isNaN(p.size)){$(t).find(".question-input").find("input:first").css("width","302px");$(t).find(".question-input").find("input:first").attr("size","60")}else{if((typeof(p.size)!="undefined")&&(p.size!="")){$(t).find(".question-input input:eq(0)").attr("size",parseInt(p.size));$(t).find(".question-input input:eq(0)").css("width","auto")}else{$(t).find(".question-input input:eq(0)").removeAttr("size");$(t).find(".question-input input:eq(0)").css("width","302px")}}}}};i.gDiv=$("<div>");i.lDiv=$("<label>");i.lSpan=$("<span>");i.rSpan=$("<span>");i.iDiv=$("<div>");i.isDiv=$("<div>");i.pSpan=$("<span>");i.pInput=$("<input>");i.dLabel=$("<label>");i.gDiv.css({display:"inline-block"});i.lDiv.addClass("form-label-up").css({zIndex:100}).width("auto");$(t).before(i.gDiv);$(t).append(i.gDiv);$(i.lDiv).html(p.label);if(parseInt(p.required)==1){$(i.rSpan).addClass("form-required");$(i.rSpan).html("*");$(i.lSpan).append(i.rSpan)}$(i.gDiv).append(i.lDiv);$(i.pInput).attr({name:p.name});$(i.pInput).attr({type:"text"});$(i.pInput).addClass("form-textbox");$(i.pSpan).addClass("form-sub-label-container");$(i.pSpan).append(i.pInput);$(i.iDiv).addClass("form-input");$(i.isDiv).addClass("question-input");$(i.isDiv).append(i.pSpan);$(i.iDiv).append(i.isDiv);$(i.gDiv).append(i.iDiv);$(i.pInput).blur(function(){if($(this).next().hasClass("controls-group")){$(this).next().remove()}if((parseInt(p.isControl)==1)&&(p.rules.length!=0)){$value=$(this).val();for($j=0;$j<p.rules.length;$j++){$test=false;$message="";switch(parseInt(p.rules[$j].choice)){case 1:$begins=eval("/^"+p.rules[$j].value+"/gi");$test=$begins.test($value);$message+='Chaine doit commencer par "'+p.rules[$j].value+'"';break;case 2:$ends=eval("/"+p.rules[$j].value+"$/gi");$test=$ends.test($value);$message+='Chaine doit terminer par "'+p.rules[$j].value+'"';break;case 3:$contains=eval("/"+p.rules[$j].value+"/gi");$test=$contains.test($value);$message+='Chaine doit contenir "'+p.rules[$j].value+'"';break}if(!$test){$.validationEngine.buildPrompt($(this),$message,"error")}else{$.validationEngine.closePrompt(".formError",true)}}}});if(p.formatPhone=="### - ### - ####"){$(i.pInput).attr({alt:"phone"});$(i.pInput).setMask();$(t).find(".form-textbox").setMask();$(t).find(".form-sub-label-container").after('<label class="form-sub-label formatPhone">&nbsp;### - ### - ####</label>')}else{$(t).find(".form-textbox").unsetMask().val("")}$(i.pInput).val(p.defaultValue);if(parseInt(p.isAutoComplete)==1){for($x in p.autoCompleteProperties){switch(parseInt(p.autoCompleteProperties[$x].choice)){case 4:$.destroyAutocomplete("form-textbox");$(t).find(".form-textbox").attr({autocomplete:"on"});break;case 5:$.destroyAutocomplete("form-textbox");$value=(p.autoCompleteProperties[$x].value).split(",");$.initAutoComplete("form-textbox",p.path,$value);break;case 6:$.destroyAutocomplete("form-textbox");$.initAutoComplete("form-textbox",p.path,p.autoCompleteProperties[$x].value);break}}}if((typeof(p.size)!="undefined")&&(p.size!="")){$(t).find(".form-textbox").attr("size",parseInt(p.size));$(t).find(".form-textbox").css("width","auto")}$(i.dLabel).addClass("form-sub-label description").html(p.description);$(i.isDiv).append(i.dLabel);t.p=p;t.inp=i;return t};var docloaded=false;$(document).ready(function(){docloaded=true});$.fn.phone=function(p){return this.each(function(){$.addPhone(this,p)})};$.fn.reload=function(){return this.each(function(){if(this.inp){this.inp.populate()}})};$.fn.options=function(p){return this.each(function(){if(this.inp){$.extend(this.p,p)}})};$.initAutoComplete=function(o,path,options){$pluguinJs=path+"/public/js/generate/pluguins/js/jquery.autoComplete.js";$pluguinCss=path+"/public/js/generate/pluguins/css/jquery.autoComplete.css";$.Loader({url:[$pluguinCss,],dataType:"css",success:function(){$.Loader({url:[$pluguinJs,],dataType:"js",success:function(){$("."+o).autocomplete({source:options})}})}})};$.destroyAutocomplete=function(o){$("."+o).autocomplete("destroy")}})(jQuery);
