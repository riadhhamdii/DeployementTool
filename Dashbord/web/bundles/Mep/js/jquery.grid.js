(function(a){a.jgrid={defaults:{recordtext:"Enregistrements {0} - {1} sur {2}",emptyrecords:"Aucun enregistrement à afficher",loadtext:"Chargement...",pgtext:"Page {0} sur {1}"},search:{caption:"Recherche...",Find:"Chercher",Reset:"Annuler",odata:["égal","différent","inférieur","inférieur ou égal","supérieur","supérieur ou égal","commence par","ne commence pas par","est dans","n'est pas dans","finit par","ne finit pas par","contient","ne contient pas"],groupOps:[{op:"AND",text:"tous"},{op:"OR",text:"aucun"}],matchText:" correspondance",rulesText:" règles"},edit:{addCaption:"Ajouter",editCaption:"Editer",bSubmit:"Valider",bCancel:"Annuler",bClose:"Fermer",saveData:"Les données ont changé ! Enregistrer les modifications ?",bYes:"Oui",bNo:"Non",bExit:"Annuler",msg:{required:"Champ obligatoire",number:"Saisissez un nombre correct",minValue:"La valeur doit être supérieure ou égale à",maxValue:"La valeur doit être inférieure ou égale à",email:"n'est pas un email correct",integer:"Saisissez un entier correct",url:"n'est pas une adresse correcte. Préfixe requis ('http://' or 'https://')",nodefined:" n'est pas défini!",novalue:" la valeur de retour est requise!",customarray:"Une fonction personnalisée devrait retourner un tableau (array)!",customfcheck:"Une fonction personnalisée devrait être présente dans le cas d'une vérification personnalisée!"}},view:{caption:"Voir les enregistrement",bClose:"Fermer"},del:{caption:"Supprimer",msg:"Supprimer les enregistrements sélectionnés ?",bSubmit:"Supprimer",bCancel:"Annuler"},nav:{edittext:" ",edittitle:"Editer la ligne sélectionnée",addtext:" ",addtitle:"Ajouter une ligne",deltext:" ",deltitle:"Supprimer la ligne sélectionnée",searchtext:" ",searchtitle:"Chercher un enregistrement",refreshtext:"",refreshtitle:"Recharger le tableau",alertcap:"Avertissement",alerttext:"Veuillez sélectionner une ligne",viewtext:"",viewtitle:"Afficher la ligne sélectionnée"},col:{caption:"Afficher/Masquer les colonnes",bSubmit:"Valider",bCancel:"Annuler"},errors:{errcap:"Erreur",nourl:"Aucune adresse n'est paramétrée",norecords:"Aucun enregistrement à traiter",model:"Nombre de titres (colNames) <> Nombre de données (colModel)!"},formatter:{integer:{thousandsSeparator:" ",defaultValue:"0"},number:{decimalSeparator:",",thousandsSeparator:" ",decimalPlaces:2,defaultValue:"0,00"},currency:{decimalSeparator:",",thousandsSeparator:" ",decimalPlaces:2,prefix:"",suffix:"",defaultValue:"0,00"},date:{dayNames:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam","Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"],monthNames:["Jan","Fév","Mar","Avr","Mai","Jui","Jul","Aou","Sep","Oct","Nov","Déc","Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Aout","Septembre","Octobre","Novembre","Décembre"],AmPm:["am","pm","AM","PM"],S:function(b){return b==1?"er":"e"},srcformat:"Y-m-d",newformat:"d/m/Y",masks:{ISO8601Long:"Y-m-d H:i:s",ISO8601Short:"Y-m-d",ShortDate:"n/j/Y",LongDate:"l, F d, Y",FullDateTime:"l, F d, Y g:i:s A",MonthDay:"F d",ShortTime:"g:i A",LongTime:"g:i:s A",SortableDateTime:"Y-m-d\\TH:i:s",UniversalSortableDateTime:"Y-m-d H:i:sO",YearMonth:"F, Y"},reformatAfterEdit:false},baseLinkUrl:"",showAction:"",target:"",checkbox:{disabled:true},idName:"id"}}})(jQuery);(function($){$.jgrid=$.jgrid||{};$.extend($.jgrid,{htmlDecode:function(value){if(value&&(value=="&nbsp;"||value=="&#160;"||(value.length==1&&value.charCodeAt(0)==160))){return""}return !value?value:String(value).replace(/&amp;/g,"&").replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"')},htmlEncode:function(value){return !value?value:String(value).replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/\"/g,"&quot;")},format:function(format){var args=$.makeArray(arguments).slice(1);if(format===undefined){format=""}return format.replace(/\{(\d+)\}/g,function(m,i){return args[i]})},getCellIndex:function(cell){var c=$(cell);if(c.is("tr")){return -1}c=(!c.is("td")&&!c.is("th")?c.closest("td,th"):c)[0];if($.browser.msie){return $.inArray(c,c.parentNode.cells)}return c.cellIndex},stripHtml:function(v){v=v+"";var regexp=/<("[^"]*"|'[^']*'|[^'">])*>/gi;if(v){v=v.replace(regexp,"");return(v&&v!=="&nbsp;"&&v!=="&#160;")?v.replace(/\"/g,"'"):""}else{return v}},stringToDoc:function(xmlString){var xmlDoc;if(typeof xmlString!=="string"){return xmlString}try{var parser=new DOMParser();xmlDoc=parser.parseFromString(xmlString,"text/xml")}catch(e){xmlDoc=new ActiveXObject("Microsoft.XMLDOM");xmlDoc.async=false;xmlDoc.loadXML(xmlString)}return(xmlDoc&&xmlDoc.documentElement&&xmlDoc.documentElement.tagName!="parsererror")?xmlDoc:null},parse:function(jsonString){var js=jsonString;if(js.substr(0,9)=="while(1);"){js=js.substr(9)}if(js.substr(0,2)=="/*"){js=js.substr(2,js.length-4)}if(!js){js="{}"}return($.jgrid.useJSON===true&&typeof(JSON)==="object"&&typeof(JSON.parse)==="function")?JSON.parse(js):eval("("+js+")")},parseDate:function(format,date){var tsp={m:1,d:1,y:1970,h:0,i:0,s:0},k,hl,dM,regdate=/[\\\/:_;.,\t\T\s-]/;if(date&&date!==null&&date!==undefined){date=$.trim(date);date=date.split(regdate);format=format.split(regdate);var dfmt=$.jgrid.formatter.date.monthNames;var afmt=$.jgrid.formatter.date.AmPm;var h12to24=function(ampm,h){if(ampm===0){if(h==12){h=0}}else{if(h!=12){h+=12}}return h};for(k=0,hl=format.length;k<hl;k++){if(format[k]=="M"){dM=$.inArray(date[k],dfmt);if(dM!==-1&&dM<12){date[k]=dM+1}}if(format[k]=="F"){dM=$.inArray(date[k],dfmt);if(dM!==-1&&dM>11){date[k]=dM+1-12}}if(format[k]=="a"){dM=$.inArray(date[k],afmt);if(dM!==-1&&dM<2&&date[k]==afmt[dM]){date[k]=dM;tsp.h=h12to24(date[k],tsp.h)}}if(format[k]=="A"){dM=$.inArray(date[k],afmt);if(dM!==-1&&dM>1&&date[k]==afmt[dM]){date[k]=dM-2;tsp.h=h12to24(date[k],tsp.h)}}if(date[k]!==undefined){tsp[format[k].toLowerCase()]=parseInt(date[k],10)}}tsp.m=parseInt(tsp.m,10)-1;var ty=tsp.y;if(ty>=70&&ty<=99){tsp.y=1900+tsp.y}else{if(ty>=0&&ty<=69){tsp.y=2000+tsp.y}}}return new Date(tsp.y,tsp.m,tsp.d,tsp.h,tsp.i,tsp.s,0)},jqID:function(sid){return String(sid).replace(/[!"#$%&'()*+,.\/:;<=>?@\[\\\]\^`{|}~]/g,"\\$&")},guid:1,uidPref:"jqg",randId:function(prefix){return(prefix?prefix:$.jgrid.uidPref)+($.jgrid.guid++)},getAccessor:function(obj,expr){var ret,p,prm=[],i;if(typeof expr==="function"){return expr(obj)}ret=obj[expr];if(ret===undefined){try{if(typeof expr==="string"){prm=expr.split(".")}i=prm.length;if(i){ret=obj;while(ret&&i--){p=prm.shift();ret=ret[p]}}}catch(e){}}return ret},ajaxOptions:{},from:function(source,initalQuery){var queryObject=function(d,q){if(typeof(d)=="string"){d=$.data(d)}var self=this,_data=d,_usecase=true,_trim=false,_query=q,_stripNum=/[\$,%]/g,_lastCommand=null,_lastField=null,_negate=false,_queuedOperator="",_sorting=[],_useProperties=true;if(typeof(d)=="object"&&d.push){if(d.length>0){if(typeof(d[0])!="object"){_useProperties=false}else{_useProperties=true}}}else{throw"data provides is not an array"}this._hasData=function(){return _data===null?false:_data.length===0?false:true};this._getStr=function(s){var phrase=[];if(_trim){phrase.push("jQuery.trim(")}phrase.push("String("+s+")");if(_trim){phrase.push(")")}if(!_usecase){phrase.push(".toLowerCase()")}return phrase.join("")};this._strComp=function(val){if(typeof(val)=="string"){return".toString()"}else{return""}};this._group=function(f,u){return({field:f.toString(),unique:u,items:[]})};this._toStr=function(phrase){if(_trim){phrase=$.trim(phrase)}if(!_usecase){phrase=phrase.toLowerCase()}phrase=phrase.toString().replace(/\\/g,"\\\\").replace(/\"/g,'\\"');return phrase};this._funcLoop=function(func){var results=[];$.each(_data,function(i,v){results.push(func(v))});return results};this._append=function(s){if(_query===null){_query=""}else{_query+=_queuedOperator===""?" && ":_queuedOperator}if(_negate){_query+="!"}_query+="("+s+")";_negate=false;_queuedOperator=""};this._setCommand=function(f,c){_lastCommand=f;_lastField=c};this._resetNegate=function(){_negate=false};this._repeatCommand=function(f,v){if(_lastCommand===null){return self}if(f!==null&&v!==null){return _lastCommand(f,v)}if(_lastField===null){return _lastCommand(f)}if(!_useProperties){return _lastCommand(f)}return _lastCommand(_lastField,f)};this._equals=function(a,b){return(self._compare(a,b,1)===0)};this._compare=function(a,b,d){if(d===undefined){d=1}if(a===undefined){a=null}if(b===undefined){b=null}if(a===null&&b===null){return 0}if(a===null&&b!==null){return 1}if(a!==null&&b===null){return -1}if(!_usecase&&typeof(a)!=="number"&&typeof(b)!=="number"){a=String(a).toLowerCase();b=String(b).toLowerCase()}if(a<b){return -d}if(a>b){return d}return 0};this._performSort=function(){if(_sorting.length===0){return}_data=self._doSort(_data,0)};this._doSort=function(d,q){var by=_sorting[q].by,dir=_sorting[q].dir,type=_sorting[q].type,dfmt=_sorting[q].datefmt;if(q==_sorting.length-1){return self._getOrder(d,by,dir,type,dfmt)}q++;var values=self._getGroup(d,by,dir,type,dfmt);var results=[];for(var i=0;i<values.length;i++){var sorted=self._doSort(values[i].items,q);for(var j=0;j<sorted.length;j++){results.push(sorted[j])}}return results};this._getOrder=function(data,by,dir,type,dfmt){var sortData=[],_sortData=[],newDir=dir=="a"?1:-1,i,ab,j,findSortKey;if(type===undefined){type="text"}if(type=="float"||type=="number"||type=="currency"||type=="numeric"){findSortKey=function($cell,a){var key=parseFloat(String($cell).replace(_stripNum,""));return isNaN(key)?0:key}}else{if(type=="int"||type=="integer"){findSortKey=function($cell,a){return $cell?parseFloat(String($cell).replace(_stripNum,"")):0}}else{if(type=="date"||type=="datetime"){findSortKey=function($cell,a){return $.jgrid.parseDate(dfmt,$cell).getTime()}}else{if($.isFunction(type)){findSortKey=type}else{findSortKey=function($cell,a){if(!$cell){$cell=""}return $.trim(String($cell).toUpperCase())}}}}}$.each(data,function(i,v){ab=by!==""?$.jgrid.getAccessor(v,by):v;if(ab===undefined){ab=""}ab=findSortKey(ab,v);_sortData.push({vSort:ab,index:i})});_sortData.sort(function(a,b){a=a.vSort;b=b.vSort;return self._compare(a,b,newDir)});j=0;var nrec=data.length;while(j<nrec){i=_sortData[j].index;sortData.push(data[i]);j++}return sortData};this._getGroup=function(data,by,dir,type,dfmt){var results=[],group=null,last=null,val;$.each(self._getOrder(data,by,dir,type,dfmt),function(i,v){val=$.jgrid.getAccessor(v,by);if(val===undefined){val=""}if(!self._equals(last,val)){last=val;if(group!==null){results.push(group)}group=self._group(by,val)}group.items.push(v)});if(group!==null){results.push(group)}return results};this.ignoreCase=function(){_usecase=false;return self};this.useCase=function(){_usecase=true;return self};this.trim=function(){_trim=true;return self};this.noTrim=function(){_trim=false;return self};this.execute=function(){var match=_query,results=[];if(match===null){return self}$.each(_data,function(){if(eval(match)){results.push(this)}});_data=results;return self};this.data=function(){return _data};this.select=function(f){self._performSort();if(!self._hasData()){return[]}self.execute();if($.isFunction(f)){var results=[];$.each(_data,function(i,v){results.push(f(v))});return results}return _data};this.hasMatch=function(f){if(!self._hasData()){return false}self.execute();return _data.length>0};this.andNot=function(f,v,x){_negate=!_negate;return self.and(f,v,x)};this.orNot=function(f,v,x){_negate=!_negate;return self.or(f,v,x)};this.not=function(f,v,x){return self.andNot(f,v,x)};this.and=function(f,v,x){_queuedOperator=" && ";if(f===undefined){return self}return self._repeatCommand(f,v,x)};this.or=function(f,v,x){_queuedOperator=" || ";if(f===undefined){return self}return self._repeatCommand(f,v,x)};this.isNot=function(f){_negate=!_negate;return self.is(f)};this.is=function(f){self._append("this."+f);self._resetNegate();return self};this._compareValues=function(func,f,v,how,t){var fld;if(_useProperties){fld="jQuery.jgrid.getAccessor(this,'"+f+"')"}else{fld="this"}if(v===undefined){v=null}var val=v,swst=t.stype===undefined?"text":t.stype;if(v!==null){switch(swst){case"int":case"integer":val=(isNaN(Number(val))||val==="")?"0":val;fld="parseInt("+fld+",10)";val="parseInt("+val+",10)";break;case"float":case"number":case"numeric":val=String(val).replace(_stripNum,"");val=(isNaN(Number(val))||val==="")?"0":val;fld="parseFloat("+fld+")";val="parseFloat("+val+")";break;case"date":case"datetime":val=String($.jgrid.parseDate(t.newfmt||"Y-m-d",val).getTime());fld='jQuery.jgrid.parseDate("'+t.srcfmt+'",'+fld+").getTime()";break;default:fld=self._getStr(fld);val=self._getStr('"'+self._toStr(val)+'"')}}self._append(fld+" "+how+" "+val);self._setCommand(func,f);self._resetNegate();return self};this.equals=function(f,v,t){return self._compareValues(self.equals,f,v,"==",t)};this.notEquals=function(f,v,t){return self._compareValues(self.equals,f,v,"!==",t)};this.isNull=function(f,v,t){return self._compareValues(self.equals,f,null,"===",t)};this.greater=function(f,v,t){return self._compareValues(self.greater,f,v,">",t)};this.less=function(f,v,t){return self._compareValues(self.less,f,v,"<",t)};this.greaterOrEquals=function(f,v,t){return self._compareValues(self.greaterOrEquals,f,v,">=",t)};this.lessOrEquals=function(f,v,t){return self._compareValues(self.lessOrEquals,f,v,"<=",t)};this.startsWith=function(f,v){var val=(v===undefined||v===null)?f:v,length=_trim?$.trim(val.toString()).length:val.toString().length;if(_useProperties){self._append(self._getStr("jQuery.jgrid.getAccessor(this,'"+f+"')")+".substr(0,"+length+") == "+self._getStr('"'+self._toStr(v)+'"'))}else{length=_trim?$.trim(v.toString()).length:v.toString().length;self._append(self._getStr("this")+".substr(0,"+length+") == "+self._getStr('"'+self._toStr(f)+'"'))}self._setCommand(self.startsWith,f);self._resetNegate();return self};this.endsWith=function(f,v){var val=(v===undefined||v===null)?f:v,length=_trim?$.trim(val.toString()).length:val.toString().length;if(_useProperties){self._append(self._getStr("jQuery.jgrid.getAccessor(this,'"+f+"')")+".substr("+self._getStr("jQuery.jgrid.getAccessor(this,'"+f+"')")+".length-"+length+","+length+') == "'+self._toStr(v)+'"')}else{self._append(self._getStr("this")+".substr("+self._getStr("this")+'.length-"'+self._toStr(f)+'".length,"'+self._toStr(f)+'".length) == "'+self._toStr(f)+'"')}self._setCommand(self.endsWith,f);self._resetNegate();return self};this.contains=function(f,v){if(_useProperties){self._append(self._getStr("jQuery.jgrid.getAccessor(this,'"+f+"')")+'.indexOf("'+self._toStr(v)+'",0) > -1')}else{self._append(self._getStr("this")+'.indexOf("'+self._toStr(f)+'",0) > -1')}self._setCommand(self.contains,f);self._resetNegate();return self};this.groupBy=function(by,dir,type,datefmt){if(!self._hasData()){return null}return self._getGroup(_data,by,dir,type,datefmt)};this.orderBy=function(by,dir,stype,dfmt){dir=dir===undefined||dir===null?"a":$.trim(dir.toString().toLowerCase());if(stype===null||stype===undefined){stype="text"}if(dfmt===null||dfmt===undefined){dfmt="Y-m-d"}if(dir=="desc"||dir=="descending"){dir="d"}if(dir=="asc"||dir=="ascending"){dir="a"}_sorting.push({by:by,dir:dir,type:stype,datefmt:dfmt});return self};return self};return new queryObject(source,null)},extend:function(methods){$.extend($.fn.jqGrid,methods);if(!this.no_legacy_api){$.fn.extend(methods)}}});$.fn.jqGrid=function(pin){if(typeof pin=="string"){var fn=$.jgrid.getAccessor($.fn.jqGrid,pin);if(!fn){throw ("jqGrid - No such method: "+pin)}var args=$.makeArray(arguments).slice(1);return fn.apply(this,args)}return this.each(function(){if(this.grid){return}var p=$.extend(true,{url:"",height:150,page:1,rowNum:20,rowTotal:null,records:0,pager:"",pgbuttons:true,pginput:true,colModel:[],rowList:[],colNames:[],sortorder:"asc",sortname:"",datatype:"xml",mtype:"GET",altRows:false,selarrrow:[],savedRow:[],shrinkToFit:true,xmlReader:{},jsonReader:{},subGrid:false,subGridModel:[],reccount:0,lastpage:0,lastsort:0,selrow:null,beforeSelectRow:null,onSelectRow:null,onSortCol:null,ondblClickRow:null,onRightClickRow:null,onPaging:null,onSelectAll:null,loadComplete:null,gridComplete:null,loadError:null,loadBeforeSend:null,afterInsertRow:null,beforeRequest:null,onHeaderClick:null,viewrecords:false,loadonce:false,multiselect:false,multikey:false,editurl:null,search:false,caption:"",hidegrid:true,hidecolumn:false,hiddengrid:false,postData:{},userData:{},treeGrid:false,treeGridModel:"nested",treeReader:{},treeANode:-1,ExpandColumn:null,tree_root_level:0,prmNames:{page:"page",rows:"rows",sort:"sidx",order:"sord",search:"_search",nd:"nd",id:"id",oper:"oper",editoper:"edit",addoper:"add",deloper:"del",subgridid:"id",npage:null,totalrows:"totalrows"},forceFit:false,gridstate:"visible",cellEdit:false,cellsubmit:"remote",nv:0,loadui:"enable",toolbar:[false,""],scroll:false,multiboxonly:false,deselectAfterSort:true,scrollrows:false,autowidth:false,scrollOffset:18,cellLayout:5,subGridWidth:20,multiselectWidth:20,gridview:false,rownumWidth:25,rownumbers:false,pagerpos:"center",recordpos:"right",footerrow:false,userDataOnFooter:false,hoverrows:true,altclass:"ui-priority-secondary",viewsortcols:[false,"vertical",true],resizeclass:"",autoencode:false,remapColumns:[],ajaxGridOptions:{},direction:"ltr",toppager:false,headertitles:false,scrollTimeout:40,data:[],_index:{},grouping:false,groupingView:{groupField:[],groupOrder:[],groupText:[],groupColumnShow:[],groupSummary:[],showSummaryOnHide:false,sortitems:[],sortnames:[],groupDataSorted:false,summary:[],summaryval:[],plusicon:"ui-icon-circlesmall-plus",minusicon:"ui-icon-circlesmall-minus"},ignoreCase:false,cmTemplate:{}},$.jgrid.defaults,pin||{});var grid={headers:[],cols:[],footers:[],dragStart:function(i,x,y){this.resizing={idx:i,startX:x.clientX,sOL:y[0]};this.hDiv.style.cursor="col-resize";this.curGbox=$("#rs_m"+$.jgrid.jqID(p.id),"#gbox_"+$.jgrid.jqID(p.id));this.curGbox.css({display:"block",left:y[0],top:y[1],height:y[2]});if($.isFunction(p.resizeStart)){p.resizeStart.call(this,x,i)}document.onselectstart=function(){return false}},dragMove:function(x){if(this.resizing){var diff=x.clientX-this.resizing.startX,h=this.headers[this.resizing.idx],newWidth=p.direction==="ltr"?h.width+diff:h.width-diff,hn,nWn;if(newWidth>33){this.curGbox.css({left:this.resizing.sOL+diff});if(p.forceFit===true){hn=this.headers[this.resizing.idx+p.nv];nWn=p.direction==="ltr"?hn.width-diff:hn.width+diff;if(nWn>33){h.newWidth=newWidth;hn.newWidth=nWn}}else{this.newWidth=p.direction==="ltr"?p.tblwidth+diff:p.tblwidth-diff;h.newWidth=newWidth}}}},dragEnd:function(){this.hDiv.style.cursor="default";if(this.resizing){var idx=this.resizing.idx,nw=this.headers[idx].newWidth||this.headers[idx].width;nw=parseInt(nw,10);this.resizing=false;$("#rs_m"+$.jgrid.jqID(p.id)).css("display","none");p.colModel[idx].width=nw;this.headers[idx].width=nw;this.headers[idx].el.style.width=nw+"px";this.cols[idx].style.width=nw+"px";if(this.footers.length>0){this.footers[idx].style.width=nw+"px"}if(p.forceFit===true){nw=this.headers[idx+p.nv].newWidth||this.headers[idx+p.nv].width;this.headers[idx+p.nv].width=nw;this.headers[idx+p.nv].el.style.width=nw+"px";this.cols[idx+p.nv].style.width=nw+"px";if(this.footers.length>0){this.footers[idx+p.nv].style.width=nw+"px"}p.colModel[idx+p.nv].width=nw}else{p.tblwidth=this.newWidth||p.tblwidth;$("table:first",this.bDiv).css("width",p.tblwidth+"px");$("table:first",this.hDiv).css("width",p.tblwidth+"px");this.hDiv.scrollLeft=this.bDiv.scrollLeft;if(p.footerrow){$("table:first",this.sDiv).css("width",p.tblwidth+"px");this.sDiv.scrollLeft=this.bDiv.scrollLeft}}if($.isFunction(p.resizeStop)){p.resizeStop.call(this,nw,idx)}}this.curGbox=null;document.onselectstart=function(){return true}},populateVisible:function(){if(grid.timer){clearTimeout(grid.timer)}grid.timer=null;var dh=$(grid.bDiv).height();if(!dh){return}var table=$("table:first",grid.bDiv);var rows,rh;if(table[0].rows.length){try{rows=table[0].rows[1];rh=rows?$(rows).outerHeight()||grid.prevRowHeight:grid.prevRowHeight}catch(pv){rh=grid.prevRowHeight}}if(!rh){return}grid.prevRowHeight=rh;var rn=p.rowNum;var scrollTop=grid.scrollTop=grid.bDiv.scrollTop;var ttop=Math.round(table.position().top)-scrollTop;var tbot=ttop+table.height();var div=rh*rn;var page,npage,empty;if(tbot<dh&&ttop<=0&&(p.lastpage===undefined||parseInt((tbot+scrollTop+div-1)/div,10)<=p.lastpage)){npage=parseInt((dh-tbot+div-1)/div,10);if(tbot>=0||npage<2||p.scroll===true){page=Math.round((tbot+scrollTop)/div)+1;ttop=-1}else{ttop=1}}if(ttop>0){page=parseInt(scrollTop/div,10)+1;npage=parseInt((scrollTop+dh)/div,10)+2-page;empty=true}if(npage){if(p.lastpage&&page>p.lastpage||p.lastpage==1||(page===p.page&&page===p.lastpage)){return}if(grid.hDiv.loading){grid.timer=setTimeout(grid.populateVisible,p.scrollTimeout)}else{p.page=page;if(empty){grid.selectionPreserver(table[0]);grid.emptyRows(grid.bDiv,false,false)}grid.populate(npage)}}},scrollGrid:function(e){if(p.scroll){var scrollTop=grid.bDiv.scrollTop;if(grid.scrollTop===undefined){grid.scrollTop=0}if(scrollTop!=grid.scrollTop){grid.scrollTop=scrollTop;if(grid.timer){clearTimeout(grid.timer)}grid.timer=setTimeout(grid.populateVisible,p.scrollTimeout)}}grid.hDiv.scrollLeft=grid.bDiv.scrollLeft;if(p.footerrow){grid.sDiv.scrollLeft=grid.bDiv.scrollLeft}if(e){e.stopPropagation()}},selectionPreserver:function(ts){var p=ts.p;var sr=p.selrow,sra=p.selarrrow?$.makeArray(p.selarrrow):null;var left=ts.grid.bDiv.scrollLeft;var complete=p.gridComplete;p.gridComplete=function(){p.selrow=null;p.selarrrow=[];if(p.multiselect&&sra&&sra.length>0){for(var i=0;i<sra.length;i++){if(sra[i]!=sr){$(ts).jqGrid("setSelection",sra[i],false)}}}if(sr){$(ts).jqGrid("setSelection",sr,false)}ts.grid.bDiv.scrollLeft=left;p.gridComplete=complete;if(p.gridComplete){complete()}}}};if(this.tagName.toUpperCase()!="TABLE"){alert("Element is not a table");return}$(this).empty().attr("tabindex","1");this.p=p;var i,dir,ts;if(this.p.colNames.length===0){for(i=0;i<this.p.colModel.length;i++){this.p.colNames[i]=this.p.colModel[i].label||this.p.colModel[i].name}}if(this.p.colNames.length!==this.p.colModel.length){alert($.jgrid.errors.model);return}var gv=$("<div class='ui-jqgrid-view'></div>"),ii,isMSIE=$.browser.msie?true:false,isSafari=$.browser.webkit||$.browser.safari?true:false;ts=this;ts.p.direction=$.trim(ts.p.direction.toLowerCase());if($.inArray(ts.p.direction,["ltr","rtl"])==-1){ts.p.direction="ltr"}dir=ts.p.direction;$(gv).insertBefore(this);$(this).appendTo(gv).removeClass("scroll");var eg=$("<div class='ui-jqgrid ui-widget-grid ui-widget-content-grid ui-corner-all-grid'></div>");$(eg).insertBefore(gv).attr({id:"gbox_"+this.id,dir:dir});$(gv).appendTo(eg).attr("id","gview_"+this.id);if(isMSIE&&$.browser.version<=6){ii='<iframe style="display:block;position:absolute;z-index:-1;filter:Alpha(Opacity=\'0\');" src="javascript:false;"></iframe>'}else{ii=""}$("<div class='ui-widget-overlay jqgrid-overlay' id='lui_"+this.id+"'></div>").append(ii).insertBefore(gv);$("<div class='loading ui-state-default-grid ui-state-active' id='load_"+this.id+"'>"+this.p.loadtext+"</div>").insertBefore(gv);$(this).attr({cellspacing:"0",cellpadding:"0",border:"0",role:"grid","aria-multiselectable":!!this.p.multiselect,"aria-labelledby":"gbox_"+this.id});var sortkeys=["shiftKey","altKey","ctrlKey"],intNum=function(val,defval){val=parseInt(val,10);if(isNaN(val)){return defval?defval:0}else{return val}},formatCol=function(pos,rowInd,tv,rawObject,rowId,rdata){var cm=ts.p.colModel[pos],ral=cm.align,result='style="',clas=cm.classes,nm=cm.name,celp,acp=[];if(ral){result+="text-align:"+ral+";"}if(cm.hidden===true){result+="display:none;"}if(rowInd===0){result+="width: "+grid.headers[pos].width+"px;"}else{if(cm.cellattr&&$.isFunction(cm.cellattr)){celp=cm.cellattr.call(ts,rowId,tv,rawObject,cm,rdata);if(celp&&typeof(celp)==="string"){celp=celp.replace(/style/i,"style").replace(/title/i,"title");if(celp.indexOf("title")>-1){cm.title=false}if(celp.indexOf("class")>-1){clas=undefined}acp=celp.split("style");if(acp.length===2){acp[1]=$.trim(acp[1].replace("=",""));if(acp[1].indexOf("'")===0||acp[1].indexOf('"')===0){acp[1]=acp[1].substring(1)}result+=acp[1].replace(/'/gi,'"')}else{result+='"'}}}}if(!acp.length){acp[0]="";result+='"'}result+=(clas!==undefined?(' class="'+clas+'"'):"")+((cm.title&&tv)?(' title="'+$.jgrid.stripHtml(tv)+'"'):"");result+=' aria-describedby="'+ts.p.id+"_"+nm+'"';return result+acp[0]},cellVal=function(val){return val===undefined||val===null||val===""?"&#160;":(ts.p.autoencode?$.jgrid.htmlEncode(val):val+"")},formatter=function(rowId,cellval,colpos,rwdat,_act){var cm=ts.p.colModel[colpos],v;if(typeof cm.formatter!=="undefined"){var opts={rowId:rowId,colModel:cm,gid:ts.p.id,pos:colpos};if($.isFunction(cm.formatter)){v=cm.formatter.call(ts,cellval,opts,rwdat,_act)}else{if($.fmatter){v=$.fn.fmatter(cm.formatter,cellval,opts,rwdat,_act)}else{v=cellVal(cellval)}}}else{v=cellVal(cellval)}return v},addCell=function(rowId,cell,pos,irow,srvr){var v,prp;v=formatter(rowId,cell,pos,srvr,"add");prp=formatCol(pos,irow,v,srvr,rowId,true);return'<td role="gridcell" '+prp+">"+v+"</td>"},addMulti=function(rowid,pos,irow){var v='<input role="checkbox" type="checkbox" id="jqg_'+ts.p.id+"_"+rowid+'" class="cbox" name="jqg_'+ts.p.id+"_"+rowid+'"/>',prp=formatCol(pos,irow,"",null,rowid,true);return'<td role="gridcell" '+prp+">"+v+"</td>"},addRowNum=function(pos,irow,pG,rN){var v=(parseInt(pG,10)-1)*parseInt(rN,10)+1+irow,prp=formatCol(pos,irow,v,null,irow,true);return'<td role="gridcell" class="ui-state-default-grid jqgrid-rownum" '+prp+">"+v+"</td>"},reader=function(datatype){var field,f=[],j=0,i;for(i=0;i<ts.p.colModel.length;i++){field=ts.p.colModel[i];if(field.name!=="cb"&&field.name!=="subgrid"&&field.name!=="rn"){if(datatype=="local"){f[j]=field.name}else{f[j]=(datatype=="xml")?field.xmlmap||field.name:field.jsonmap||field.name}j++}}return f},orderedCols=function(offset){var order=ts.p.remapColumns;if(!order||!order.length){order=$.map(ts.p.colModel,function(v,i){return i})}if(offset){order=$.map(order,function(v){return v<offset?null:v-offset})}return order},emptyRows=function(parent,scroll,locdata){if(ts.p.deepempty){$("#"+$.jgrid.jqID(ts.p.id)+" tbody:first tr:gt(0)").remove()}else{var trf=$("#"+$.jgrid.jqID(ts.p.id)+" tbody:first tr:first")[0];$("#"+$.jgrid.jqID(ts.p.id)+" tbody:first").empty().append(trf)}if(scroll&&ts.p.scroll){$(">div:first",parent).css({height:"auto"}).children("div:first").css({height:0,display:"none"});parent.scrollTop=0}if(locdata===true){if(ts.p.treeGrid===true){ts.p.data=[];ts.p._index={}}}},refreshIndex=function(){var datalen=ts.p.data.length,idname,i,val,ni=ts.p.rownumbers===true?1:0,gi=ts.p.multiselect===true?1:0,si=ts.p.subGrid===true?1:0;if(ts.p.keyIndex===false||ts.p.loadonce===true){idname=ts.p.localReader.id}else{idname=ts.p.colModel[ts.p.keyIndex+gi+si+ni].name}for(i=0;i<datalen;i++){val=$.jgrid.getAccessor(ts.p.data[i],idname);ts.p._index[val]=i}},addXmlData=function(xml,t,rcnt,more,adjust){var startReq=new Date(),locdata=(ts.p.datatype!="local"&&ts.p.loadonce)||ts.p.datatype=="xmlstring",xmlid="_id_",frd=ts.p.datatype=="local"?"local":"xml";if(locdata){ts.p.data=[];ts.p._index={};ts.p.localReader.id=xmlid}ts.p.reccount=0;if($.isXMLDoc(xml)){if(ts.p.treeANode===-1&&!ts.p.scroll){emptyRows(t,false,true);rcnt=1}else{rcnt=rcnt>1?rcnt:1}}else{return}var i,fpos,ir=0,v,row,gi=0,si=0,ni=0,idn,getId,f=[],F,rd={},xmlr,rid,rowData=[],cn=(ts.p.altRows===true)?" "+ts.p.altclass:"",cn1;if(!ts.p.xmlReader.repeatitems){f=reader(frd)}if(ts.p.keyIndex===false){idn=ts.p.xmlReader.id}else{idn=ts.p.keyIndex}if(f.length>0&&!isNaN(idn)){if(ts.p.remapColumns&&ts.p.remapColumns.length){idn=$.inArray(idn,ts.p.remapColumns)}idn=f[idn]}if((idn+"").indexOf("[")===-1){if(f.length){getId=function(trow,k){return $(idn,trow).text()||k}}else{getId=function(trow,k){return $(ts.p.xmlReader.cell,trow).eq(idn).text()||k}}}else{getId=function(trow,k){return trow.getAttribute(idn.replace(/[\[\]]/g,""))||k}}ts.p.userData={};$(ts.p.xmlReader.page,xml).each(function(){ts.p.page=this.textContent||this.text||0});$(ts.p.xmlReader.total,xml).each(function(){ts.p.lastpage=this.textContent||this.text;if(ts.p.lastpage===undefined){ts.p.lastpage=1}});$(ts.p.xmlReader.records,xml).each(function(){ts.p.records=this.textContent||this.text||0});$(ts.p.xmlReader.userdata,xml).each(function(){ts.p.userData[this.getAttribute("name")]=this.textContent||this.text});var gxml=$(ts.p.xmlReader.root+" "+ts.p.xmlReader.row,xml);if(!gxml){gxml=[]}var gl=gxml.length,j=0,grpdata={},rn;if(gxml&&gl){rn=parseInt(ts.p.rowNum,10);var br=ts.p.scroll?$.jgrid.randId():1,altr;if(adjust){rn*=adjust+1}var afterInsRow=$.isFunction(ts.p.afterInsertRow),hiderow="";if(ts.p.grouping&&ts.p.groupingView.groupCollapse===true){hiderow=' style="display:none;"'}while(j<gl){xmlr=gxml[j];rid=getId(xmlr,br+j);altr=rcnt===0?0:rcnt+1;cn1=(altr+j)%2==1?cn:"";rowData.push("<tr"+hiderow+' id="'+rid+'" tabindex="-1" role="row" class ="ui-widget-content-grid jqgrow ui-row-'+ts.p.direction+""+cn1+'">');if(ts.p.rownumbers===true){rowData.push(addRowNum(0,j,ts.p.page,ts.p.rowNum));ni=1}if(ts.p.multiselect===true){rowData.push(addMulti(rid,ni,j));gi=1}if(ts.p.subGrid===true){rowData.push($(ts).jqGrid("addSubGridCell",gi+ni,j+rcnt));si=1}if(ts.p.xmlReader.repeatitems){if(!F){F=orderedCols(gi+si+ni)}var cells=$(ts.p.xmlReader.cell,xmlr);$.each(F,function(k){var cell=cells[this];if(!cell){return false}v=cell.textContent||cell.text;rd[ts.p.colModel[k+gi+si+ni].name]=v;rowData.push(addCell(rid,v,k+gi+si+ni,j+rcnt,xmlr))})}else{for(i=0;i<f.length;i++){v=$(f[i],xmlr).text();rd[ts.p.colModel[i+gi+si+ni].name]=v;rowData.push(addCell(rid,v,i+gi+si+ni,j+rcnt,xmlr))}}rowData.push("</tr>");if(ts.p.grouping){var grlen=ts.p.groupingView.groupField.length,grpitem=[];for(var z=0;z<grlen;z++){grpitem.push(rd[ts.p.groupingView.groupField[z]])}grpdata=$(ts).jqGrid("groupingPrepare",rowData,grpitem,grpdata,rd);rowData=[]}if(locdata||ts.p.treeGrid===true){rd[xmlid]=rid;ts.p.data.push(rd);ts.p._index[rid]=ts.p.data.length-1}if(ts.p.gridview===false){$("tbody:first",t).append(rowData.join(""));if(afterInsRow){ts.p.afterInsertRow.call(ts,rid,rd,xmlr)}rowData=[]}rd={};ir++;j++;if(ir==rn){break}}}if(ts.p.gridview===true){fpos=ts.p.treeANode>-1?ts.p.treeANode:0;if(ts.p.grouping){$(ts).jqGrid("groupingRender",grpdata,ts.p.colModel.length);grpdata=null}else{if(ts.p.treeGrid===true&&fpos>0){$(ts.rows[fpos]).after(rowData.join(""))}else{$("tbody:first",t).append(rowData.join(""))}}}if(ts.p.subGrid===true){try{$(ts).jqGrid("addSubGrid",gi+ni)}catch(_){}}ts.p.totaltime=new Date()-startReq;if(ir>0){if(ts.p.records===0){ts.p.records=gl}}rowData=null;if(ts.p.treeGrid===true){try{$(ts).jqGrid("setTreeNode",fpos+1,ir+fpos+1)}catch(e){}}if(!ts.p.treeGrid&&!ts.p.scroll){ts.grid.bDiv.scrollTop=0}ts.p.reccount=ir;ts.p.treeANode=-1;if(ts.p.userDataOnFooter){$(ts).jqGrid("footerData","set",ts.p.userData,true)}if(locdata){ts.p.records=gl;ts.p.lastpage=Math.ceil(gl/rn)}if(!more){ts.updatepager(false,true)}if(locdata){while(ir<gl){xmlr=gxml[ir];rid=getId(xmlr,ir);if(ts.p.xmlReader.repeatitems){if(!F){F=orderedCols(gi+si+ni)}var cells2=$(ts.p.xmlReader.cell,xmlr);$.each(F,function(k){var cell=cells2[this];if(!cell){return false}v=cell.textContent||cell.text;rd[ts.p.colModel[k+gi+si+ni].name]=v})}else{for(i=0;i<f.length;i++){v=$(f[i],xmlr).text();rd[ts.p.colModel[i+gi+si+ni].name]=v}}rd[xmlid]=rid;ts.p.data.push(rd);ts.p._index[rid]=ts.p.data.length-1;rd={};ir++}}},addJSONData=function(data,t,rcnt,more,adjust){var startReq=new Date();if(data){if(ts.p.treeANode===-1&&!ts.p.scroll){emptyRows(t,false,true);rcnt=1}else{rcnt=rcnt>1?rcnt:1}}else{return}var dReader,locid="_id_",frd,locdata=(ts.p.datatype!="local"&&ts.p.loadonce)||ts.p.datatype=="jsonstring";if(locdata){ts.p.data=[];ts.p._index={};ts.p.localReader.id=locid}ts.p.reccount=0;if(ts.p.datatype=="local"){dReader=ts.p.localReader;frd="local"}else{dReader=ts.p.jsonReader;frd="json"}var ir=0,v,i,j,f=[],F,cur,gi=0,si=0,ni=0,len,drows,idn,rd={},fpos,idr,rowData=[],cn=(ts.p.altRows===true)?" "+ts.p.altclass:"",cn1,lp;ts.p.page=$.jgrid.getAccessor(data,dReader.page)||0;lp=$.jgrid.getAccessor(data,dReader.total);ts.p.lastpage=lp===undefined?1:lp;ts.p.records=$.jgrid.getAccessor(data,dReader.records)||0;ts.p.userData=$.jgrid.getAccessor(data,dReader.userdata)||{};if(!dReader.repeatitems){F=f=reader(frd)}if(ts.p.keyIndex===false){idn=dReader.id}else{idn=ts.p.keyIndex}if(f.length>0&&!isNaN(idn)){if(ts.p.remapColumns&&ts.p.remapColumns.length){idn=$.inArray(idn,ts.p.remapColumns)}idn=f[idn]}drows=$.jgrid.getAccessor(data,dReader.root);if(!drows){drows=[]}len=drows.length;i=0;var rn=parseInt(ts.p.rowNum,10),br=ts.p.scroll?$.jgrid.randId():1,altr;if(adjust){rn*=adjust+1}var afterInsRow=$.isFunction(ts.p.afterInsertRow),grpdata={},hiderow="";if(ts.p.grouping&&ts.p.groupingView.groupCollapse===true){hiderow=' style="display:none;"'}while(i<len){cur=drows[i];idr=$.jgrid.getAccessor(cur,idn);if(idr===undefined){idr=br+i;if(f.length===0){if(dReader.cell){var ccur=$.jgrid.getAccessor(cur,dReader.cell);idr=ccur[idn]||idr;ccur=null}}}altr=rcnt===1?0:rcnt;cn1=(altr+i)%2==1?cn:"";rowData.push("<tr"+hiderow+' id="'+idr+'" tabindex="-1" role="row" class= "ui-widget-content-grid jqgrow ui-row-'+ts.p.direction+""+cn1+'">');if(ts.p.rownumbers===true){rowData.push(addRowNum(0,i,ts.p.page,ts.p.rowNum));ni=1}if(ts.p.multiselect){rowData.push(addMulti(idr,ni,i));gi=1}if(ts.p.subGrid){rowData.push($(ts).jqGrid("addSubGridCell",gi+ni,i+rcnt));si=1}if(dReader.repeatitems){if(dReader.cell){cur=$.jgrid.getAccessor(cur,dReader.cell)}if(!F){F=orderedCols(gi+si+ni)}}for(j=0;j<F.length;j++){v=$.jgrid.getAccessor(cur,F[j]);rowData.push(addCell(idr,v,j+gi+si+ni,i+rcnt,cur));rd[ts.p.colModel[j+gi+si+ni].name]=v}rowData.push("</tr>");if(ts.p.grouping){var grlen=ts.p.groupingView.groupField.length,grpitem=[];for(var z=0;z<grlen;z++){grpitem.push(rd[ts.p.groupingView.groupField[z]])}grpdata=$(ts).jqGrid("groupingPrepare",rowData,grpitem,grpdata,rd);rowData=[]}if(locdata||ts.p.treeGrid===true){rd[locid]=idr;ts.p.data.push(rd);ts.p._index[idr]=ts.p.data.length-1}if(ts.p.gridview===false){$("#"+$.jgrid.jqID(ts.p.id)+" tbody:first").append(rowData.join(""));if(afterInsRow){ts.p.afterInsertRow.call(ts,idr,rd,cur)}rowData=[]}rd={};ir++;i++;if(ir==rn){break}}if(ts.p.gridview===true){fpos=ts.p.treeANode>-1?ts.p.treeANode:0;if(ts.p.grouping){$(ts).jqGrid("groupingRender",grpdata,ts.p.colModel.length);grpdata=null}else{if(ts.p.treeGrid===true&&fpos>0){$(ts.rows[fpos]).after(rowData.join(""))}else{$("#"+$.jgrid.jqID(ts.p.id)+" tbody:first").append(rowData.join(""))}}}if(ts.p.subGrid===true){try{$(ts).jqGrid("addSubGrid",gi+ni)}catch(_){}}ts.p.totaltime=new Date()-startReq;if(ir>0){if(ts.p.records===0){ts.p.records=len}}rowData=null;if(ts.p.treeGrid===true){try{$(ts).jqGrid("setTreeNode",fpos+1,ir+fpos+1)}catch(e){}}if(!ts.p.treeGrid&&!ts.p.scroll){ts.grid.bDiv.scrollTop=0}ts.p.reccount=ir;ts.p.treeANode=-1;if(ts.p.userDataOnFooter){$(ts).jqGrid("footerData","set",ts.p.userData,true)}if(locdata){ts.p.records=len;ts.p.lastpage=Math.ceil(len/rn)}if(!more){ts.updatepager(false,true)}if(locdata){while(ir<len&&drows[ir]){cur=drows[ir];idr=$.jgrid.getAccessor(cur,idn);if(idr===undefined){idr=br+ir;if(f.length===0){if(dReader.cell){var ccur2=$.jgrid.getAccessor(cur,dReader.cell);idr=ccur2[idn]||idr;ccur2=null}}}if(cur){if(dReader.repeatitems){if(dReader.cell){cur=$.jgrid.getAccessor(cur,dReader.cell)}if(!F){F=orderedCols(gi+si+ni)}}for(j=0;j<F.length;j++){v=$.jgrid.getAccessor(cur,F[j]);rd[ts.p.colModel[j+gi+si+ni].name]=v}rd[locid]=idr;ts.p.data.push(rd);ts.p._index[idr]=ts.p.data.length-1;rd={}}ir++}}},addLocalData=function(){var st,fndsort=false,cmtypes={},grtypes=[],grindexes=[],srcformat,sorttype,newformat;if(!$.isArray(ts.p.data)){return}var grpview=ts.p.grouping?ts.p.groupingView:false;$.each(ts.p.colModel,function(i,v){sorttype=this.sorttype||"text";if(sorttype=="date"||sorttype=="datetime"){if(this.formatter&&typeof(this.formatter)==="string"&&this.formatter=="date"){if(this.formatoptions&&this.formatoptions.srcformat){srcformat=this.formatoptions.srcformat}else{srcformat=$.jgrid.formatter.date.srcformat}if(this.formatoptions&&this.formatoptions.newformat){newformat=this.formatoptions.newformat}else{newformat=$.jgrid.formatter.date.newformat}}else{srcformat=newformat=this.datefmt||"Y-m-d"}cmtypes[this.name]={stype:sorttype,srcfmt:srcformat,newfmt:newformat}}else{cmtypes[this.name]={stype:sorttype,srcfmt:"",newfmt:""}}if(ts.p.grouping&&this.name==grpview.groupField[0]){var grindex=this.name;if(typeof this.index!="undefined"){grindex=this.index}grtypes[0]=cmtypes[grindex];grindexes.push(grindex)}if(!fndsort&&(this.index==ts.p.sortname||this.name==ts.p.sortname)){st=this.name;fndsort=true}});if(ts.p.treeGrid){$(ts).jqGrid("SortTree",st,ts.p.sortorder,cmtypes[st].stype,cmtypes[st].srcfmt);return}var compareFnMap={eq:function(queryObj,op){return queryObj.equals},ne:function(queryObj,op){return queryObj.notEquals},lt:function(queryObj,op){return queryObj.less},le:function(queryObj,op){return queryObj.lessOrEquals},gt:function(queryObj,op){return queryObj.greater},ge:function(queryObj,op){return queryObj.greaterOrEquals},cn:function(queryObj,op){return queryObj.contains},nc:function(queryObj,op){return op==="OR"?queryObj.orNot().contains:queryObj.andNot().contains},bw:function(queryObj,op){return queryObj.startsWith},bn:function(queryObj,op){return op==="OR"?queryObj.orNot().startsWith:queryObj.andNot().startsWith},en:function(queryObj,op){return op==="OR"?queryObj.orNot().endsWith:queryObj.andNot().endsWith},ew:function(queryObj,op){return queryObj.endsWith},ni:function(queryObj,op){return op==="OR"?queryObj.orNot().equals:queryObj.andNot().equals},"in":function(queryObj,op){return queryObj.equals},nu:function(queryObj,op){return queryObj.isNull},nn:function(queryObj,op){return op==="OR"?queryObj.orNot().isNull:queryObj.andNot().isNull}},query=$.jgrid.from(ts.p.data);if(ts.p.ignoreCase){query=query.ignoreCase()}function tojLinq(group){var s=0,index,opr,rule;if(group.groups!==undefined){for(index=0;index<group.groups.length;index++){try{tojLinq(group.groups[index])}catch(e){alert(e)}s++}}if(group.rules!==undefined){if(s>0){var result=query.select();query=$.jgrid.from(result)}try{for(index=0;index<group.rules.length;index++){rule=group.rules[index];opr=group.groupOp.toString().toUpperCase();if(compareFnMap[rule.op]&&rule.field){if(s>0&&opr&&opr==="OR"){query=query.or()}query=compareFnMap[rule.op](query,opr)(rule.field,rule.data,cmtypes[rule.field])}s++}}catch(g){alert(g)}}}if(ts.p.search===true){var srules=ts.p.postData.filters;if(srules){if(typeof srules=="string"){srules=$.jgrid.parse(srules)}tojLinq(srules)}else{try{query=compareFnMap[ts.p.postData.searchOper](query)(ts.p.postData.searchField,ts.p.postData.searchString,cmtypes[ts.p.postData.searchField])}catch(se){}}}if(ts.p.grouping){query.orderBy(grindexes,grpview.groupOrder[0],grtypes[0].stype,grtypes[0].srcfmt);grpview.groupDataSorted=true}if(st&&ts.p.sortorder&&fndsort){if(ts.p.sortorder.toUpperCase()=="DESC"){query.orderBy(ts.p.sortname,"d",cmtypes[st].stype,cmtypes[st].srcfmt)}else{query.orderBy(ts.p.sortname,"a",cmtypes[st].stype,cmtypes[st].srcfmt)}}var queryResults=query.select(),recordsperpage=parseInt(ts.p.rowNum,10),total=queryResults.length,page=parseInt(ts.p.page,10),totalpages=Math.ceil(total/recordsperpage),retresult={};queryResults=queryResults.slice((page-1)*recordsperpage,page*recordsperpage);query=null;cmtypes=null;retresult[ts.p.localReader.total]=totalpages;retresult[ts.p.localReader.page]=page;retresult[ts.p.localReader.records]=total;retresult[ts.p.localReader.root]=queryResults;queryResults=null;return retresult},updatepager=function(rn,dnd){var cp,last,base,from,to,tot,fmt,pgboxes="",sppg,tspg=ts.p.pager?"_"+$.jgrid.jqID(ts.p.pager.substr(1)):"",tspg_t=ts.p.toppager?"_"+ts.p.toppager.substr(1):"";base=parseInt(ts.p.page,10)-1;if(base<0){base=0}base=base*parseInt(ts.p.rowNum,10);to=base+ts.p.reccount;if(ts.p.scroll){var rows=$("tbody:first > tr:gt(0)",ts.grid.bDiv);base=to-rows.length;ts.p.reccount=rows.length;var rh=rows.outerHeight()||ts.grid.prevRowHeight;if(rh){var top=base*rh;var height=parseInt(ts.p.records,10)*rh;$(">div:first",ts.grid.bDiv).css({height:height}).children("div:first").css({height:top,display:top?"":"none"})}ts.grid.bDiv.scrollLeft=ts.grid.hDiv.scrollLeft}pgboxes=ts.p.pager?ts.p.pager:"";pgboxes+=ts.p.toppager?(pgboxes?","+ts.p.toppager:ts.p.toppager):"";if(pgboxes){fmt=$.jgrid.formatter.integer||{};cp=intNum(ts.p.page);last=intNum(ts.p.lastpage);$(".selbox",pgboxes).attr("disabled",false);if(ts.p.pginput===true){$(".ui-pg-input",pgboxes).val(ts.p.page);sppg=ts.p.toppager?"#sp_1"+tspg+",#sp_1"+tspg_t:"#sp_1"+tspg;$(sppg).html($.fmatter?$.fmatter.util.NumberFormat(ts.p.lastpage,fmt):ts.p.lastpage)}if(ts.p.viewrecords){if(ts.p.reccount===0){$(".ui-paging-info",pgboxes).html(ts.p.emptyrecords)}else{from=base+1;tot=ts.p.records;if($.fmatter){from=$.fmatter.util.NumberFormat(from,fmt);to=$.fmatter.util.NumberFormat(to,fmt);tot=$.fmatter.util.NumberFormat(tot,fmt)}$(".ui-paging-info",pgboxes).html($.jgrid.format(ts.p.recordtext,from,to,tot))}}if(ts.p.pgbuttons===true){if(cp<=0){cp=last=0}if(cp==1||cp===0){$("#first"+tspg+", #prev"+tspg).addClass("ui-state-disabled").removeClass("ui-state-hover");if(ts.p.toppager){$("#first_t"+tspg_t+", #prev_t"+tspg_t).addClass("ui-state-disabled").removeClass("ui-state-hover")}}else{$("#first"+tspg+", #prev"+tspg).removeClass("ui-state-disabled");if(ts.p.toppager){$("#first_t"+tspg_t+", #prev_t"+tspg_t).removeClass("ui-state-disabled")}}if(cp==last||cp===0){$("#next"+tspg+", #last"+tspg).addClass("ui-state-disabled").removeClass("ui-state-hover");if(ts.p.toppager){$("#next_t"+tspg_t+", #last_t"+tspg_t).addClass("ui-state-disabled").removeClass("ui-state-hover")}}else{$("#next"+tspg+", #last"+tspg).removeClass("ui-state-disabled");if(ts.p.toppager){$("#next_t"+tspg_t+", #last_t"+tspg_t).removeClass("ui-state-disabled")}}}}if(rn===true&&ts.p.rownumbers===true){$("td.jqgrid-rownum",ts.rows).each(function(i){$(this).html(base+1+i)})}if(dnd&&ts.p.jqgdnd){$(ts).jqGrid("gridDnD","updateDnD")}if($.isFunction(ts.p.gridComplete)){ts.p.gridComplete.call(ts)}},beginReq=function(){ts.grid.hDiv.loading=true;if(ts.p.hiddengrid){return}switch(ts.p.loadui){case"disable":break;case"enable":$("#load_"+$.jgrid.jqID(ts.p.id)).show();break;case"block":$("#lui_"+$.jgrid.jqID(ts.p.id)).show();$("#load_"+$.jgrid.jqID(ts.p.id)).show();break}},endReq=function(){ts.grid.hDiv.loading=false;switch(ts.p.loadui){case"disable":break;case"enable":$("#load_"+$.jgrid.jqID(ts.p.id)).hide();break;case"block":$("#lui_"+$.jgrid.jqID(ts.p.id)).hide();$("#load_"+$.jgrid.jqID(ts.p.id)).hide();break}},populate=function(npage){if(!ts.grid.hDiv.loading){var pvis=ts.p.scroll&&npage===false;var prm={},dt,dstr,pN=ts.p.prmNames;if(ts.p.page<=0){ts.p.page=1}if(pN.search!==null){prm[pN.search]=ts.p.search}if(pN.nd!==null){prm[pN.nd]=new Date().getTime()}if(pN.rows!==null){prm[pN.rows]=ts.p.rowNum}if(pN.page!==null){prm[pN.page]=ts.p.page}if(pN.sort!==null){prm[pN.sort]=ts.p.sortname}if(pN.order!==null){prm[pN.order]=ts.p.sortorder}if(ts.p.rowTotal!==null&&pN.totalrows!==null){prm[pN.totalrows]=ts.p.rowTotal}var lc=ts.p.loadComplete;var lcf=$.isFunction(lc);if(!lcf){lc=null}var adjust=0;npage=npage||1;if(npage>1){if(pN.npage!==null){prm[pN.npage]=npage;adjust=npage-1;npage=1}else{lc=function(req){ts.p.page++;ts.grid.hDiv.loading=false;if(lcf){ts.p.loadComplete.call(ts,req)}populate(npage-1)}}}else{if(pN.npage!==null){delete ts.p.postData[pN.npage]}}if(ts.p.grouping){$(ts).jqGrid("groupingSetup");if(ts.p.groupingView.groupDataSorted===true){prm[pN.sort]=ts.p.groupingView.groupField[0]+" "+ts.p.groupingView.groupOrder[0]+", "+prm[pN.sort]}}$.extend(ts.p.postData,prm);var rcnt=!ts.p.scroll?1:ts.rows.length-1;if($.isFunction(ts.p.datatype)){ts.p.datatype.call(ts,ts.p.postData,"load_"+ts.p.id);return}else{if($.isFunction(ts.p.beforeRequest)){ts.p.beforeRequest.call(ts)}}dt=ts.p.datatype.toLowerCase();switch(dt){case"json":case"jsonp":case"xml":case"script":$.ajax($.extend({url:ts.p.url,type:ts.p.mtype,dataType:dt,data:$.isFunction(ts.p.serializeGridData)?ts.p.serializeGridData.call(ts,ts.p.postData):ts.p.postData,success:function(data,st){if(dt==="xml"){addXmlData(data,ts.grid.bDiv,rcnt,npage>1,adjust)}else{addJSONData(data,ts.grid.bDiv,rcnt,npage>1,adjust)}if(lc){lc.call(ts,data)}if(pvis){ts.grid.populateVisible()}if(ts.p.loadonce||ts.p.treeGrid){ts.p.datatype="local"}data=null;endReq()},error:function(xhr,st,err){if($.isFunction(ts.p.loadError)){ts.p.loadError.call(ts,xhr,st,err)}endReq();xhr=null},beforeSend:function(xhr){beginReq();if($.isFunction(ts.p.loadBeforeSend)){ts.p.loadBeforeSend.call(ts,xhr)}}},$.jgrid.ajaxOptions,ts.p.ajaxGridOptions));break;case"xmlstring":beginReq();dstr=$.jgrid.stringToDoc(ts.p.datastr);addXmlData(dstr,ts.grid.bDiv);if(lcf){ts.p.loadComplete.call(ts,dstr)}ts.p.datatype="local";ts.p.datastr=null;endReq();break;case"jsonstring":beginReq();if(typeof ts.p.datastr=="string"){dstr=$.jgrid.parse(ts.p.datastr)}else{dstr=ts.p.datastr}addJSONData(dstr,ts.grid.bDiv);if(lcf){ts.p.loadComplete.call(ts,dstr)}ts.p.datatype="local";ts.p.datastr=null;endReq();break;case"local":case"clientside":beginReq();ts.p.datatype="local";var req=addLocalData();addJSONData(req,ts.grid.bDiv,rcnt,npage>1,adjust);if(lc){lc.call(ts,req)}if(pvis){ts.grid.populateVisible()}endReq();break}}},setPager=function(pgid,tp){var sep="<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='ui-separator'></span></td>",pginp="",pgl="<table cellspacing='0' cellpadding='0' border='0' style='table-layout:auto;' class='ui-pg-table'><tbody><tr>",str="",pgcnt,lft,cent,rgt,twd,tdw,i,clearVals=function(onpaging){var ret;if($.isFunction(ts.p.onPaging)){ret=ts.p.onPaging.call(ts,onpaging)}ts.p.selrow=null;if(ts.p.multiselect){ts.p.selarrrow=[];$("#cb_"+$.jgrid.jqID(ts.p.id),ts.grid.hDiv).attr("checked",false)}ts.p.savedRow=[];if(ret=="stop"){return false}return true};pgid=pgid.substr(1);tp+="_"+pgid;pgcnt="pg_"+pgid;lft=pgid+"_left";cent=pgid+"_center";rgt=pgid+"_right";$("#"+$.jgrid.jqID(pgid)).append("<div id='"+pgcnt+"' class='ui-pager-control' role='group'><table cellspacing='0' cellpadding='0' border='0' class='ui-pg-table' style='width:100%;table-layout:fixed;height:100%;' role='row'><tbody><tr><td id='"+lft+"' align='left'></td><td id='"+cent+"' align='center' style='white-space:pre;'></td><td id='"+rgt+"' align='right'></td></tr></tbody></table></div>").attr("dir","ltr");if(ts.p.rowList.length>0){str="<td dir='"+dir+"'>";str+="<select class='ui-pg-selbox' role='listbox'>";for(i=0;i<ts.p.rowList.length;i++){str+='<option role="option" value="'+ts.p.rowList[i]+'"'+((ts.p.rowNum==ts.p.rowList[i])?' selected="selected"':"")+">"+ts.p.rowList[i]+"</option>"}str+="</select></td>"}if(dir=="rtl"){pgl+=str}if(ts.p.pginput===true){pginp="<td dir='"+dir+"'>"+$.jgrid.format(ts.p.pgtext||"","<input class='ui-pg-input' type='text' size='2' maxlength='7' value='0' role='textbox'/>","<span id='sp_1_"+$.jgrid.jqID(pgid)+"'></span>")+"</td>"}if(ts.p.pgbuttons===true){var po=["first"+tp,"prev"+tp,"next"+tp,"last"+tp];if(dir=="rtl"){po.reverse()}pgl+="<td id='"+po[0]+"' class='ui-pg-button ui-corner-all-grid'><span class='ui-icon-os ui-icon-seek-first'></span></td>";pgl+="<td id='"+po[1]+"' class='ui-pg-button ui-corner-all-grid'><span class='ui-icon-os ui-icon-seek-prev'></span></td>";pgl+=pginp!==""?sep+pginp+sep:"";pgl+="<td id='"+po[2]+"' class='ui-pg-button ui-corner-all-grid'><span class='ui-icon-os ui-icon-seek-next'></span></td>";pgl+="<td id='"+po[3]+"' class='ui-pg-button ui-corner-all-grid'><span class='ui-icon-os ui-icon-seek-end'></span></td>"}else{if(pginp!==""){pgl+=pginp}}if(dir=="ltr"){pgl+=str}pgl+="</tr></tbody></table>";if(ts.p.viewrecords===true){$("td#"+pgid+"_"+ts.p.recordpos,"#"+pgcnt).append("<div dir='"+dir+"' style='text-align:"+ts.p.recordpos+"' class='ui-paging-info'></div>")}$("td#"+pgid+"_"+ts.p.pagerpos,"#"+pgcnt).append(pgl);tdw=$(".ui-jqgrid").css("font-size")||"11px";$(document.body).append("<div id='testpg' class='ui-jqgrid ui-widget-grid ui-widget-content-grid' style='font-size:"+tdw+";visibility:hidden;' ></div>");twd=$(pgl).clone().appendTo("#testpg").width();$("#testpg").remove();if(twd>0){if(pginp!==""){twd+=50}$("td#"+pgid+"_"+ts.p.pagerpos,"#"+pgcnt).width(twd)}ts.p._nvtd=[];ts.p._nvtd[0]=twd?Math.floor((ts.p.width-twd)/2):Math.floor(ts.p.width/3);ts.p._nvtd[1]=0;pgl=null;$(".ui-pg-selbox","#"+pgcnt).bind("change",function(){ts.p.page=Math.round(ts.p.rowNum*(ts.p.page-1)/this.value-0.5)+1;ts.p.rowNum=this.value;if(tp){$(".ui-pg-selbox",ts.p.pager).val(this.value)}else{if(ts.p.toppager){$(".ui-pg-selbox",ts.p.toppager).val(this.value)}}if(!clearVals("records")){return false}populate();return false});if(ts.p.pgbuttons===true){$(".ui-pg-button","#"+pgcnt).hover(function(e){if($(this).hasClass("ui-state-disabled")){this.style.cursor="default"}else{$(this).addClass("ui-state-hover");this.style.cursor="pointer"}},function(e){if($(this).hasClass("ui-state-disabled")){}else{$(this).removeClass("ui-state-hover");this.style.cursor="default"}});$("#first"+$.jgrid.jqID(tp)+", #prev"+$.jgrid.jqID(tp)+", #next"+$.jgrid.jqID(tp)+", #last"+$.jgrid.jqID(tp)).click(function(e){var cp=intNum(ts.p.page,1),last=intNum(ts.p.lastpage,1),selclick=false,fp=true,pp=true,np=true,lp=true;if(last===0||last===1){fp=false;pp=false;np=false;lp=false}else{if(last>1&&cp>=1){if(cp===1){fp=false;pp=false}else{if(cp>1&&cp<last){}else{if(cp===last){np=false;lp=false}}}}else{if(last>1&&cp===0){np=false;lp=false;cp=last-1}}}if(this.id==="first"+tp&&fp){ts.p.page=1;selclick=true}if(this.id==="prev"+tp&&pp){ts.p.page=(cp-1);selclick=true}if(this.id==="next"+tp&&np){ts.p.page=(cp+1);selclick=true}if(this.id==="last"+tp&&lp){ts.p.page=last;selclick=true}if(selclick){if(!clearVals(this.id)){return false}populate()}return false})}if(ts.p.pginput===true){$("input.ui-pg-input","#"+pgcnt).keypress(function(e){var key=e.charCode?e.charCode:e.keyCode?e.keyCode:0;if(key==13){ts.p.page=($(this).val()>0)?$(this).val():ts.p.page;if(!clearVals("user")){return false}populate();return false}return this})}},sortData=function(index,idxcol,reload,sor){if(!ts.p.colModel[idxcol].sortable){return}var so;if(ts.p.savedRow.length>0){return}if(!reload){if(ts.p.lastsort==idxcol){if(ts.p.sortorder=="asc"){ts.p.sortorder="desc"}else{if(ts.p.sortorder=="desc"){ts.p.sortorder="asc"}}}else{ts.p.sortorder=ts.p.colModel[idxcol].firstsortorder||"asc"}ts.p.page=1}if(sor){if(ts.p.lastsort==idxcol&&ts.p.sortorder==sor&&!reload){return}else{ts.p.sortorder=sor}}var thd=$("thead:first",ts.grid.hDiv).get(0);$("tr th:eq("+ts.p.lastsort+") span.ui-grid-ico-sort",thd).addClass("ui-state-disabled");$("tr th:eq("+ts.p.lastsort+")",thd).attr("aria-selected","false");$("tr th:eq("+idxcol+") span.ui-icon-"+ts.p.sortorder,thd).removeClass("ui-state-disabled");$("tr th:eq("+idxcol+")",thd).attr("aria-selected","true");if(!ts.p.viewsortcols[0]){if(ts.p.lastsort!=idxcol){$("tr th:eq("+ts.p.lastsort+") span.s-ico",thd).hide();$("tr th:eq("+idxcol+") span.s-ico",thd).show()}}index=index.substring(5);ts.p.sortname=ts.p.colModel[idxcol].index||index;so=ts.p.sortorder;if($.isFunction(ts.p.onSortCol)){if(ts.p.onSortCol.call(ts,index,idxcol,so)=="stop"){ts.p.lastsort=idxcol;return}}if(ts.p.datatype=="local"){if(ts.p.deselectAfterSort){$(ts).jqGrid("resetSelection")}}else{ts.p.selrow=null;if(ts.p.multiselect){$("#cb_"+$.jgrid.jqID(ts.p.id),ts.grid.hDiv).attr("checked",false)}ts.p.selarrrow=[];ts.p.savedRow=[]}if(ts.p.scroll){var sscroll=ts.grid.bDiv.scrollLeft;emptyRows(ts.grid.bDiv,true,false);ts.grid.hDiv.scrollLeft=sscroll}if(ts.p.subGrid&&ts.p.datatype=="local"){$("td.sgexpanded","#"+$.jgrid.jqID(ts.p.id)).each(function(){$(this).trigger("click")})}populate();ts.p.lastsort=idxcol;if(ts.p.sortname!=index&&idxcol){ts.p.lastsort=idxcol}},setColWidth=function(){var initwidth=0,brd=isSafari?0:ts.p.cellLayout,vc=0,lvc,scw=ts.p.scrollOffset,cw,hs=false,aw,gw=0,cl=0,cr;$.each(ts.p.colModel,function(i){if(typeof this.hidden==="undefined"){this.hidden=false}this.widthOrg=cw=intNum(this.width,0);if(this.hidden===false){initwidth+=cw+brd;if(this.fixed){gw+=cw+brd}else{vc++}cl++}});if(isNaN(ts.p.width)){ts.p.width=grid.width=initwidth}else{grid.width=ts.p.width}ts.p.tblwidth=initwidth;if(ts.p.shrinkToFit===false&&ts.p.forceFit===true){ts.p.forceFit=false}if(ts.p.shrinkToFit===true&&vc>0){aw=grid.width-brd*vc-gw;if(isNaN(ts.p.height)){}else{aw-=scw;hs=true}initwidth=0;$.each(ts.p.colModel,function(i){if(this.hidden===false&&!this.fixed){cw=Math.round(aw*this.width/(ts.p.tblwidth-brd*vc-gw));this.width=cw;initwidth+=cw;lvc=i}});cr=0;if(hs){if(grid.width-gw-(initwidth+brd*vc)!==scw){cr=grid.width-gw-(initwidth+brd*vc)-scw}}else{if(!hs&&Math.abs(grid.width-gw-(initwidth+brd*vc))!==1){cr=grid.width-gw-(initwidth+brd*vc)}}ts.p.colModel[lvc].width+=cr;ts.p.tblwidth=initwidth+cr+brd*vc+gw;if(ts.p.tblwidth>ts.p.width){ts.p.colModel[lvc].width-=(ts.p.tblwidth-parseInt(ts.p.width,10));ts.p.tblwidth=ts.p.width}}},nextVisible=function(iCol){var ret=iCol,j=iCol,i;for(i=iCol+1;i<ts.p.colModel.length;i++){if(ts.p.colModel[i].hidden!==true){j=i;break}}return j-ret},getOffset=function(iCol){var i,ret={},brd1=isSafari?0:ts.p.cellLayout;ret[0]=ret[1]=ret[2]=0;for(i=0;i<=iCol;i++){if(ts.p.colModel[i].hidden===false){ret[0]+=ts.p.colModel[i].width+brd1}}if(ts.p.direction=="rtl"){ret[0]=ts.p.width-ret[0]}ret[0]=ret[0]-ts.grid.bDiv.scrollLeft;if($(ts.grid.cDiv).is(":visible")){ret[1]+=$(ts.grid.cDiv).height()+parseInt($(ts.grid.cDiv).css("padding-top"),10)+parseInt($(ts.grid.cDiv).css("padding-bottom"),10)}if(ts.p.toolbar[0]===true&&(ts.p.toolbar[1]=="top"||ts.p.toolbar[1]=="both")){ret[1]+=$(ts.grid.uDiv).height()+parseInt($(ts.grid.uDiv).css("border-top-width"),10)+parseInt($(ts.grid.uDiv).css("border-bottom-width"),10)}if(ts.p.toppager){ret[1]+=$(ts.grid.topDiv).height()+parseInt($(ts.grid.topDiv).css("border-bottom-width"),10)}ret[2]+=$(ts.grid.bDiv).height()+$(ts.grid.hDiv).height();return ret};this.p.id=this.id;if($.inArray(ts.p.multikey,sortkeys)==-1){ts.p.multikey=false}ts.p.keyIndex=false;for(i=0;i<ts.p.colModel.length;i++){ts.p.colModel[i]=$.extend(true,{},ts.p.cmTemplate,ts.p.colModel[i].template||{},ts.p.colModel[i]);if(ts.p.keyIndex===false&&ts.p.colModel[i].key===true){ts.p.keyIndex=i}}ts.p.sortorder=ts.p.sortorder.toLowerCase();if(ts.p.grouping===true){ts.p.scroll=false;ts.p.rownumbers=false;ts.p.subGrid=false;ts.p.treeGrid=false;ts.p.gridview=true}if(this.p.treeGrid===true){try{$(this).jqGrid("setTreeGrid")}catch(_){}if(ts.p.datatype!="local"){ts.p.localReader={id:"_id_"}}}if(this.p.subGrid){try{$(ts).jqGrid("setSubGrid")}catch(s){}}if(this.p.multiselect){this.p.colNames.unshift("<input role='checkbox' id='cb_"+this.p.id+"' class='cbox' type='checkbox'/>");this.p.colModel.unshift({name:"cb",width:isSafari?ts.p.multiselectWidth+ts.p.cellLayout:ts.p.multiselectWidth,sortable:false,resizable:false,hidedlg:true,search:false,align:"center",fixed:true})}if(this.p.rownumbers){this.p.colNames.unshift("");this.p.colModel.unshift({name:"rn",width:ts.p.rownumWidth,sortable:false,resizable:false,hidedlg:true,search:false,align:"center",fixed:true})}ts.p.xmlReader=$.extend(true,{root:"rows",row:"row",page:"rows>page",total:"rows>total",records:"rows>records",repeatitems:true,cell:"cell",id:"[id]",userdata:"userdata",subgrid:{root:"rows",row:"row",repeatitems:true,cell:"cell"}},ts.p.xmlReader);ts.p.jsonReader=$.extend(true,{root:"rows",page:"page",total:"total",records:"records",repeatitems:true,cell:"cell",id:"id",userdata:"userdata",subgrid:{root:"rows",repeatitems:true,cell:"cell"}},ts.p.jsonReader);ts.p.localReader=$.extend(true,{root:"rows",page:"page",total:"total",records:"records",repeatitems:false,cell:"cell",id:"id",userdata:"userdata",subgrid:{root:"rows",repeatitems:true,cell:"cell"}},ts.p.localReader);if(ts.p.scroll){ts.p.pgbuttons=false;ts.p.pginput=false;ts.p.rowList=[]}if(ts.p.data.length){refreshIndex()}var thead="<thead><tr class='ui-jqgrid-labels' role='rowheader'>",tdc,idn,w,res,sort,td,ptr,tbody,imgs,iac="",idc="";if(ts.p.shrinkToFit===true&&ts.p.forceFit===true){for(i=ts.p.colModel.length-1;i>=0;i--){if(!ts.p.colModel[i].hidden){ts.p.colModel[i].resizable=false;break}}}if(ts.p.viewsortcols[1]=="horizontal"){iac=" ui-i-asc";idc=" ui-i-desc"}tdc=isMSIE?"class='ui-th-div-ie'":"";imgs="<span class='s-ico' style='display:none'><span sort='asc' class='ui-grid-ico-sort ui-icon-asc"+iac+" ui-state-disabled ui-icon-os ui-icon-triangle-1-n ui-sort-"+dir+"'></span>";imgs+="<span sort='desc' class='ui-grid-ico-sort ui-icon-desc"+idc+" ui-state-disabled ui-icon-os ui-icon-triangle-1-s ui-sort-"+dir+"'></span></span>";for(i=0;i<this.p.colNames.length;i++){var tooltip=ts.p.headertitles?(' title="'+$.jgrid.stripHtml(ts.p.colNames[i])+'"'):"";thead+="<th id='"+ts.p.id+"_"+ts.p.colModel[i].name+"' role='columnheader' class='ui-state-default-grid ui-th-column ui-th-"+dir+"'"+tooltip+">";idn=ts.p.colModel[i].index||ts.p.colModel[i].name;thead+="<div id='jqgh_"+ts.p.id+"_"+ts.p.colModel[i].name+"' "+tdc+">"+ts.p.colNames[i];if(!ts.p.colModel[i].width){ts.p.colModel[i].width=150}else{ts.p.colModel[i].width=parseInt(ts.p.colModel[i].width,10)}if(typeof(ts.p.colModel[i].title)!=="boolean"){ts.p.colModel[i].title=true}if(idn==ts.p.sortname){ts.p.lastsort=i}thead+=imgs+"</div></th>"}thead+="</tr></thead>";imgs=null;$(this).append(thead);$("thead tr:first th",this).hover(function(){$(this).addClass("ui-state-hover")},function(){$(this).removeClass("ui-state-hover")});if(this.p.multiselect){var emp=[],chk;$("#cb_"+$.jgrid.jqID(ts.p.id),this).bind("click",function(){ts.p.selarrrow=[];if(this.checked){$(ts.rows).each(function(i){if(i>0){if(!$(this).hasClass("subgrid")&&!$(this).hasClass("jqgroup")&&!$(this).hasClass("ui-state-disabled")){$("#jqg_"+$.jgrid.jqID(ts.p.id)+"_"+$.jgrid.jqID(this.id)).attr("checked","checked");$(this).addClass("ui-state-highlight").attr("aria-selected","true");ts.p.selarrrow.push(this.id);ts.p.selrow=this.id}}});chk=true;emp=[]}else{$(ts.rows).each(function(i){if(i>0){if(!$(this).hasClass("subgrid")&&!$(this).hasClass("ui-state-disabled")){$("#jqg_"+$.jgrid.jqID(ts.p.id)+"_"+$.jgrid.jqID(this.id)).removeAttr("checked");$(this).removeClass("ui-state-highlight").attr("aria-selected","false");emp.push(this.id)}}});ts.p.selrow=null;chk=false}if($.isFunction(ts.p.onSelectAll)){ts.p.onSelectAll.call(ts,chk?ts.p.selarrrow:emp,chk)}})}if(ts.p.autowidth===true){var pw=$(eg).innerWidth();ts.p.width=pw>0?pw:"nw"}setColWidth();$(eg).css("width",grid.width+"px").append("<div class='ui-jqgrid-resize-mark' id='rs_m"+ts.p.id+"'>&#160;</div>");$(gv).css("width",grid.width+"px");thead=$("thead:first",ts).get(0);var tfoot="";if(ts.p.footerrow){tfoot+="<table role='grid' style='width:"+ts.p.tblwidth+"px' class='ui-jqgrid-ftable' cellspacing='0' cellpadding='0' border='0'><tbody><tr role='row' class='ui-widget-content-grid footrow footrow-"+dir+"'>"}var thr=$("tr:first",thead),firstr="<tr class='jqgfirstrow' role='row' style='height:auto'>";ts.p.disableClick=false;$("th",thr).each(function(j){w=ts.p.colModel[j].width;if(typeof ts.p.colModel[j].resizable==="undefined"){ts.p.colModel[j].resizable=true}if(ts.p.colModel[j].resizable){res=document.createElement("span");$(res).html("&#160;").addClass("ui-jqgrid-resize ui-jqgrid-resize-"+dir);if(!$.browser.opera){$(res).css("cursor","col-resize")}$(this).addClass(ts.p.resizeclass)}else{res=""}$(this).css("width",w+"px").prepend(res);var hdcol="";if(ts.p.colModel[j].hidden){$(this).css("display","none");hdcol="display:none;"}firstr+="<td role='gridcell' style='height:0px;width:"+w+"px;"+hdcol+"'></td>";grid.headers[j]={width:w,el:this};sort=ts.p.colModel[j].sortable;if(typeof sort!=="boolean"){ts.p.colModel[j].sortable=true;sort=true}var nm=ts.p.colModel[j].name;if(!(nm=="cb"||nm=="subgrid"||nm=="rn")){if(ts.p.viewsortcols[2]){$("div",this).addClass("ui-jqgrid-sortable")}}if(sort){if(ts.p.viewsortcols[0]){$("div span.s-ico",this).show();if(j==ts.p.lastsort){$("div span.ui-icon-"+ts.p.sortorder,this).removeClass("ui-state-disabled")}}else{if(j==ts.p.lastsort){$("div span.s-ico",this).show();$("div span.ui-icon-"+ts.p.sortorder,this).removeClass("ui-state-disabled")}}}if(ts.p.footerrow){tfoot+="<td role='gridcell' "+formatCol(j,0,"",null,"",false)+">&#160;</td>"}}).mousedown(function(e){if($(e.target).closest("th>span.ui-jqgrid-resize").length!=1){return}var ci=$.jgrid.getCellIndex(this);if(ts.p.forceFit===true){ts.p.nv=nextVisible(ci)}grid.dragStart(ci,e,getOffset(ci));return false}).click(function(e){if(ts.p.disableClick){ts.p.disableClick=false;return false}var s="th>div.ui-jqgrid-sortable",r,d;if(!ts.p.viewsortcols[2]){s="th>div>span>span.ui-grid-ico-sort"}var t=$(e.target).closest(s);if(t.length!=1){return}var ci=$.jgrid.getCellIndex(this);if(!ts.p.viewsortcols[2]){r=true;d=t.attr("sort")}sortData($("div",this)[0].id,ci,r,d);return false});if(ts.p.sortable&&$.fn.sortable){try{$(ts).jqGrid("sortableColumns",thr)}catch(e){}}if(ts.p.footerrow){tfoot+="</tr></tbody></table>"}firstr+="</tr>";tbody=document.createElement("tbody");this.appendChild(tbody);$(this).addClass("ui-jqgrid-btable").append(firstr);firstr=null;var hTable=$("<table class='ui-jqgrid-htable' style='width:"+ts.p.tblwidth+"px' role='grid' aria-labelledby='gbox_"+this.id+"' cellspacing='0' cellpadding='0' border='0'></table>").append(thead),hg=(ts.p.caption&&ts.p.hiddengrid===true)?true:false,hb=$("<div class='ui-jqgrid-hbox"+(dir=="rtl"?"-rtl":"")+"'></div>");thead=null;grid.hDiv=document.createElement("div");$(grid.hDiv).css({width:grid.width+"px"}).addClass("ui-state-default-grid ui-jqgrid-hdiv").append(hb);$(hb).append(hTable);hTable=null;if(hg){$(grid.hDiv).hide()}if(ts.p.pager){if(typeof ts.p.pager=="string"){if(ts.p.pager.substr(0,1)!="#"){ts.p.pager="#"+ts.p.pager}}else{ts.p.pager="#"+$(ts.p.pager).attr("id")}$(ts.p.pager).css({width:grid.width+"px"}).appendTo(eg).addClass("ui-state-default-grid ui-jqgrid-pager ui-corner-bottom");if(hg){$(ts.p.pager).hide()}setPager(ts.p.pager,"")}if(ts.p.cellEdit===false&&ts.p.hoverrows===true){$(ts).bind("mouseover",function(e){ptr=$(e.target).closest("tr.jqgrow");if($(ptr).attr("class")!=="subgrid"){$(ptr).addClass("ui-state-hover")}return false}).bind("mouseout",function(e){ptr=$(e.target).closest("tr.jqgrow");$(ptr).removeClass("ui-state-hover");return false})}var ri,ci;$(ts).before(grid.hDiv).click(function(e){td=e.target;ptr=$(td,ts.rows).closest("tr.jqgrow");if($(ptr).length===0||ptr[0].className.indexOf("ui-state-disabled")>-1){return this}var scb=$(td).hasClass("cbox"),cSel=true;if($.isFunction(ts.p.beforeSelectRow)){cSel=ts.p.beforeSelectRow.call(ts,ptr[0].id,e)}if(td.tagName=="A"||((td.tagName=="INPUT"||td.tagName=="TEXTAREA"||td.tagName=="OPTION"||td.tagName=="SELECT")&&!scb)){return this}if(cSel===true){if(ts.p.cellEdit===true){if(ts.p.multiselect&&scb){$(ts).jqGrid("setSelection",ptr[0].id,true)}else{ri=ptr[0].rowIndex;ci=$.jgrid.getCellIndex(td);try{$(ts).jqGrid("editCell",ri,ci,true)}catch(_){}}}else{if(!ts.p.multikey){if(ts.p.multiselect&&ts.p.multiboxonly){if(scb){$(ts).jqGrid("setSelection",ptr[0].id,true)}else{$(ts.p.selarrrow).each(function(i,n){var ind=ts.rows.namedItem(n);$(ind).removeClass("ui-state-highlight");$("#jqg_"+$.jgrid.jqID(ts.p.id)+"_"+$.jgrid.jqID(n)).attr("checked",false)});ts.p.selarrrow=[];$("#cb_"+$.jgrid.jqID(ts.p.id),ts.grid.hDiv).attr("checked",false);$(ts).jqGrid("setSelection",ptr[0].id,true)}}else{$(ts).jqGrid("setSelection",ptr[0].id,true)}}else{if(e[ts.p.multikey]){$(ts).jqGrid("setSelection",ptr[0].id,true)}else{if(ts.p.multiselect&&scb){scb=$("#jqg_"+$.jgrid.jqID(ts.p.id)+"_"+ptr[0].id).attr("checked");$("#jqg_"+$.jgrid.jqID(ts.p.id)+"_"+ptr[0].id).attr("checked",!scb)}}}}if($.isFunction(ts.p.onCellSelect)){ri=ptr[0].id;ci=$.jgrid.getCellIndex(td);ts.p.onCellSelect.call(ts,ri,ci,$(td).html(),e)}}return this}).bind("reloadGrid",function(e,opts){if(ts.p.treeGrid===true){ts.p.datatype=ts.p.treedatatype}if(opts&&opts.current){ts.grid.selectionPreserver(ts)}if(ts.p.datatype=="local"){$(ts).jqGrid("resetSelection");if(ts.p.data.length){refreshIndex()}}else{if(!ts.p.treeGrid){ts.p.selrow=null;if(ts.p.multiselect){ts.p.selarrrow=[];$("#cb_"+$.jgrid.jqID(ts.p.id),ts.grid.hDiv).attr("checked",false)}ts.p.savedRow=[]}}if(ts.p.scroll){emptyRows(ts.grid.bDiv,true,false)}if(opts&&opts.page){var page=opts.page;if(page>ts.p.lastpage){page=ts.p.lastpage}if(page<1){page=1}ts.p.page=page;if(ts.grid.prevRowHeight){ts.grid.bDiv.scrollTop=(page-1)*ts.grid.prevRowHeight*ts.p.rowNum}else{ts.grid.bDiv.scrollTop=0}}if(ts.grid.prevRowHeight&&ts.p.scroll){delete ts.p.lastpage;ts.grid.populateVisible()}else{ts.grid.populate()}return false});if($.isFunction(this.p.ondblClickRow)){$(this).dblclick(function(e){td=e.target;ptr=$(td,ts.rows).closest("tr.jqgrow");if($(ptr).length===0){return false}ri=ptr[0].rowIndex;ci=$.jgrid.getCellIndex(td);ts.p.ondblClickRow.call(ts,$(ptr).attr("id"),ri,ci,e);return false})}if($.isFunction(this.p.onRightClickRow)){$(this).bind("contextmenu",function(e){td=e.target;ptr=$(td,ts.rows).closest("tr.jqgrow");if($(ptr).length===0){return false}if(!ts.p.multiselect){$(ts).jqGrid("setSelection",ptr[0].id,true)}ri=ptr[0].rowIndex;ci=$.jgrid.getCellIndex(td);ts.p.onRightClickRow.call(ts,$(ptr).attr("id"),ri,ci,e);return false})}grid.bDiv=document.createElement("div");if(isMSIE){if(String(ts.p.height).toLowerCase()==="auto"){ts.p.height="100%"}}$(grid.bDiv).append($('<div style="position:relative;'+(isMSIE&&$.browser.version<8?"height:0.01%;":"")+'"></div>').append("<div></div>").append(this)).addClass("ui-jqgrid-bdiv").css({height:ts.p.height+(isNaN(ts.p.height)?"":"px"),width:(grid.width)+"px"}).scroll(grid.scrollGrid);$("table:first",grid.bDiv).css({width:ts.p.tblwidth+"px"});if(isMSIE){if($("tbody",this).size()==2){$("tbody:gt(0)",this).remove()}if(ts.p.multikey){$(grid.bDiv).bind("selectstart",function(){return false})}}else{if(ts.p.multikey){$(grid.bDiv).bind("mousedown",function(){return false})}}if(hg){$(grid.bDiv).hide()}grid.cDiv=document.createElement("div");var arf=ts.p.hidegrid===true?$("<a role='link' href='javascript:void(0)'/>").addClass("ui-jqgrid-titlebar-close HeaderButton").hover(function(){arf.addClass("ui-state-hover")},function(){arf.removeClass("ui-state-hover")}).append("<span class='ui-icon-os ui-icon-circle-triangle-n'></span>").css((dir=="rtl"?"left":"right"),"0px"):"";$(grid.cDiv).append(arf).append("<span class='ui-jqgrid-title"+(dir=="rtl"?"-rtl":"")+"'>"+ts.p.caption+"</span>").addClass("ui-jqgrid-titlebar ui-widget-header-grid ui-corner-top ui-helper-clearfix-grid");var arf2=ts.p.hidecolumn===true?$("<a role='link' href='javascript:void(0)'/>").addClass("ui-jqgrid-titlebar-close-column HeaderButton-column").append("<span class='chooser-column-span'></span>").css((dir=="rtl"?"left":"right"),"0px"):"";$(grid.cDiv).append(arf2);$(grid.cDiv).insertBefore(grid.hDiv);if(ts.p.toolbar[0]){grid.uDiv=document.createElement("div");if(ts.p.toolbar[1]=="top"){$(grid.uDiv).insertBefore(grid.hDiv)}else{if(ts.p.toolbar[1]=="bottom"){$(grid.uDiv).insertAfter(grid.hDiv)}}if(ts.p.toolbar[1]=="both"){grid.ubDiv=document.createElement("div");$(grid.uDiv).insertBefore(grid.hDiv).addClass("ui-userdata ui-state-default-grid").attr("id","t_"+this.id);$(grid.ubDiv).insertAfter(grid.hDiv).addClass("ui-userdata ui-state-default-grid").attr("id","tb_"+this.id);if(hg){$(grid.ubDiv).hide()}}else{$(grid.uDiv).width(grid.width).addClass("ui-userdata ui-state-default-grid").attr("id","t_"+this.id)}if(hg){$(grid.uDiv).hide()}}if(ts.p.toppager){ts.p.toppager=$.jgrid.jqID(ts.p.id)+"_toppager";grid.topDiv=$("<div id='"+ts.p.toppager+"'></div>")[0];ts.p.toppager="#"+ts.p.toppager;$(grid.topDiv).insertBefore(grid.hDiv).addClass("ui-state-default-grid ui-jqgrid-toppager").width(grid.width);setPager(ts.p.toppager,"_t")}if(ts.p.footerrow){grid.sDiv=$("<div class='ui-jqgrid-sdiv'></div>")[0];hb=$("<div class='ui-jqgrid-hbox"+(dir=="rtl"?"-rtl":"")+"'></div>");$(grid.sDiv).append(hb).insertAfter(grid.hDiv).width(grid.width);$(hb).append(tfoot);grid.footers=$(".ui-jqgrid-ftable",grid.sDiv)[0].rows[0].cells;if(ts.p.rownumbers){grid.footers[0].className="ui-state-default-grid jqgrid-rownum"}if(hg){$(grid.sDiv).hide()}}hb=null;if(ts.p.caption){var tdt=ts.p.datatype;if(ts.p.hidegrid===true){$(".ui-jqgrid-titlebar-close",grid.cDiv).click(function(e){var onHdCl=$.isFunction(ts.p.onHeaderClick),elems=".ui-jqgrid-bdiv, .ui-jqgrid-hdiv, .ui-jqgrid-pager, .ui-jqgrid-sdiv",counter,self=this;if(ts.p.toolbar[0]===true){if(ts.p.toolbar[1]=="both"){elems+=", #"+$(grid.ubDiv).attr("id")}elems+=", #"+$(grid.uDiv).attr("id")}counter=$(elems,"#gview_"+$.jgrid.jqID(ts.p.id)).length;if(ts.p.gridstate=="visible"){$(elems,"#gbox_"+$.jgrid.jqID(ts.p.id)).slideUp("fast",function(){counter--;if(counter===0){$("span",self).removeClass("ui-icon-circle-triangle-n").addClass("ui-icon-circle-triangle-s");ts.p.gridstate="hidden";if($("#gbox_"+$.jgrid.jqID(ts.p.id)).hasClass("ui-resizable")){$(".ui-resizable-handle","#gbox_"+$.jgrid.jqID(ts.p.id)).hide()}if(onHdCl){if(!hg){ts.p.onHeaderClick.call(ts,ts.p.gridstate,e)}}}})}else{if(ts.p.gridstate=="hidden"){$(elems,"#gbox_"+$.jgrid.jqID(ts.p.id)).slideDown("fast",function(){counter--;if(counter===0){$("span",self).removeClass("ui-icon-circle-triangle-s").addClass("ui-icon-circle-triangle-n");if(hg){ts.p.datatype=tdt;populate();hg=false}ts.p.gridstate="visible";if($("#gbox_"+$.jgrid.jqID(ts.p.id)).hasClass("ui-resizable")){$(".ui-resizable-handle","#gbox_"+$.jgrid.jqID(ts.p.id)).show()}if(onHdCl){if(!hg){ts.p.onHeaderClick.call(ts,ts.p.gridstate,e)}}}})}}return false});if(hg){ts.p.datatype="local";$(".ui-jqgrid-titlebar-close",grid.cDiv).trigger("click")}}if(ts.p.hidecolumn===true){$(".ui-jqgrid-titlebar-close-column",grid.cDiv).click(function(e){var $iconRef=$(this);var coloDivHide=$("<div>");coloDivHide.addClass("chooser-column");coloDivHide.css("position","absolute");coloDivHide.css("display","none");coloDivHide.append('<div class="close-choose-column-header">');$(ts.p.colModel).each(function(i){if((typeof(this.hideshow)!="undefined")&&(this.hideshow==true)){coloDivHide.append($('<input id="choose-check-'+this.index+'" class="chooser-column-element" type="checkbox" '+(!this.hidden?"Checked":"")+' value="'+this.index+'" />').unbind("click").click(function(){if($(this).is(":checked")){$(ts).jqGrid("showCol",$(this).val())}else{$(ts).jqGrid("hideCol",$(this).val())}}));coloDivHide.append('<label for="choose-check-'+this.index+'" class="chooser-column-element">'+ts.p.colNames[i]+"</label>");coloDivHide.append("<br>")}});coloDivHide.append('<div class="close-choose-column-footer">');$(this).find(".chooser-column-span").append(coloDivHide);coloDivHide.css("left",-coloDivHide.width()+$(".chooser-column-span").width());coloDivHide.css("top",$(".chooser-column-span").height());coloDivHide.show("fast");$(document).click(function(e){var elem=$(e.target).attr("class");if((elem!=="ui-jqgrid-titlebar-close-column")&&(elem!=="chooser-column")&&(elem!=="chooser-column-span")&&(elem!=="chooser-column-element")){$(".chooser-column").remove()}})});if(hg){ts.p.datatype="local";$(".ui-jqgrid-titlebar-close-column",grid.cDiv).trigger("click")}}}else{$(grid.cDiv).hide()}$(grid.hDiv).after(grid.bDiv).mousemove(function(e){if(grid.resizing){grid.dragMove(e);return false}});$(".ui-jqgrid-labels",grid.hDiv).bind("selectstart",function(){return false});$(document).mouseup(function(e){if(grid.resizing){grid.dragEnd();return false}return true});ts.formatCol=formatCol;ts.sortData=sortData;ts.updatepager=updatepager;ts.refreshIndex=refreshIndex;ts.formatter=function(rowId,cellval,colpos,rwdat,act){return formatter(rowId,cellval,colpos,rwdat,act)};$.extend(grid,{populate:populate,emptyRows:emptyRows});this.grid=grid;ts.addXmlData=function(d){addXmlData(d,ts.grid.bDiv)};ts.addJSONData=function(d){addJSONData(d,ts.grid.bDiv)};this.grid.cols=this.rows[0].cells;populate();ts.p.hiddengrid=false;$(window).unload(function(){ts=null})})};$.jgrid.extend({getGridParam:function(pName){var $t=this[0];if(!$t||!$t.grid){return}if(!pName){return $t.p}else{return typeof($t.p[pName])!="undefined"?$t.p[pName]:null}},setGridParam:function(newParams){return this.each(function(){if(this.grid&&typeof(newParams)==="object"){$.extend(true,this.p,newParams)}})},getDataIDs:function(){var ids=[],i=0,len,j=0;this.each(function(){len=this.rows.length;if(len&&len>0){while(i<len){if($(this.rows[i]).hasClass("jqgrow")){ids[j]=this.rows[i].id;j++}i++}}});return ids},setSelection:function(selection,onsr){return this.each(function(){var $t=this,stat,pt,ner,ia,tpsr;if(selection===undefined){return}onsr=onsr===false?false:true;pt=$t.rows.namedItem(selection+"");if(!pt||pt.className.indexOf("ui-state-disabled")>-1){return}function scrGrid(iR){var ch=$($t.grid.bDiv)[0].clientHeight,st=$($t.grid.bDiv)[0].scrollTop,rpos=$t.rows[iR].offsetTop,rh=$t.rows[iR].clientHeight;if(rpos+rh>=ch+st){$($t.grid.bDiv)[0].scrollTop=rpos-(ch+st)+rh+st}else{if(rpos<ch+st){if(rpos<st){$($t.grid.bDiv)[0].scrollTop=rpos}}}}if($t.p.scrollrows===true){ner=$t.rows.namedItem(selection).rowIndex;if(ner>=0){scrGrid(ner)}}if(!$t.p.multiselect){if(pt.className!=="ui-subgrid"){if($t.p.selrow!=pt.id){$($t.rows.namedItem($t.p.selrow)).removeClass("ui-state-highlight").attr({"aria-selected":"false",tabindex:"-1"});$(pt).addClass("ui-state-highlight").attr({"aria-selected":true,tabindex:"0"});stat=true}else{stat=false}$t.p.selrow=pt.id;if($t.p.onSelectRow&&onsr){$t.p.onSelectRow.call($t,pt.id,stat)}}}else{$t.p.selrow=pt.id;ia=$.inArray($t.p.selrow,$t.p.selarrrow);if(ia===-1){if(pt.className!=="ui-subgrid"){$(pt).addClass("ui-state-highlight").attr("aria-selected","true")}stat=true;$("#jqg_"+$.jgrid.jqID($t.p.id)+"_"+$.jgrid.jqID($t.p.selrow)).attr("checked",stat);$t.p.selarrrow.push($t.p.selrow)}else{if(pt.className!=="ui-subgrid"){$(pt).removeClass("ui-state-highlight").attr("aria-selected","false")}stat=false;$("#jqg_"+$.jgrid.jqID($t.p.id)+"_"+$.jgrid.jqID($t.p.selrow)).attr("checked",stat);$t.p.selarrrow.splice(ia,1);tpsr=$t.p.selarrrow[0];$t.p.selrow=(tpsr===undefined)?null:tpsr}if($t.p.onSelectRow&&onsr){$t.p.onSelectRow.call($t,pt.id,stat)}}})},resetSelection:function(rowid){return this.each(function(){var t=this,ind,sr;if(typeof(rowid)!=="undefined"){sr=rowid===t.p.selrow?t.p.selrow:rowid;$("#"+$.jgrid.jqID(t.p.id)+" tbody:first tr#"+$.jgrid.jqID(sr)).removeClass("ui-state-highlight").attr("aria-selected","false");if(t.p.multiselect){$("#jqg_"+$.jgrid.jqID(t.p.id)+"_"+$.jgrid.jqID(sr)).attr("checked",false);$("#cb_"+$.jgrid.jqID(t.p.id)).attr("checked",false)}sr=null}else{if(!t.p.multiselect){if(t.p.selrow){$("#"+$.jgrid.jqID(t.p.id)+" tbody:first tr#"+$.jgrid.jqID(t.p.selrow)).removeClass("ui-state-highlight").attr("aria-selected","false");t.p.selrow=null}}else{$(t.p.selarrrow).each(function(i,n){ind=t.rows.namedItem(n);$(ind).removeClass("ui-state-highlight").attr("aria-selected","false");$("#jqg_"+$.jgrid.jqID(t.p.id)+"_"+$.jgrid.jqID(n)).attr("checked",false)});$("#cb_"+$.jgrid.jqID(t.p.id)).attr("checked",false);t.p.selarrrow=[]}}t.p.savedRow=[]})},getRowData:function(rowid){var res={},resall,getall=false,len,j=0;this.each(function(){var $t=this,nm,ind;if(typeof(rowid)=="undefined"){getall=true;resall=[];len=$t.rows.length}else{ind=$t.rows.namedItem(rowid);if(!ind){return res}len=2}while(j<len){if(getall){ind=$t.rows[j]}if($(ind).hasClass("jqgrow")){$("td",ind).each(function(i){nm=$t.p.colModel[i].name;if(nm!=="cb"&&nm!=="subgrid"&&nm!=="rn"){if($t.p.treeGrid===true&&nm==$t.p.ExpandColumn){res[nm]=$.jgrid.htmlDecode($("span:first",this).html())}else{try{res[nm]=$.unformat(this,{rowId:ind.id,colModel:$t.p.colModel[i]},i)}catch(e){res[nm]=$.jgrid.htmlDecode($(this).html())}}}});if(getall){resall.push(res);res={}}}j++}});return resall?resall:res},delRowData:function(rowid){var success=false,rowInd,ia,ri;this.each(function(){var $t=this;rowInd=$t.rows.namedItem(rowid);if(!rowInd){return false}else{ri=rowInd.rowIndex;$(rowInd).remove();$t.p.records--;$t.p.reccount--;$t.updatepager(true,false);success=true;if($t.p.multiselect){ia=$.inArray(rowid,$t.p.selarrrow);if(ia!=-1){$t.p.selarrrow.splice(ia,1)}}if(rowid==$t.p.selrow){$t.p.selrow=null}}if($t.p.datatype=="local"){var pos=$t.p._index[rowid];if(typeof(pos)!="undefined"){$t.p.data.splice(pos,1);$t.refreshIndex()}}if($t.p.altRows===true&&success){var cn=$t.p.altclass;$($t.rows).each(function(i){if(i%2==1){$(this).addClass(cn)}else{$(this).removeClass(cn)}})}});return success},setRowData:function(rowid,data,cssp){var nm,success=true,title;this.each(function(){if(!this.grid){return false}var t=this,vl,ind,cp=typeof cssp,lcdata={};ind=t.rows.namedItem(rowid);if(!ind){return false}if(data){try{$(this.p.colModel).each(function(i){nm=this.name;if(data[nm]!==undefined){lcdata[nm]=this.formatter&&typeof(this.formatter)==="string"&&this.formatter=="date"?$.unformat.date(data[nm],this):data[nm];vl=t.formatter(rowid,data[nm],i,data,"edit");title=this.title?{title:$.jgrid.stripHtml(vl)}:{};if(t.p.treeGrid===true&&nm==t.p.ExpandColumn){$("td:eq("+i+") > span:first",ind).html(vl).attr(title)}else{$("td:eq("+i+")",ind).html(vl).attr(title)}}});if(t.p.datatype=="local"){var pos=t.p._index[rowid];if(t.p.treeGrid){for(var key in t.p.treeReader){if(lcdata.hasOwnProperty(t.p.treeReader[key])){delete lcdata[t.p.treeReader[key]]}}}if(typeof(pos)!="undefined"){t.p.data[pos]=$.extend(true,t.p.data[pos],lcdata)}lcdata=null}}catch(e){success=false}}if(success){if(cp==="string"){$(ind).addClass(cssp)}else{if(cp==="object"){$(ind).css(cssp)}}}});return success},addRowData:function(rowid,rdata,pos,src){if(!pos){pos="last"}var success=false,nm,row,gi,si,ni,sind,i,v,prp="",aradd,cnm,cn,data,cm;if(rdata){if($.isArray(rdata)){aradd=true;pos="last";cnm=rowid}else{rdata=[rdata];aradd=false}this.each(function(){var t=this,datalen=rdata.length;ni=t.p.rownumbers===true?1:0;gi=t.p.multiselect===true?1:0;si=t.p.subGrid===true?1:0;if(!aradd){if(typeof(rowid)!="undefined"){rowid=rowid+""}else{rowid=$.jgrid.randId();if(t.p.keyIndex!==false){cnm=t.p.colModel[t.p.keyIndex+gi+si+ni].name;if(typeof rdata[0][cnm]!="undefined"){rowid=rdata[0][cnm]}}}}cn=t.p.altclass;var k=0,cna="",lcdata={},air=$.isFunction(t.p.afterInsertRow)?true:false;while(k<datalen){data=rdata[k];row="";if(aradd){try{rowid=data[cnm]}catch(e){rowid=$.jgrid.randId()}cna=t.p.altRows===true?(t.rows.length-1)%2===0?cn:"":""}if(ni){prp=t.formatCol(0,1,"",null,rowid,true);row+='<td role="gridcell" aria-describedby="'+t.p.id+'_rn" class="ui-state-default-grid jqgrid-rownum" '+prp+">0</td>"}if(gi){v='<input role="checkbox" type="checkbox" id="jqg_'+t.p.id+"_"+rowid+'" class="cbox"/>';prp=t.formatCol(ni,1,"",null,rowid,true);row+='<td role="gridcell" aria-describedby="'+t.p.id+'_cb" '+prp+">"+v+"</td>"}if(si){row+=$(t).jqGrid("addSubGridCell",gi+ni,1)}for(i=gi+si+ni;i<t.p.colModel.length;i++){cm=t.p.colModel[i];nm=cm.name;lcdata[nm]=cm.formatter&&typeof(cm.formatter)==="string"&&cm.formatter=="date"?$.unformat.date(data[nm],cm):data[nm];v=t.formatter(rowid,$.jgrid.getAccessor(data,nm),i,data,"edit");prp=t.formatCol(i,1,v,rowid,data,true);row+='<td role="gridcell" aria-describedby="'+t.p.id+"_"+nm+'" '+prp+">"+v+"</td>"}row='<tr id="'+rowid+'" role="row" tabindex="-1" class="ui-widget-content-grid jqgrow ui-row-'+t.p.direction+" "+cna+'">'+row+"</tr>";if(t.rows.length===0){$("table:first",t.grid.bDiv).append(row)}else{switch(pos){case"last":$(t.rows[t.rows.length-1]).after(row);sind=t.rows.length-1;break;case"first":$(t.rows[0]).after(row);sind=1;break;case"after":sind=t.rows.namedItem(src);if(sind){if($(t.rows[sind.rowIndex+1]).hasClass("ui-subgrid")){$(t.rows[sind.rowIndex+1]).after(row)}else{$(sind).after(row)}}sind++;break;case"before":sind=t.rows.namedItem(src);if(sind){$(sind).before(row);sind=sind.rowIndex}sind--;break}}if(t.p.subGrid===true){$(t).jqGrid("addSubGrid",gi+ni,sind)}t.p.records++;t.p.reccount++;if(air){t.p.afterInsertRow.call(t,rowid,data,data)}k++;if(t.p.datatype=="local"){lcdata[t.p.localReader.id]=rowid;t.p._index[rowid]=t.p.data.length;t.p.data.push(lcdata);lcdata={}}}if(t.p.altRows===true&&!aradd){if(pos=="last"){if((t.rows.length-1)%2==1){$(t.rows[t.rows.length-1]).addClass(cn)}}else{$(t.rows).each(function(i){if(i%2==1){$(this).addClass(cn)}else{$(this).removeClass(cn)}})}}t.updatepager(true,true);success=true})}return success},footerData:function(action,data,format){var nm,success=false,res={},title;function isEmpty(obj){for(var i in obj){if(obj.hasOwnProperty(i)){return false}}return true}if(typeof(action)=="undefined"){action="get"}if(typeof(format)!="boolean"){format=true}action=action.toLowerCase();this.each(function(){var t=this,vl;if(!t.grid||!t.p.footerrow){return false}if(action=="set"){if(isEmpty(data)){return false}}success=true;$(this.p.colModel).each(function(i){nm=this.name;if(action=="set"){if(data[nm]!==undefined){vl=format?t.formatter("",data[nm],i,data,"edit"):data[nm];title=this.title?{title:$.jgrid.stripHtml(vl)}:{};$("tr.footrow td:eq("+i+")",t.grid.sDiv).html(vl).attr(title);success=true}}else{if(action=="get"){res[nm]=$("tr.footrow td:eq("+i+")",t.grid.sDiv).html()}}})});return action=="get"?res:success},showHideCol:function(colname,show){return this.each(function(){var $t=this,fndh=false,brd=$.browser.webkit||$.browser.safari?0:$t.p.cellLayout,cw;if(!$t.grid){return}if(typeof colname==="string"){colname=[colname]}show=show!="none"?"":"none";var sw=show===""?true:false;$(this.p.colModel).each(function(i){if($.inArray(this.name,colname)!==-1&&this.hidden===sw){$("tr",$t.grid.hDiv).each(function(){$(this).children("th:eq("+i+")").css("display",show)});$($t.rows).each(function(j){$(this).children("td:eq("+i+")").css("display",show)});if($t.p.footerrow){$($t.grid.sDiv).children("td:eq("+i+")").css("display",show)}cw=this.widthOrg?this.widthOrg:parseInt(this.width,10);if(show==="none"){$t.p.tblwidth-=cw+brd}else{$t.p.tblwidth+=cw+brd}this.hidden=!sw;fndh=true}});if(fndh===true){if($t.p.shrinkToFit===false){$($t).jqGrid("setGridWidth",$t.grid.width)}else{if($t.grid.width!==$t.p.tblwidth){$($t).jqGrid("setGridWidth",$t.p.tblwidth)}}}})},hideCol:function(colname){return this.each(function(){$(this).jqGrid("showHideCol",colname,"none")})},showCol:function(colname){return this.each(function(){$(this).jqGrid("showHideCol",colname,"")})},remapColumns:function(permutation,updateCells,keepHeader){function resortArray(a){var ac;if(a.length){ac=$.makeArray(a)}else{ac=$.extend({},a)}$.each(permutation,function(i){a[i]=ac[this]})}var ts=this.get(0);function resortRows(parent,clobj){$(">tr"+(clobj||""),parent).each(function(){var row=this;var elems=$.makeArray(row.cells);$.each(permutation,function(){var e=elems[this];if(e){row.appendChild(e)}})})}resortArray(ts.p.colModel);resortArray(ts.p.colNames);resortArray(ts.grid.headers);resortRows($("thead:first",ts.grid.hDiv),keepHeader&&":not(.ui-jqgrid-labels)");if(updateCells){resortRows($("#"+$.jgrid.jqID(ts.p.id)+" tbody:first"),".jqgfirstrow, tr.jqgrow, tr.jqfoot")}if(ts.p.footerrow){resortRows($("tbody:first",ts.grid.sDiv))}if(ts.p.remapColumns){if(!ts.p.remapColumns.length){ts.p.remapColumns=$.makeArray(permutation)}else{resortArray(ts.p.remapColumns)}}ts.p.lastsort=$.inArray(ts.p.lastsort,permutation);if(ts.p.treeGrid){ts.p.expColInd=$.inArray(ts.p.expColInd,permutation)}},setGridWidth:function(nwidth,shrink){return this.each(function(){if(!this.grid){return}var $t=this,cw,initwidth=0,brd=$.browser.webkit||$.browser.safari?0:$t.p.cellLayout,lvc,vc=0,hs=false,scw=$t.p.scrollOffset,aw,gw=0,cl=0,cr;if(typeof shrink!="boolean"){shrink=$t.p.shrinkToFit}if(isNaN(nwidth)){return}else{nwidth=parseInt(nwidth,10);$t.grid.width=$t.p.width=nwidth}$("#gbox_"+$.jgrid.jqID($t.p.id)).css("width",nwidth+"px");$("#gview_"+$.jgrid.jqID($t.p.id)).css("width",nwidth+"px");$($t.grid.bDiv).css("width",nwidth+"px");$($t.grid.hDiv).css("width",nwidth+"px");if($t.p.pager){$($t.p.pager).css("width",nwidth+"px")}if($t.p.toppager){$($t.p.toppager).css("width",nwidth+"px")}if($t.p.toolbar[0]===true){$($t.grid.uDiv).css("width",nwidth+"px");if($t.p.toolbar[1]=="both"){$($t.grid.ubDiv).css("width",nwidth+"px")}}if($t.p.footerrow){$($t.grid.sDiv).css("width",nwidth+"px")}if(shrink===false&&$t.p.forceFit===true){$t.p.forceFit=false}if(shrink===true){$.each($t.p.colModel,function(i){if(this.hidden===false){cw=this.widthOrg?this.widthOrg:parseInt(this.width,10);initwidth+=cw+brd;if(this.fixed){gw+=cw+brd}else{vc++}cl++}});if(vc===0){return}$t.p.tblwidth=initwidth;aw=nwidth-brd*vc-gw;if(!isNaN($t.p.height)){if($($t.grid.bDiv)[0].clientHeight<$($t.grid.bDiv)[0].scrollHeight||$t.rows.length===1){hs=true;aw-=scw}}initwidth=0;var cle=$t.grid.cols.length>0;$.each($t.p.colModel,function(i){if(this.hidden===false&&!this.fixed){cw=this.widthOrg?this.widthOrg:parseInt(this.width,10);cw=Math.round(aw*cw/($t.p.tblwidth-brd*vc-gw));if(cw<0){return}this.width=cw;initwidth+=cw;$t.grid.headers[i].width=cw;$t.grid.headers[i].el.style.width=cw+"px";if($t.p.footerrow){$t.grid.footers[i].style.width=cw+"px"}if(cle){$t.grid.cols[i].style.width=cw+"px"}lvc=i}});cr=0;if(hs){if(nwidth-gw-(initwidth+brd*vc)!==scw){cr=nwidth-gw-(initwidth+brd*vc)-scw}}else{if(Math.abs(nwidth-gw-(initwidth+brd*vc))!==1){cr=nwidth-gw-(initwidth+brd*vc)}}$t.p.colModel[lvc].width+=cr;$t.p.tblwidth=initwidth+cr+brd*vc+gw;if($t.p.tblwidth>nwidth){var delta=$t.p.tblwidth-parseInt(nwidth,10);$t.p.tblwidth=nwidth;cw=$t.p.colModel[lvc].width=$t.p.colModel[lvc].width-delta}else{cw=$t.p.colModel[lvc].width}$t.grid.headers[lvc].width=cw;$t.grid.headers[lvc].el.style.width=cw+"px";if(cle){$t.grid.cols[lvc].style.width=cw+"px"}if($t.p.footerrow){$t.grid.footers[lvc].style.width=cw+"px"}}if($t.p.tblwidth){$("table:first",$t.grid.bDiv).css("width",$t.p.tblwidth+"px");$("table:first",$t.grid.hDiv).css("width",$t.p.tblwidth+"px");$t.grid.hDiv.scrollLeft=$t.grid.bDiv.scrollLeft;if($t.p.footerrow){$("table:first",$t.grid.sDiv).css("width",$t.p.tblwidth+"px")}}})},setGridHeight:function(nh){return this.each(function(){var $t=this;if(!$t.grid){return}$($t.grid.bDiv).css({height:nh+(isNaN(nh)?"":"px")});$t.p.height=nh;if($t.p.scroll){$t.grid.populateVisible()}})},setCaption:function(newcap){return this.each(function(){this.p.caption=newcap;$("span.ui-jqgrid-title",this.grid.cDiv).html(newcap);$(this.grid.cDiv).show()})},setLabel:function(colname,nData,prop,attrp){return this.each(function(){var $t=this,pos=-1;if(!$t.grid){return}if(typeof(colname)!="undefined"){$($t.p.colModel).each(function(i){if(this.name==colname){pos=i;return false}})}else{return}if(pos>=0){var thecol=$("tr.ui-jqgrid-labels th:eq("+pos+")",$t.grid.hDiv);if(nData){var ico=$(".s-ico",thecol);$("[id^=jqgh_]",thecol).empty().html(nData).append(ico);$t.p.colNames[pos]=nData}if(prop){if(typeof prop==="string"){$(thecol).addClass(prop)}else{$(thecol).css(prop)}}if(typeof attrp==="object"){$(thecol).attr(attrp)}}})},setCell:function(rowid,colname,nData,cssp,attrp,forceupd){return this.each(function(){var $t=this,pos=-1,v,title;if(!$t.grid){return}if(isNaN(colname)){$($t.p.colModel).each(function(i){if(this.name==colname){pos=i;return false}})}else{pos=parseInt(colname,10)}if(pos>=0){var ind=$t.rows.namedItem(rowid);if(ind){var tcell=$("td:eq("+pos+")",ind);if(nData!==""||forceupd===true){v=$t.formatter(rowid,nData,pos,ind,"edit");title=$t.p.colModel[pos].title?{title:$.jgrid.stripHtml(v)}:{};if($t.p.treeGrid&&$(".tree-wrap",$(tcell)).length>0){$("span",$(tcell)).html(v).attr(title)}else{$(tcell).html(v).attr(title)}if($t.p.datatype=="local"){var cm=$t.p.colModel[pos],index;nData=cm.formatter&&typeof(cm.formatter)==="string"&&cm.formatter=="date"?$.unformat.date(nData,cm):nData;index=$t.p._index[rowid];if(typeof index!="undefined"){$t.p.data[index][cm.name]=nData}}}if(typeof cssp==="string"){$(tcell).addClass(cssp)}else{if(cssp){$(tcell).css(cssp)}}if(typeof attrp==="object"){$(tcell).attr(attrp)}}}})},getCell:function(rowid,col){var ret=false;this.each(function(){var $t=this,pos=-1;if(!$t.grid){return}if(isNaN(col)){$($t.p.colModel).each(function(i){if(this.name===col){pos=i;return false}})}else{pos=parseInt(col,10)}if(pos>=0){var ind=$t.rows.namedItem(rowid);if(ind){try{ret=$.unformat($("td:eq("+pos+")",ind),{rowId:ind.id,colModel:$t.p.colModel[pos]},pos)}catch(e){ret=$.jgrid.htmlDecode($("td:eq("+pos+")",ind).html())}}}});return ret},getCol:function(col,obj,mathopr){var ret=[],val,sum=0,min=0,max=0,v;obj=typeof(obj)!="boolean"?false:obj;if(typeof mathopr=="undefined"){mathopr=false}this.each(function(){var $t=this,pos=-1;if(!$t.grid){return}if(isNaN(col)){$($t.p.colModel).each(function(i){if(this.name===col){pos=i;return false}})}else{pos=parseInt(col,10)}if(pos>=0){var ln=$t.rows.length,i=0;if(ln&&ln>0){while(i<ln){if($($t.rows[i]).hasClass("jqgrow")){try{val=$.unformat($($t.rows[i].cells[pos]),{rowId:$t.rows[i].id,colModel:$t.p.colModel[pos]},pos)}catch(e){val=$.jgrid.htmlDecode($t.rows[i].cells[pos].innerHTML)}if(mathopr){v=parseFloat(val);sum+=v;min=Math.min(min,v);max=Math.max(min,v)}else{if(obj){ret.push({id:$t.rows[i].id,value:val})}else{ret.push(val)}}}i++}if(mathopr){switch(mathopr.toLowerCase()){case"sum":ret=sum;break;case"avg":ret=sum/ln;break;case"count":ret=ln;break;case"min":ret=min;break;case"max":ret=max;break}}}}});return ret},clearGridData:function(clearfooter){return this.each(function(){var $t=this;if(!$t.grid){return}if(typeof clearfooter!="boolean"){clearfooter=false}if($t.p.deepempty){$("#"+$.jgrid.jqID($t.p.id)+" tbody:first tr:gt(0)").remove()}else{var trf=$("#"+$.jgrid.jqID($t.p.id)+" tbody:first tr:first")[0];$("#"+$.jgrid.jqID($t.p.id)+" tbody:first").empty().append(trf)}if($t.p.footerrow&&clearfooter){$(".ui-jqgrid-ftable td",$t.grid.sDiv).html("&#160;")}$t.p.selrow=null;$t.p.selarrrow=[];$t.p.savedRow=[];$t.p.records=0;$t.p.page=1;$t.p.lastpage=0;$t.p.reccount=0;$t.p.data=[];$t.p_index={};$t.updatepager(true,false)})},getInd:function(rowid,rc){var ret=false,rw;this.each(function(){rw=this.rows.namedItem(rowid);if(rw){ret=rc===true?rw:rw.rowIndex}});return ret},bindKeys:function(settings){var o=$.extend({onEnter:null,onSpace:null,onLeftKey:null,onRightKey:null,scrollingRows:true},settings||{});return this.each(function(){var $t=this;if(!$("body").is("[role]")){$("body").attr("role","application")}$t.p.scrollrows=o.scrollingRows;$($t).keydown(function(event){var target=$($t).find("tr[tabindex=0]")[0],id,r,mind,expanded=$t.p.treeReader.expanded_field;if(target){mind=$t.p._index[target.id];if(event.keyCode===37||event.keyCode===38||event.keyCode===39||event.keyCode===40){if(event.keyCode===38){r=target.previousSibling;id="";if(r){if($(r).is(":hidden")){while(r){r=r.previousSibling;if(!$(r).is(":hidden")&&$(r).hasClass("jqgrow")){id=r.id;break}}}else{id=r.id}}$($t).jqGrid("setSelection",id)}if(event.keyCode===40){r=target.nextSibling;id="";if(r){if($(r).is(":hidden")){while(r){r=r.nextSibling;if(!$(r).is(":hidden")&&$(r).hasClass("jqgrow")){id=r.id;break}}}else{id=r.id}}$($t).jqGrid("setSelection",id)}if(event.keyCode===37){if($t.p.treeGrid&&$t.p.data[mind][expanded]){$(target).find("div.treeclick").trigger("click")}if($.isFunction(o.onLeftKey)){o.onLeftKey.call($t,$t.p.selrow)}}if(event.keyCode===39){if($t.p.treeGrid&&!$t.p.data[mind][expanded]){$(target).find("div.treeclick").trigger("click")}if($.isFunction(o.onRightKey)){o.onRightKey.call($t,$t.p.selrow)}}return false}else{if(event.keyCode===13){if($.isFunction(o.onEnter)){o.onEnter.call($t,$t.p.selrow)}return false}else{if(event.keyCode===32){if($.isFunction(o.onSpace)){o.onSpace.call($t,$t.p.selrow)}return false}}}}})})},unbindKeys:function(){return this.each(function(){var $t=this;$($t).unbind("keydown")})},getLocalRow:function(rowid){var ret=false,ind;this.each(function(){if(typeof(rowid)!=="undefined"){ind=this.p._index[rowid];if(ind>=0){ret=this.p.data[ind]}}});return ret}})})(jQuery);(function(a){a.jgrid.extend({getColProp:function(d){var b={},f=this[0];if(!f.grid){return false}var e=f.p.colModel;for(var c=0;c<e.length;c++){if(e[c].name==d){b=e[c];break}}return b},setColProp:function(c,b){return this.each(function(){if(this.grid){if(b){var e=this.p.colModel;for(var d=0;d<e.length;d++){if(e[d].name==c){a.extend(this.p.colModel[d],b);break}}}}})},sortGrid:function(c,b,d){return this.each(function(){var h=this,e=-1;if(!h.grid){return}if(!c){c=h.p.sortname}for(var g=0;g<h.p.colModel.length;g++){if(h.p.colModel[g].index==c||h.p.colModel[g].name==c){e=g;break}}if(e!=-1){var f=h.p.colModel[e].sortable;if(typeof f!=="boolean"){f=true}if(typeof b!=="boolean"){b=false}if(f){h.sortData("jqgh_"+h.p.id+"_"+c,e,b,d)}}})},GridDestroy:function(){return this.each(function(){if(this.grid){if(this.p.pager){a(this.p.pager).remove()}var c=this.id;try{a("#gbox_"+c).remove()}catch(b){}}})},GridUnload:function(){return this.each(function(){if(!this.grid){return}var d={id:a(this).attr("id"),cl:a(this).attr("class")};if(this.p.pager){a(this.p.pager).empty().removeClass("ui-state-default-grid ui-jqgrid-pager corner-bottom")}var b=document.createElement("table");a(b).attr({id:d.id});b.className=d.cl;var c=this.id;a(b).removeClass("ui-jqgrid-btable");if(a(this.p.pager).parents("#gbox_"+c).length===1){a(b).insertBefore("#gbox_"+c).show();a(this.p.pager).insertBefore("#gbox_"+c)}else{a(b).insertBefore("#gbox_"+c).show()}a("#gbox_"+c).remove()})},setGridState:function(b){return this.each(function(){if(!this.grid){return}var c=this;if(b=="hidden"){a(".ui-jqgrid-bdiv, .ui-jqgrid-hdiv","#gview_"+c.p.id).slideUp("fast");if(c.p.pager){a(c.p.pager).slideUp("fast")}if(c.p.toppager){a(c.p.toppager).slideUp("fast")}if(c.p.toolbar[0]===true){if(c.p.toolbar[1]=="both"){a(c.grid.ubDiv).slideUp("fast")}a(c.grid.uDiv).slideUp("fast")}if(c.p.footerrow){a(".ui-jqgrid-sdiv","#gbox_"+c.p.id).slideUp("fast")}a(".ui-jqgrid-titlebar-close span",c.grid.cDiv).removeClass("ui-icon-circle-triangle-n").addClass("ui-icon-circle-triangle-s");c.p.gridstate="hidden"}else{if(b=="visible"){a(".ui-jqgrid-hdiv, .ui-jqgrid-bdiv","#gview_"+c.p.id).slideDown("fast");if(c.p.pager){a(c.p.pager).slideDown("fast")}if(c.p.toppager){a(c.p.toppager).slideDown("fast")}if(c.p.toolbar[0]===true){if(c.p.toolbar[1]=="both"){a(c.grid.ubDiv).slideDown("fast")}a(c.grid.uDiv).slideDown("fast")}if(c.p.footerrow){a(".ui-jqgrid-sdiv","#gbox_"+c.p.id).slideDown("fast")}a(".ui-jqgrid-titlebar-close span",c.grid.cDiv).removeClass("ui-icon-circle-triangle-s").addClass("ui-icon-circle-triangle-n");c.p.gridstate="visible"}}})},filterToolbar:function(b){b=a.extend({autosearch:true,searchOnEnter:true,beforeSearch:null,afterSearch:null,beforeClear:null,afterClear:null,searchurl:"",stringResult:false,groupOp:"AND",defaultSearch:"bw"},b||{});return this.each(function(){var j=this;if(this.ftoolbar){return}var c=function(){var o={},n=0,t,u,k={},l;a.each(j.p.colModel,function(v,y){u=this.index||this.name;switch(this.stype){case"select":l=(this.searchoptions&&this.searchoptions.sopt)?this.searchoptions.sopt[0]:"eq";t=a("#gs_"+a.jgrid.jqID(this.name),j.grid.hDiv).val();if(t){o[u]=t;k[u]=l;n++}else{try{delete j.p.postData[u]}catch(w){}}break;case"text":l=(this.searchoptions&&this.searchoptions.sopt)?this.searchoptions.sopt[0]:b.defaultSearch;t=a("#gs_"+a.jgrid.jqID(this.name),j.grid.hDiv).val();if(t){o[u]=t;k[u]=l;n++}else{try{delete j.p.postData[u]}catch(x){}}break}});var r=n>0?true:false;if(b.stringResult===true||j.p.datatype=="local"){var s='{"groupOp":"'+b.groupOp+'","rules":[';var q=0;a.each(o,function(v,w){if(q>0){s+=","}s+='{"field":"'+v+'",';s+='"op":"'+k[v]+'",';w+="";s+='"data":"'+w.replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"}';q++});s+="]}";a.extend(j.p.postData,{filters:s});a.each(["searchField","searchString","searchOper"],function(v,w){if(j.p.postData.hasOwnProperty(w)){delete j.p.postData[w]}})}else{a.extend(j.p.postData,o)}var p;if(j.p.searchurl){p=j.p.url;a(j).jqGrid("setGridParam",{url:j.p.searchurl})}var m=false;if(a.isFunction(b.beforeSearch)){m=b.beforeSearch.call(j)}if(!m){a(j).jqGrid("setGridParam",{search:r}).trigger("reloadGrid",[{page:1}])}if(p){a(j).jqGrid("setGridParam",{url:p})}if(a.isFunction(b.afterSearch)){b.afterSearch()}};var g=function(k){var m={},s,l=0,t;k=(typeof k!="boolean")?true:k;a.each(j.p.colModel,function(u,z){s=(this.searchoptions&&this.searchoptions.defaultValue)?this.searchoptions.defaultValue:"";t=this.index||this.name;switch(this.stype){case"select":var x;a("#gs_"+a.jgrid.jqID(t)+" option",j.grid.hDiv).each(function(y){if(y===0){this.selected=true}if(a(this).text()==s){this.selected=true;x=a(this).val();return false}});if(x){m[t]=x;l++}else{try{delete j.p.postData[t]}catch(v){}}break;case"text":a("#gs_"+a.jgrid.jqID(t),j.grid.hDiv).val(s);if(s){m[t]=s;l++}else{try{delete j.p.postData[t]}catch(w){}}break}});var p=l>0?true:false;if(b.stringResult===true||j.p.datatype=="local"){var q='{"groupOp":"'+b.groupOp+'","rules":[';var o=0;a.each(m,function(u,v){if(o>0){q+=","}q+='{"field":"'+u+'",';q+='"op":"eq",';v+="";q+='"data":"'+v.replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"}';o++});q+="]}";a.extend(j.p.postData,{filters:q});a.each(["searchField","searchString","searchOper"],function(u,v){if(j.p.postData.hasOwnProperty(v)){delete j.p.postData[v]}})}else{a.extend(j.p.postData,m)}var n;if(j.p.searchurl){n=j.p.url;a(j).jqGrid("setGridParam",{url:j.p.searchurl})}var r=false;if(a.isFunction(b.beforeClear)){r=b.beforeClear.call(j)}if(!r){if(k){a(j).jqGrid("setGridParam",{search:p}).trigger("reloadGrid",[{page:1}])}}if(n){a(j).jqGrid("setGridParam",{url:n})}if(a.isFunction(b.afterClear)){b.afterClear()}};var e=function(){var k=a("tr.ui-search-toolbar",j.grid.hDiv);if(k.css("display")=="none"){k.show()}else{k.hide()}};function h(k,m){var l=a(k);if(l[0]){jQuery.each(m,function(){if(this.data!==undefined){l.bind(this.type,this.data,this.fn)}else{l.bind(this.type,this.fn)}})}}var f=a("<tr class='ui-search-toolbar' role='rowheader'></tr>");var d;a.each(j.p.colModel,function(v,q){var y=this,w,o,t,l,B;o=a("<th role='columnheader' class='ui-state-default-grid ui-th-column ui-th-"+j.p.direction+"'></th>");w=a("<div style='width:100%;position:relative;height:100%;padding-right:0.3em;'></div>");if(this.hidden===true){a(o).css("display","none")}this.search=this.search===false?false:true;if(typeof this.stype=="undefined"){this.stype="text"}t=a.extend({},this.searchoptions||{});if(this.search){switch(this.stype){case"select":l=this.surl||t.dataUrl;if(l){B=w;a.ajax(a.extend({url:l,dataType:"html",complete:function(n,k){if(t.buildSelect!==undefined){var C=t.buildSelect(n);if(C){a(B).append(C)}}else{a(B).append(n.responseText)}if(t.defaultValue){a("select",B).val(t.defaultValue)}a("select",B).attr({name:y.index||y.name,id:"gs_"+y.name});if(t.attr){a("select",B).attr(t.attr)}a("select",B).css({width:"100%"});if(t.dataInit!==undefined){t.dataInit(a("select",B)[0])}if(t.dataEvents!==undefined){h(a("select",B)[0],t.dataEvents)}if(b.autosearch===true){a("select",B).change(function(D){c();return false})}n=null}},a.jgrid.ajaxOptions,j.p.ajaxSelectOptions||{}))}else{var m;if(y.searchoptions&&y.searchoptions.value){m=y.searchoptions.value}else{if(y.editoptions&&y.editoptions.value){m=y.editoptions.value}}if(m){var s=document.createElement("select");s.style.width="100%";a(s).attr({name:y.index||y.name,id:"gs_"+y.name});var p,A,r;if(typeof m==="string"){p=m.split(";");for(var u=0;u<p.length;u++){A=p[u].split(":");r=document.createElement("option");r.value=A[0];r.innerHTML=A[1];s.appendChild(r)}}else{if(typeof m==="object"){for(var z in m){if(m.hasOwnProperty(z)){r=document.createElement("option");r.value=z;r.innerHTML=m[z];s.appendChild(r)}}}}if(t.defaultValue){a(s).val(t.defaultValue)}if(t.attr){a(s).attr(t.attr)}if(t.dataInit!==undefined){t.dataInit(s)}if(t.dataEvents!==undefined){h(s,t.dataEvents)}a(w).append(s);if(b.autosearch===true){a(s).change(function(k){c();return false})}}}break;case"text":var x=t.defaultValue?t.defaultValue:"";a(w).append("<input type='text' style='width:95%;padding:0px;' name='"+(y.index||y.name)+"' id='gs_"+y.name+"' value='"+x+"'/>");if(t.attr){a("input",w).attr(t.attr)}if(t.dataInit!==undefined){t.dataInit(a("input",w)[0])}if(t.dataEvents!==undefined){h(a("input",w)[0],t.dataEvents)}if(b.autosearch===true){if(b.searchOnEnter){a("input",w).keypress(function(n){var k=n.charCode?n.charCode:n.keyCode?n.keyCode:0;if(k==13){c();return false}return this})}else{a("input",w).keydown(function(n){var k=n.which;switch(k){case 13:return false;case 9:case 16:case 37:case 38:case 39:case 40:case 27:break;default:if(d){clearTimeout(d)}d=setTimeout(function(){c()},500)}})}}break}}a(o).append(w);a(f).append(o)});a("table thead",j.grid.hDiv).append(f);this.ftoolbar=true;this.triggerToolbar=c;this.clearToolbar=g;this.toggleToolbar=e})}})})(jQuery);(function(d){d.fn.jqm=function(f){var e={overlay:50,closeoverlay:true,overlayClass:"jqmOverlay",closeClass:"jqmClose",trigger:".jqModal",ajax:n,ajaxText:"",target:n,modal:n,toTop:n,onShow:n,onHide:n,onLoad:n};return this.each(function(){if(this._jqm){return l[this._jqm].c=d.extend({},l[this._jqm].c,f)}o++;this._jqm=o;l[o]={c:d.extend(e,d.jqm.params,f),a:n,w:d(this).addClass("jqmID"+o),s:o};if(e.trigger){d(this).jqmAddTrigger(e.trigger)}})};d.fn.jqmAddClose=function(f){return k(this,f,"jqmHide")};d.fn.jqmAddTrigger=function(f){return k(this,f,"jqmShow")};d.fn.jqmShow=function(e){return this.each(function(){d.jqm.open(this._jqm,e)})};d.fn.jqmHide=function(e){return this.each(function(){d.jqm.close(this._jqm,e)})};d.jqm={hash:{},open:function(B,A){var p=l[B],q=p.c,m="."+q.closeClass,v=(parseInt(p.w.css("z-index")));v=(v>0)?v:3000;var f=d("<div></div>").css({height:"100%",width:"100%",position:"fixed",left:0,top:0,"z-index":v-1,opacity:q.overlay/100});if(p.a){return n}p.t=A;p.a=true;p.w.css("z-index",v);if(q.modal){if(!a[0]){setTimeout(function(){j("bind")},1)}a.push(B)}else{if(q.overlay>0){if(q.closeoverlay){p.w.jqmAddClose(f)}}else{f=n}}p.o=(f)?f.addClass(q.overlayClass).prependTo("body"):n;if(c){d("html,body").css({height:"100%",width:"100%"});if(f){f=f.css({position:"absolute"})[0];for(var w in {Top:1,Left:1}){f.style.setExpression(w.toLowerCase(),"(_=(document.documentElement.scroll"+w+" || document.body.scroll"+w+"))+'px'")}}}if(q.ajax){var e=q.target||p.w,x=q.ajax;e=(typeof e=="string")?d(e,p.w):d(e);x=(x.substr(0,1)=="@")?d(A).attr(x.substring(1)):x;e.html(q.ajaxText).load(x,function(){if(q.onLoad){q.onLoad.call(this,p)}if(m){p.w.jqmAddClose(d(m,p.w))}h(p)})}else{if(m){p.w.jqmAddClose(d(m,p.w))}}if(q.toTop&&p.o){p.w.before('<span id="jqmP'+p.w[0]._jqm+'"></span>').insertAfter(p.o)}(q.onShow)?q.onShow(p):p.w.show();h(p);return n},close:function(f){var e=l[f];if(!e.a){return n}e.a=n;if(a[0]){a.pop();if(!a[0]){j("unbind")}}if(e.c.toTop&&e.o){d("#jqmP"+e.w[0]._jqm).after(e.w).remove()}if(e.c.onHide){e.c.onHide(e)}else{e.w.hide();if(e.o){e.o.remove()}}return n},params:{}};var o=0,l=d.jqm.hash,a=[],c=d.browser.msie&&(d.browser.version=="6.0"),n=false,h=function(f){var e=d('<iframe src="javascript:false;document.write(\'\');" class="jqm"></iframe>').css({opacity:0});if(c){if(f.o){f.o.html('<p style="width:100%;height:100%"/>').prepend(e)}else{if(!d("iframe.jqm",f.w)[0]){f.w.prepend(e)}}}g(f)},g=function(f){try{d(":input:visible",f.w)[0].focus()}catch(e){}},j=function(e){d(document)[e]("keypress",b)[e]("keydown",b)[e]("mousedown",b)},b=function(p){var f=l[a[a.length-1]],m=(!d(p.target).parents(".jqmID"+f.s)[0]);if(m){g(f)}return !m},k=function(e,f,m){return e.each(function(){var p=this._jqm;d(f).each(function(){if(!this[m]){this[m]=[];d(this).click(function(){for(var q in {jqmShow:1,jqmHide:1}){for(var r in this[q]){if(l[this[q][r]]){l[this[q][r]].w[q](this)}}}return n})}this[m].push(p)})})}})(jQuery);(function(g){g.fn.jqDrag=function(f){return c(this,f,"d")};g.fn.jqResize=function(j,f){return c(this,j,"r",f)};g.jqDnR={dnr:{},e:0,drag:function(f){if(h.k=="d"){e.css({left:h.X+f.pageX-h.pX,top:h.Y+f.pageY-h.pY})}else{e.css({width:Math.max(f.pageX-h.pX+h.W,0),height:Math.max(f.pageY-h.pY+h.H,0)});if(M1){a.css({width:Math.max(f.pageX-M1.pX+M1.W,0),height:Math.max(f.pageY-M1.pY+M1.H,0)})}}return false},stop:function(){g(document).unbind("mousemove",b.drag).unbind("mouseup",b.stop)}};var b=g.jqDnR,h=b.dnr,e=b.e,a,c=function(m,l,j,f){return m.each(function(){l=(l)?g(l,m):m;l.bind("mousedown",{e:m,k:j},function(k){var r=k.data,q={};e=r.e;a=f?g(f):false;if(e.css("position")!="relative"){try{e.position(q)}catch(o){}}h={X:q.left||d("left")||0,Y:q.top||d("top")||0,W:d("width")||e[0].scrollWidth||0,H:d("height")||e[0].scrollHeight||0,pX:k.pageX,pY:k.pageY,k:r.k};if(a&&r.k!="d"){M1={X:q.left||f1("left")||0,Y:q.top||f1("top")||0,W:a[0].offsetWidth||f1("width")||0,H:a[0].offsetHeight||f1("height")||0,pX:k.pageX,pY:k.pageY,k:r.k}}else{M1=false}if(g("input.hasDatepicker",e[0])[0]){try{g("input.hasDatepicker",e[0]).datepicker("hide")}catch(n){}}g(document).mousemove(g.jqDnR.drag).mouseup(g.jqDnR.stop);return false})})},d=function(f){return parseInt(e.css(f))||false};f1=function(f){return parseInt(a.css(f))||false}})(jQuery);var xmlJsonClass={xml2json:function(b,d){if(b.nodeType===9){b=b.documentElement}var a=this.removeWhite(b);var e=this.toObj(a);var c=this.toJson(e,b.nodeName,"\t");return"{\n"+d+(d?c.replace(/\t/g,d):c.replace(/\t|\n/g,""))+"\n}"},json2xml:function(d,c){var e=function(q,f,h){var o="";var l,g;if(q instanceof Array){if(q.length===0){o+=h+"<"+f+">__EMPTY_ARRAY_</"+f+">\n"}else{for(l=0,g=q.length;l<g;l+=1){var p=h+e(q[l],f,h+"\t")+"\n";o+=p}}}else{if(typeof(q)==="object"){var k=false;o+=h+"<"+f;var j;for(j in q){if(q.hasOwnProperty(j)){if(j.charAt(0)==="@"){o+=" "+j.substr(1)+'="'+q[j].toString()+'"'}else{k=true}}}o+=k?">":"/>";if(k){for(j in q){if(q.hasOwnProperty(j)){if(j==="#text"){o+=q[j]}else{if(j==="#cdata"){o+="<![CDATA["+q[j]+"]]>"}else{if(j.charAt(0)!=="@"){o+=e(q[j],j,h+"\t")}}}}}o+=(o.charAt(o.length-1)==="\n"?h:"")+"</"+f+">"}}else{if(typeof(q)==="function"){o+=h+"<"+f+"><![CDATA["+q+"]]></"+f+">"}else{if(q.toString()==='""'||q.toString().length===0){o+=h+"<"+f+">__EMPTY_STRING_</"+f+">"}else{o+=h+"<"+f+">"+q.toString()+"</"+f+">"}}}}return o};var b="";var a;for(a in d){if(d.hasOwnProperty(a)){b+=e(d[a],a,"")}}return c?b.replace(/\t/g,c):b.replace(/\t|\n/g,"")},toObj:function(b){var g={};var f=/function/i;if(b.nodeType===1){if(b.attributes.length){var e;for(e=0;e<b.attributes.length;e+=1){g["@"+b.attributes[e].nodeName]=(b.attributes[e].nodeValue||"").toString()}}if(b.firstChild){var a=0,d=0,c=false;var h;for(h=b.firstChild;h;h=h.nextSibling){if(h.nodeType===1){c=true}else{if(h.nodeType===3&&h.nodeValue.match(/[^ \f\n\r\t\v]/)){a+=1}else{if(h.nodeType===4){d+=1}}}}if(c){if(a<2&&d<2){this.removeWhite(b);for(h=b.firstChild;h;h=h.nextSibling){if(h.nodeType===3){g["#text"]=this.escape(h.nodeValue)}else{if(h.nodeType===4){if(f.test(h.nodeValue)){g[h.nodeName]=[g[h.nodeName],h.nodeValue]}else{g["#cdata"]=this.escape(h.nodeValue)}}else{if(g[h.nodeName]){if(g[h.nodeName] instanceof Array){g[h.nodeName][g[h.nodeName].length]=this.toObj(h)}else{g[h.nodeName]=[g[h.nodeName],this.toObj(h)]}}else{g[h.nodeName]=this.toObj(h)}}}}}else{if(!b.attributes.length){g=this.escape(this.innerXml(b))}else{g["#text"]=this.escape(this.innerXml(b))}}}else{if(a){if(!b.attributes.length){g=this.escape(this.innerXml(b));if(g==="__EMPTY_ARRAY_"){g="[]"}else{if(g==="__EMPTY_STRING_"){g=""}}}else{g["#text"]=this.escape(this.innerXml(b))}}else{if(d){if(d>1){g=this.escape(this.innerXml(b))}else{for(h=b.firstChild;h;h=h.nextSibling){if(f.test(b.firstChild.nodeValue)){g=b.firstChild.nodeValue;break}else{g["#cdata"]=this.escape(h.nodeValue)}}}}}}}if(!b.attributes.length&&!b.firstChild){g=null}}else{if(b.nodeType===9){g=this.toObj(b.documentElement)}else{alert("unhandled node type: "+b.nodeType)}}return g},toJson:function(b,a,d,e){if(e===undefined){e=true}var p=a?('"'+a+'"'):"",f="\t",g="\n";if(!e){f="";g=""}if(b==="[]"){p+=(a?":[]":"[]")}else{if(b instanceof Array){var c,k,j=[];for(k=0,c=b.length;k<c;k+=1){j[k]=this.toJson(b[k],"",d+f,e)}p+=(a?":[":"[")+(j.length>1?(g+d+f+j.join(","+g+d+f)+g+d):j.join(""))+"]"}else{if(b===null){p+=(a&&":")+"null"}else{if(typeof(b)==="object"){var l=[],h;for(h in b){if(b.hasOwnProperty(h)){l[l.length]=this.toJson(b[h],h,d+f,e)}}p+=(a?":{":"{")+(l.length>1?(g+d+f+l.join(","+g+d+f)+g+d):l.join(""))+"}"}else{if(typeof(b)==="string"){p+=(a&&":")+'"'+b.replace(/\\/g,"\\\\").replace(/\"/g,'\\"')+'"'}else{p+=(a&&":")+'"'+b.toString()+'"'}}}}}return p},innerXml:function(d){var b="";if("innerHTML" in d){b=d.innerHTML}else{var a=function(j){var g="",f;if(j.nodeType===1){g+="<"+j.nodeName;for(f=0;f<j.attributes.length;f+=1){g+=" "+j.attributes[f].nodeName+'="'+(j.attributes[f].nodeValue||"").toString()+'"'}if(j.firstChild){g+=">";for(var h=j.firstChild;h;h=h.nextSibling){g+=a(h)}g+="</"+j.nodeName+">"}else{g+="/>"}}else{if(j.nodeType===3){g+=j.nodeValue}else{if(j.nodeType===4){g+="<![CDATA["+j.nodeValue+"]]>"}}}return g};for(var e=d.firstChild;e;e=e.nextSibling){b+=a(e)}}return b},escape:function(a){return a.replace(/[\\]/g,"\\\\").replace(/[\"]/g,'\\"').replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r")},removeWhite:function(b){b.normalize();var c;for(c=b.firstChild;c;){if(c.nodeType===3){if(!c.nodeValue.match(/[^ \f\n\r\t\v]/)){var a=c.nextSibling;b.removeChild(c);c=a}else{c=c.nextSibling}}else{if(c.nodeType===1){this.removeWhite(c);c=c.nextSibling}else{c=c.nextSibling}}}return b}};(function(a){a.fmatter={};a.extend(a.fmatter,{isBoolean:function(b){return typeof b==="boolean"},isObject:function(b){return(b&&(typeof b==="object"||a.isFunction(b)))||false},isString:function(b){return typeof b==="string"},isNumber:function(b){return typeof b==="number"&&isFinite(b)},isNull:function(b){return b===null},isUndefined:function(b){return typeof b==="undefined"},isValue:function(b){return(this.isObject(b)||this.isString(b)||this.isNumber(b)||this.isBoolean(b))},isEmpty:function(b){if(!this.isString(b)&&this.isValue(b)){return false}else{if(!this.isValue(b)){return true}}b=a.trim(b).replace(/\&nbsp\;/ig,"").replace(/\&#160\;/ig,"");return b===""}});a.fn.fmatter=function(f,g,e,b,c){var d=g;e=a.extend({},a.jgrid.formatter,e);if(a.fn.fmatter[f]){d=a.fn.fmatter[f](g,e,b,c)}return d};a.fmatter.util={NumberFormat:function(d,b){if(!a.fmatter.isNumber(d)){d*=1}if(a.fmatter.isNumber(d)){var f=(d<0);var l=d+"";var h=(b.decimalSeparator)?b.decimalSeparator:".";var j;if(a.fmatter.isNumber(b.decimalPlaces)){var k=b.decimalPlaces;var e=Math.pow(10,k);l=Math.round(d*e)/e+"";j=l.lastIndexOf(".");if(k>0){if(j<0){l+=h;j=l.length-1}else{if(h!=="."){l=l.replace(".",h)}}while((l.length-1-j)<k){l+="0"}}}if(b.thousandsSeparator){var n=b.thousandsSeparator;j=l.lastIndexOf(h);j=(j>-1)?j:l.length;var m=l.substring(j);var c=-1;for(var g=j;g>0;g--){c++;if((c%3===0)&&(g!==j)&&(!f||(g>1))){m=n+m}m=l.charAt(g-1)+m}l=m}l=(b.prefix)?b.prefix+l:l;l=(b.suffix)?l+b.suffix:l;return l}else{return d}},DateFormat:function(J,M,P,y){var m=/\\.|[dDjlNSwzWFmMntLoYyaABgGhHisueIOPTZcrU]/g,D=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,L=/[^-+\dA-Z]/g,p=new RegExp("^/Date\\((([-+])?[0-9]+)(([-+])([0-9]{2})([0-9]{2}))?\\)/$"),f=((typeof M==="string")?M.match(p):null),K=function(k,j){k=String(k);j=parseInt(j,10)||2;while(k.length<j){k="0"+k}return k},b={m:1,d:1,y:1970,h:0,i:0,s:0,u:0},e=0,r,F,d,E=["i18n"];E.i18n={dayNames:y.dayNames,monthNames:y.monthNames};if(J in y.masks){J=y.masks[J]}if(M.constructor===Number){if(String(J).toLowerCase()=="u"){M=M*1000}e=new Date(M)}else{if(M.constructor===Date){e=M}else{if(f!==null){e=new Date(parseInt(f[1],10));if(f[3]){var g=Number(f[5])*60+Number(f[6]);g*=((f[4]=="-")?1:-1);g-=e.getTimezoneOffset();e.setTime(Number(Number(e)+(g*60*1000)))}}else{M=String(M).split(/[\\\/:_;.,\t\T\s-]/);J=J.split(/[\\\/:_;.,\t\T\s-]/);for(F=0,d=J.length;F<d;F++){if(J[F]=="M"){r=a.inArray(M[F],E.i18n.monthNames);if(r!==-1&&r<12){M[F]=r+1}}if(J[F]=="F"){r=a.inArray(M[F],E.i18n.monthNames);if(r!==-1&&r>11){M[F]=r+1-12}}if(M[F]){b[J[F].toLowerCase()]=parseInt(M[F],10)}}if(b.f){b.m=b.f}if(b.m===0&&b.y===0&&b.d===0){return"&#160;"}b.m=parseInt(b.m,10)-1;var O=b.y;if(O>=70&&O<=99){b.y=1900+b.y}else{if(O>=0&&O<=69){b.y=2000+b.y}}e=new Date(b.y,b.m,b.d,b.h,b.i,b.s,b.u)}}}if(P in y.masks){P=y.masks[P]}else{if(!P){P="Y-m-d"}}var v=e.getHours(),I=e.getMinutes(),H=e.getDate(),C=e.getMonth()+1,B=e.getTimezoneOffset(),A=e.getSeconds(),x=e.getMilliseconds(),t=e.getDay(),c=e.getFullYear(),l=(t+6)%7+1,q=(new Date(c,C-1,H)-new Date(c,0,1))/86400000,h={d:K(H),D:E.i18n.dayNames[t],j:H,l:E.i18n.dayNames[t+7],N:l,S:y.S(H),w:t,z:q,W:l<5?Math.floor((q+l-1)/7)+1:Math.floor((q+l-1)/7)||((new Date(c-1,0,1).getDay()+6)%7<4?53:52),F:E.i18n.monthNames[C-1+12],m:K(C),M:E.i18n.monthNames[C-1],n:C,t:"?",L:"?",o:"?",Y:c,y:String(c).substring(2),a:v<12?y.AmPm[0]:y.AmPm[1],A:v<12?y.AmPm[2]:y.AmPm[3],B:"?",g:v%12||12,G:v,h:K(v%12||12),H:K(v),i:K(I),s:K(A),u:x,e:"?",I:"?",O:(B>0?"-":"+")+K(Math.floor(Math.abs(B)/60)*100+Math.abs(B)%60,4),P:"?",T:(String(e).match(D)||[""]).pop().replace(L,""),Z:"?",c:"?",r:"?",U:Math.floor(e/1000)};return P.replace(m,function(j){return j in h?h[j]:j.substring(1)})}};a.fn.fmatter.defaultFormat=function(c,b){return(a.fmatter.isValue(c)&&c!=="")?c:b.defaultValue?b.defaultValue:"&#160;"};a.fn.fmatter.email=function(c,b){if(!a.fmatter.isEmpty(c)){return'<a href="mailto:'+c+'">'+c+"</a>"}else{return a.fn.fmatter.defaultFormat(c,b)}};a.fn.fmatter.checkbox=function(e,c){var f=a.extend({},c.checkbox),d;if(!a.fmatter.isUndefined(c.colModel.formatoptions)){f=a.extend({},f,c.colModel.formatoptions)}if(f.disabled===true){d='disabled="disabled"'}else{d=""}if(a.fmatter.isEmpty(e)||a.fmatter.isUndefined(e)){e=a.fn.fmatter.defaultFormat(e,f)}e=e+"";e=e.toLowerCase();var b=e.search(/(false|0|no|off)/i)<0?" checked='checked' ":"";return'<input type="checkbox" '+b+' value="'+e+'" offval="no" '+d+"/>"};a.fn.fmatter.link=function(d,b){var e={target:b.target};var c="";if(!a.fmatter.isUndefined(b.colModel.formatoptions)){e=a.extend({},e,b.colModel.formatoptions)}if(e.target){c="target="+e.target}if(!a.fmatter.isEmpty(d)){return"<a "+c+' href="'+d+'">'+d+"</a>"}else{return a.fn.fmatter.defaultFormat(d,b)}};a.fn.fmatter.showlink=function(d,b){var f={baseLinkUrl:b.baseLinkUrl,showAction:b.showAction,addParam:b.addParam||"",target:b.target,idName:b.idName},c="",e;if(!a.fmatter.isUndefined(b.colModel.formatoptions)){f=a.extend({},f,b.colModel.formatoptions)}if(f.target){c="target="+f.target}e=f.baseLinkUrl+f.showAction+"?"+f.idName+"="+b.rowId+f.addParam;if(a.fmatter.isString(d)||a.fmatter.isNumber(d)){return"<a "+c+' href="'+e+'">'+d+"</a>"}else{return a.fn.fmatter.defaultFormat(d,b)}};a.fn.fmatter.integer=function(c,b){var d=a.extend({},b.integer);if(!a.fmatter.isUndefined(b.colModel.formatoptions)){d=a.extend({},d,b.colModel.formatoptions)}if(a.fmatter.isEmpty(c)){return d.defaultValue}return a.fmatter.util.NumberFormat(c,d)};a.fn.fmatter.number=function(c,b){var d=a.extend({},b.number);if(!a.fmatter.isUndefined(b.colModel.formatoptions)){d=a.extend({},d,b.colModel.formatoptions)}if(a.fmatter.isEmpty(c)){return d.defaultValue}return a.fmatter.util.NumberFormat(c,d)};a.fn.fmatter.currency=function(c,b){var d=a.extend({},b.currency);if(!a.fmatter.isUndefined(b.colModel.formatoptions)){d=a.extend({},d,b.colModel.formatoptions)}if(a.fmatter.isEmpty(c)){return d.defaultValue}return a.fmatter.util.NumberFormat(c,d)};a.fn.fmatter.date=function(e,d,b,c){var f=a.extend({},d.date);if(!a.fmatter.isUndefined(d.colModel.formatoptions)){f=a.extend({},f,d.colModel.formatoptions)}if(!f.reformatAfterEdit&&c=="edit"){return a.fn.fmatter.defaultFormat(e,d)}else{if(!a.fmatter.isEmpty(e)){return a.fmatter.util.DateFormat(f.srcformat,e,f.newformat,f)}else{return a.fn.fmatter.defaultFormat(e,d)}}};a.fn.fmatter.select=function(g,b,c,l){g=g+"";var e=false,k=[];if(!a.fmatter.isUndefined(b.colModel.formatoptions)){e=b.colModel.formatoptions.value}else{if(!a.fmatter.isUndefined(b.colModel.editoptions)){e=b.colModel.editoptions.value}}if(e){var o=b.colModel.editoptions.multiple===true?true:false,n=[],m;if(o){n=g.split(",");n=a.map(n,function(j){return a.trim(j)})}if(a.fmatter.isString(e)){var d=e.split(";"),f=0;for(var h=0;h<d.length;h++){m=d[h].split(":");if(m.length>2){m[1]=jQuery.map(m,function(p,j){if(j>0){return p}}).join(":")}if(o){if(jQuery.inArray(m[0],n)>-1){k[f]=m[1];f++}}else{if(a.trim(m[0])==a.trim(g)){k[0]=m[1];break}}}}else{if(a.fmatter.isObject(e)){if(o){k=jQuery.map(n,function(p,j){return e[p]})}else{k[0]=e[g]||""}}}}g=k.join(", ");return g===""?a.fn.fmatter.defaultFormat(g,b):g};a.fn.fmatter.rowactions=function(f,e,c,j){var h={keys:false,onEdit:null,onSuccess:null,afterSave:null,onError:null,afterRestore:null,extraparam:{oper:"edit"},url:null,delOptions:{},editOptions:{}},b=a("#"+e)[0].p.colModel[j];if(!a.fmatter.isUndefined(b.formatoptions)){h=a.extend(h,b.formatoptions)}if(!a.fmatter.isUndefined(a("#"+e)[0].p.editOptions)){h.editOptions=a("#"+e)[0].p.editOptions}if(!a.fmatter.isUndefined(a("#"+e)[0].p.delOptions)){h.delOptions=a("#"+e)[0].p.delOptions}var d=function(k){if(h.afterSave){h.afterSave(k)}a("tr#"+f+" div.ui-inline-edit, tr#"+f+" div.ui-inline-del","#"+e).show();a("tr#"+f+" div.ui-inline-save, tr#"+f+" div.ui-inline-cancel","#"+e).hide()},g=function(k){if(h.afterRestore){h.afterRestore(k)}a("tr#"+f+" div.ui-inline-edit, tr#"+f+" div.ui-inline-del","#"+e).show();a("tr#"+f+" div.ui-inline-save, tr#"+f+" div.ui-inline-cancel","#"+e).hide()};switch(c){case"edit":a("#"+e).jqGrid("editRow",f,h.keys,h.onEdit,h.onSuccess,h.url,h.extraparam,d,h.onError,g);a("tr#"+f+" div.ui-inline-edit, tr#"+f+" div.ui-inline-del","#"+e).hide();a("tr#"+f+" div.ui-inline-save, tr#"+f+" div.ui-inline-cancel","#"+e).show();break;case"save":if(a("#"+e).jqGrid("saveRow",f,h.onSuccess,h.url,h.extraparam,d,h.onError,g)){a("tr#"+f+" div.ui-inline-edit, tr#"+f+" div.ui-inline-del","#"+e).show();a("tr#"+f+" div.ui-inline-save, tr#"+f+" div.ui-inline-cancel","#"+e).hide()}break;case"cancel":a("#"+e).jqGrid("restoreRow",f,g);a("tr#"+f+" div.ui-inline-edit, tr#"+f+" div.ui-inline-del","#"+e).show();a("tr#"+f+" div.ui-inline-save, tr#"+f+" div.ui-inline-cancel","#"+e).hide();break;case"del":a("#"+e).jqGrid("delGridRow",f,h.delOptions);break;case"formedit":a("#"+e).jqGrid("setSelection",f);a("#"+e).jqGrid("editGridRow",f,h.editOptions);break}};a.fn.fmatter.actions=function(f,d,b){var h={keys:false,editbutton:true,delbutton:true,editformbutton:false};if(!a.fmatter.isUndefined(d.colModel.formatoptions)){h=a.extend(h,d.colModel.formatoptions)}var c=d.rowId,g="",e;if(typeof(c)=="undefined"||a.fmatter.isEmpty(c)){return""}if(h.editformbutton){e="onclick=$.fn.fmatter.rowactions('"+c+"','"+d.gid+"','formedit',"+d.pos+"); onmouseover=jQuery(this).addClass('ui-state-hover'); onmouseout=jQuery(this).removeClass('ui-state-hover'); ";g=g+"<div style='margin-left:8px;'><div title='"+a.jgrid.nav.edittitle+"' style='float:left;cursor:pointer;' class='ui-pg-div ui-inline-edit' "+e+"><span class='ui-icon-os ui-icon-pencil'></span></div>"}else{if(h.editbutton){e="onclick=$.fn.fmatter.rowactions('"+c+"','"+d.gid+"','edit',"+d.pos+"); onmouseover=jQuery(this).addClass('ui-state-hover'); onmouseout=jQuery(this).removeClass('ui-state-hover') ";g=g+"<div style='margin-left:8px;'><div title='"+a.jgrid.nav.edittitle+"' style='float:left;cursor:pointer;' class='ui-pg-div ui-inline-edit' "+e+"><span class='ui-icon-os ui-icon-pencil'></span></div>"}}if(h.delbutton){e="onclick=$.fn.fmatter.rowactions('"+c+"','"+d.gid+"','del',"+d.pos+"); onmouseover=jQuery(this).addClass('ui-state-hover'); onmouseout=jQuery(this).removeClass('ui-state-hover'); ";g=g+"<div title='"+a.jgrid.nav.deltitle+"' style='float:left;margin-left:5px;' class='ui-pg-div ui-inline-del' "+e+"><span class='ui-icon-os ui-icon-trash'></span></div>"}e="onclick=$.fn.fmatter.rowactions('"+c+"','"+d.gid+"','save',"+d.pos+"); onmouseover=jQuery(this).addClass('ui-state-hover'); onmouseout=jQuery(this).removeClass('ui-state-hover'); ";g=g+"<div title='"+a.jgrid.edit.bSubmit+"' style='float:left;display:none' class='ui-pg-div ui-inline-save'><span class='ui-icon-os ui-icon-disk' "+e+"></span></div>";e="onclick=$.fn.fmatter.rowactions('"+c+"','"+d.gid+"','cancel',"+d.pos+"); onmouseover=jQuery(this).addClass('ui-state-hover'); onmouseout=jQuery(this).removeClass('ui-state-hover'); ";g=g+"<div title='"+a.jgrid.edit.bCancel+"' style='float:left;display:none;margin-left:5px;' class='ui-pg-div ui-inline-cancel'><span class='ui-icon-os ui-icon-cancel' "+e+"></span></div></div>";return g};a.unformat=function(e,n,k,c){var h,f=n.colModel.formatter,g=n.colModel.formatoptions||{},o,m=/([\.\*\_\'\(\)\{\}\+\?\\])/g,j=n.colModel.unformat||(a.fn.fmatter[f]&&a.fn.fmatter[f].unformat);if(typeof j!=="undefined"&&a.isFunction(j)){h=j(a(e).text(),n,e)}else{if(!a.fmatter.isUndefined(f)&&a.fmatter.isString(f)){var b=a.jgrid.formatter||{},l;switch(f){case"integer":g=a.extend({},b.integer,g);o=g.thousandsSeparator.replace(m,"\\$1");l=new RegExp(o,"g");h=a(e).text().replace(l,"");break;case"number":g=a.extend({},b.number,g);o=g.thousandsSeparator.replace(m,"\\$1");l=new RegExp(o,"g");h=a(e).text().replace(l,"").replace(g.decimalSeparator,".");break;case"currency":g=a.extend({},b.currency,g);o=g.thousandsSeparator.replace(m,"\\$1");l=new RegExp(o,"g");h=a(e).text().replace(l,"").replace(g.decimalSeparator,".").replace(g.prefix,"").replace(g.suffix,"");break;case"checkbox":var d=(n.colModel.editoptions)?n.colModel.editoptions.value.split(":"):["Yes","No"];h=a("input",e).attr("checked")?d[0]:d[1];break;case"select":h=a.unformat.select(e,n,k,c);break;case"actions":return"";default:h=a(e).text()}}}return h?h:c===true?a(e).text():a.jgrid.htmlDecode(a(e).html())};a.unformat.select=function(f,q,l,c){var k=[];var o=a(f).text();if(c===true){return o}var h=a.extend({},q.colModel.editoptions);if(h.value){var d=h.value,p=h.multiple===true?true:false,n=[],m;if(p){n=o.split(",");n=a.map(n,function(j){return a.trim(j)})}if(a.fmatter.isString(d)){var b=d.split(";"),e=0;for(var g=0;g<b.length;g++){m=b[g].split(":");if(m.length>2){m[1]=jQuery.map(m,function(r,j){if(j>0){return r}}).join(":")}if(p){if(jQuery.inArray(m[1],n)>-1){k[e]=m[0];e++}}else{if(a.trim(m[1])==a.trim(o)){k[0]=m[0];break}}}}else{if(a.fmatter.isObject(d)||a.isArray(d)){if(!p){n[0]=o}k=jQuery.map(n,function(r){var j;a.each(d,function(s,t){if(t==r){j=s;return false}});if(typeof(j)!="undefined"){return j}})}}return k.join(", ")}else{return o||""}};a.unformat.date=function(c,b){var d=a.jgrid.formatter.date||{};if(!a.fmatter.isUndefined(b.formatoptions)){d=a.extend({},d,b.formatoptions)}if(!a.fmatter.isEmpty(c)){return a.fmatter.util.DateFormat(d.newformat,c,d.srcformat,d)}else{return a.fn.fmatter.defaultFormat(c,b)}}})(jQuery);(function(a){a.extend(a.jgrid,{showModal:function(b){b.w.show()},closeModal:function(b){b.w.hide().attr("aria-hidden","true");if(b.o){b.o.remove()}},hideModal:function(b,f){f=a.extend({jqm:true,gb:""},f||{});if(f.onClose){var c=f.onClose(b);if(typeof c=="boolean"&&!c){return}}if(a.fn.jqm&&f.jqm===true){a(b).attr("aria-hidden","true").jqmHide()}else{if(f.gb!==""){try{a(".jqgrid-overlay:first",f.gb).hide()}catch(d){}}a(b).hide().attr("aria-hidden","true")}},findPos:function(c){var d=0,b=0;if(c.offsetParent){do{d+=c.offsetLeft;b+=c.offsetTop}while(c=c.offsetParent)}return[d,b]},createModal:function(j,s,n,b,w,c,h){var l=document.createElement("div"),t,m=this;h=a.extend({},h||{});t=a(n.gbox).attr("dir")=="rtl"?true:false;l.className="ui-widget-grid ui-widget-content-grid ui-corner-all-grid ui-jqdialog";l.id=j.themodal;var v=document.createElement("div");v.className="ui-jqdialog-titlebar ui-widget-header-grid ui-corner-all-grid ui-helper-clearfix-grid";v.id=j.modalhead;a(v).append("<span class='ui-jqdialog-title'>"+n.caption+"</span>");var o=a("<a href='javascript:void(0)' class='ui-jqdialog-titlebar-close ui-corner-all-grid'></a>").hover(function(){o.addClass("ui-state-hover")},function(){o.removeClass("ui-state-hover")}).append("<span class='ui-icon-os ui-icon-closethick'></span>");a(v).append(o);if(t){l.dir="rtl";a(".ui-jqdialog-title",v).css("float","right");a(".ui-jqdialog-titlebar-close",v).css("left",0.3+"em")}else{l.dir="ltr";a(".ui-jqdialog-title",v).css("float","left");a(".ui-jqdialog-titlebar-close",v).css("right",0.3+"em")}var x=document.createElement("div");a(x).addClass("ui-jqdialog-content ui-widget-content-grid").attr("id",j.modalcontent);a(x).append(s);l.appendChild(x);a(l).prepend(v);if(c===true){a("body").append(l)}else{if(typeof c=="string"){a(c).append(l)}else{a(l).insertBefore(b)}}a(l).css(h);if(typeof n.jqModal==="undefined"){n.jqModal=true}var q={};if(a.fn.jqm&&n.jqModal===true){if(n.left===0&&n.top===0&&n.overlay){var d=[];d=this.findPos(w);n.left=d[0]+4;n.top=d[1]+4}q.top=n.top+"px";q.left=n.left}else{if(n.left!==0||n.top!==0){q.left=n.left;q.top=n.top+"px"}}a("a.ui-jqdialog-titlebar-close",v).click(function(r){var p=a("#"+j.themodal).data("onClose")||n.onClose;var y=a("#"+j.themodal).data("gbox")||n.gbox;m.hideModal("#"+j.themodal,{gb:y,jqm:n.jqModal,onClose:p});return false});if(n.width===0||!n.width){n.width=300}if(n.height===0||!n.height){n.height=200}if(!n.zIndex){var f=a(b).parents("*[role=dialog]").filter(":first").css("z-index");if(f){n.zIndex=parseInt(f,10)+1}else{n.zIndex=950}}var g=0;if(t&&q.left&&!c){g=a(n.gbox).width()-(!isNaN(n.width)?parseInt(n.width,10):0)-8;q.left=parseInt(q.left,10)+parseInt(g,10)}if(q.left){q.left+="px"}a(l).css(a.extend({width:isNaN(n.width)?"auto":n.width+"px",height:isNaN(n.height)?"auto":n.height+"px",zIndex:n.zIndex,overflow:"hidden"},q)).attr({tabIndex:"-1",role:"dialog","aria-labelledby":j.modalhead,"aria-hidden":"true"});if(typeof n.drag=="undefined"){n.drag=true}if(typeof n.resize=="undefined"){n.resize=true}if(n.drag){a(v).css("cursor","move");if(a.fn.jqDrag){a(l).jqDrag(v)}else{try{a(l).draggable({handle:a("#"+v.id)})}catch(u){}}}if(n.resize){if(a.fn.jqResize){a(l).append("<div class='jqResize ui-resizable-handle ui-resizable-se ui-icon-os ui-icon-gripsmall-diagonal-se ui-icon-grip-diagonal-se'></div>");a("#"+j.themodal).jqResize(".jqResize",j.scrollelm?"#"+j.scrollelm:false)}else{try{a(l).resizable({handles:"se, sw",alsoResize:j.scrollelm?"#"+j.scrollelm:false})}catch(k){}}}if(n.closeOnEscape===true){a(l).keydown(function(r){if(r.which==27){var p=a("#"+j.themodal).data("onClose")||n.onClose;m.hideModal(this,{gb:n.gbox,jqm:n.jqModal,onClose:p})}})}},viewModal:function(b,d){d=a.extend({toTop:true,overlay:10,modal:false,onShow:this.showModal,onHide:this.closeModal,gbox:"",jqm:true,jqM:true},d||{});if(a.fn.jqm&&d.jqm===true){if(d.jqM){a(b).attr("aria-hidden","false").jqm(d).jqmShow()}else{a(b).attr("aria-hidden","false").jqmShow()}}else{if(d.gbox!==""){a(".jqgrid-overlay:first",d.gbox).show();a(b).data("gbox",d.gbox)}a(b).show().attr("aria-hidden","false");try{a(":input:visible",b)[0].focus()}catch(c){}}},info_dialog:function(q,k,c,p){var n={width:290,height:"auto",dataheight:"auto",drag:true,resize:false,caption:"<b>"+q+"</b>",left:250,top:170,zIndex:1000,jqModal:true,modal:false,closeOnEscape:true,align:"center",buttonalign:"center",buttons:[]};a.extend(n,p||{});var f=n.jqModal,r=this;if(a.fn.jqm&&!f){f=false}var h="";if(n.buttons.length>0){for(var g=0;g<n.buttons.length;g++){if(typeof n.buttons[g].id=="undefined"){n.buttons[g].id="info_button_"+g}h+="<a href='javascript:void(0)' id='"+n.buttons[g].id+"' class='fm-button ui-state-default-grid ui-corner-all-grid'>"+n.buttons[g].text+"</a>"}}var l=isNaN(n.dataheight)?n.dataheight:n.dataheight+"px",o="text-align:"+n.align+";";var b="<div id='info_id'>";b+="<div id='infocnt' style='margin:0px;padding-bottom:1em;width:100%;overflow:auto;position:relative;height:"+l+";"+o+"'>"+k+"</div>";b+=c?"<div class='ui-widget-content-grid ui-helper-clearfix-grid' style='text-align:"+n.buttonalign+";padding-bottom:0.8em;padding-top:0.5em;background-image: none;border-width: 1px 0 0 0;'><a href='javascript:void(0)' id='closedialog' class='fm-button ui-state-default-grid ui-corner-all-grid'>"+c+"</a>"+h+"</div>":h!==""?"<div class='ui-widget-content-grid ui-helper-clearfix-grid' style='text-align:"+n.buttonalign+";padding-bottom:0.8em;padding-top:0.5em;background-image: none;border-width: 1px 0 0 0;'>"+h+"</div>":"";b+="</div>";try{if(a("#info_dialog").attr("aria-hidden")=="false"){this.hideModal("#info_dialog",{jqm:f})}a("#info_dialog").remove()}catch(j){}this.createModal({themodal:"info_dialog",modalhead:"info_head",modalcontent:"info_content",scrollelm:"infocnt"},b,n,"","",true);if(h){a.each(n.buttons,function(e){a("#"+this.id,"#info_id").bind("click",function(){n.buttons[e].onClick.call(a("#info_dialog"));return false})})}a("#closedialog","#info_id").click(function(m){r.hideModal("#info_dialog",{jqm:f});return false});a(".fm-button","#info_dialog").hover(function(){a(this).addClass("ui-state-hover")},function(){a(this).removeClass("ui-state-hover")});if(a.isFunction(n.beforeOpen)){n.beforeOpen()}this.viewModal("#info_dialog",{onHide:function(e){e.w.hide().remove();if(e.o){e.o.remove()}},modal:n.modal,jqm:f});if(a.isFunction(n.afterOpen)){n.afterOpen()}try{a("#info_dialog").focus()}catch(d){}},createEl:function(f,g,u,k,s){var t="";function l(y,e){if(a.isFunction(e.dataInit)){e.dataInit(y)}if(e.dataEvents){a.each(e.dataEvents,function(){if(this.data!==undefined){a(y).bind(this.type,this.data,this.fn)}else{a(y).bind(this.type,this.fn)}})}return e}function q(A,z,y){var e=["dataInit","dataEvents","dataUrl","buildSelect","sopt","searchhidden","defaultValue","attr"];if(typeof(y)!="undefined"&&a.isArray(y)){e=a.extend(e,y)}a.each(z,function(B,C){if(a.inArray(B,e)===-1){a(A).attr(B,C)}});if(!z.hasOwnProperty("id")){a(A).attr("id",a.jgrid.randId())}}switch(f){case"textarea":t=document.createElement("textarea");if(k){if(!g.cols){a(t).css({width:"98%"})}}else{if(!g.cols){g.cols=20}}if(!g.rows){g.rows=2}if(u=="&nbsp;"||u=="&#160;"||(u.length==1&&u.charCodeAt(0)==160)){u=""}t.value=u;q(t,g);g=l(t,g);a(t).attr({role:"textbox",multiline:"true"});break;case"checkbox":t=document.createElement("input");t.type="checkbox";if(!g.value){var x=u.toLowerCase();if(x.search(/(false|0|no|off|undefined)/i)<0&&x!==""){t.checked=true;t.defaultChecked=true;t.value=u}else{t.value="on"}a(t).attr("offval","off")}else{var n=g.value.split(":");if(u===n[0]){t.checked=true;t.defaultChecked=true}t.value=n[0];a(t).attr("offval",n[1])}q(t,g,["value"]);g=l(t,g);a(t).attr("role","checkbox");break;case"select":t=document.createElement("select");t.setAttribute("role","select");var c,h=[];if(g.multiple===true){c=true;t.multiple="multiple";a(t).attr("aria-multiselectable","true")}else{c=false}if(typeof(g.dataUrl)!="undefined"){a.ajax(a.extend({url:g.dataUrl,type:"GET",dataType:"html",context:{elem:t,options:g,vl:u},success:function(B,A){var D,z=[],e=this.elem,y=this.vl,F=a.extend({},this.options),E=F.multiple===true;if(typeof(F.buildSelect)!="undefined"){var C=F.buildSelect(B);D=a(C).html()}else{D=a(B).html()}if(D){a(e).append(D);q(e,F);F=l(e,F);if(typeof F.size==="undefined"){F.size=E?3:1}if(E){z=y.split(",");z=a.map(z,function(G){return a.trim(G)})}else{z[0]=a.trim(y)}setTimeout(function(){a("option",e).each(function(G){a(this).attr("role","option");if(a.inArray(a.trim(a(this).text()),z)>-1||a.inArray(a.trim(a(this).val()),z)>-1){this.selected="selected"}})},0)}}},s||{}))}else{if(g.value){var o;if(c){h=u.split(",");h=a.map(h,function(e){return a.trim(e)});if(typeof g.size==="undefined"){g.size=3}}else{g.size=1}if(typeof g.value==="function"){g.value=g.value()}var p,m,j;if(typeof g.value==="string"){p=g.value.split(";");for(o=0;o<p.length;o++){m=p[o].split(":");if(m.length>2){m[1]=a.map(m,function(y,e){if(e>0){return y}}).join(":")}j=document.createElement("option");j.setAttribute("role","option");j.value=m[0];j.innerHTML=m[1];if(!c&&(a.trim(m[0])==a.trim(u)||a.trim(m[1])==a.trim(u))){j.selected="selected"}if(c&&(a.inArray(a.trim(m[1]),h)>-1||a.inArray(a.trim(m[0]),h)>-1)){j.selected="selected"}t.appendChild(j)}}else{if(typeof g.value==="object"){var d=g.value;for(var w in d){if(d.hasOwnProperty(w)){j=document.createElement("option");j.setAttribute("role","option");j.value=w;j.innerHTML=d[w];if(!c&&(a.trim(w)==a.trim(u)||a.trim(d[w])==a.trim(u))){j.selected="selected"}if(c&&(a.inArray(a.trim(d[w]),h)>-1||a.inArray(a.trim(w),h)>-1)){j.selected="selected"}t.appendChild(j)}}}}q(t,g,["value"]);g=l(t,g)}}break;case"text":case"password":case"button":var v;if(f=="button"){v="button"}else{v="textbox"}t=document.createElement("input");t.type=f;t.value=u;q(t,g);g=l(t,g);if(f!="button"){if(k){if(!g.size){a(t).css({width:"98%"})}}else{if(!g.size){g.size=20}}}a(t).attr("role",v);break;case"image":case"file":t=document.createElement("input");t.type=f;q(t,g);g=l(t,g);break;case"custom":t=document.createElement("span");try{if(a.isFunction(g.custom_element)){var b=g.custom_element.call(this,u,g);if(b){b=a(b).addClass("customelement").attr({id:g.id,name:g.name});a(t).empty().append(b)}else{throw"e2"}}else{throw"e1"}}catch(r){if(r=="e1"){this.info_dialog(a.jgrid.errors.errcap,"function 'custom_element' "+a.jgrid.edit.msg.nodefined,a.jgrid.edit.bClose)}if(r=="e2"){this.info_dialog(a.jgrid.errors.errcap,"function 'custom_element' "+a.jgrid.edit.msg.novalue,a.jgrid.edit.bClose)}else{this.info_dialog(a.jgrid.errors.errcap,typeof(r)==="string"?r:r.message,a.jgrid.edit.bClose)}}break}return t},checkDate:function(o,d){var m=function(j){return(((j%4===0)&&(j%100!==0||(j%400===0)))?29:28)},l=function(r){for(var j=1;j<=r;j++){this[j]=31;if(j==4||j==6||j==9||j==11){this[j]=30}if(j==2){this[j]=29}}return this};var f={},q;o=o.toLowerCase();if(o.indexOf("/")!=-1){q="/"}else{if(o.indexOf("-")!=-1){q="-"}else{if(o.indexOf(".")!=-1){q="."}else{q="/"}}}o=o.split(q);d=d.split(q);if(d.length!=3){return false}var h=-1,p,g=-1,e=-1;for(var k=0;k<o.length;k++){var c=isNaN(d[k])?0:parseInt(d[k],10);f[o[k]]=c;p=o[k];if(p.indexOf("y")!=-1){h=k}if(p.indexOf("m")!=-1){e=k}if(p.indexOf("d")!=-1){g=k}}if(o[h]=="y"||o[h]=="yyyy"){p=4}else{if(o[h]=="yy"){p=2}else{p=-1}}var b=l(12),n;if(h===-1){return false}else{n=f[o[h]].toString();if(p==2&&n.length==1){p=1}if(n.length!=p||(f[o[h]]===0&&d[h]!="00")){return false}}if(e===-1){return false}else{n=f[o[e]].toString();if(n.length<1||f[o[e]]<1||f[o[e]]>12){return false}}if(g===-1){return false}else{n=f[o[g]].toString();if(n.length<1||f[o[g]]<1||f[o[g]]>31||(f[o[e]]==2&&f[o[g]]>m(f[o[h]]))||f[o[g]]>b[f[o[e]]]){return false}}return true},isEmpty:function(b){if(b.match(/^\s+$/)||b===""){return true}else{return false}},checkTime:function(d){var c=/^(\d{1,2}):(\d{2})([ap]m)?$/,b;if(!this.isEmpty(d)){b=d.match(c);if(b){if(b[3]){if(b[1]<1||b[1]>12){return false}}else{if(b[1]>23){return false}}if(b[2]>59){return false}}else{return false}}return true},checkValues:function(d,p,l,q,j){var h,k,r,c,m;if(typeof(q)==="undefined"){if(typeof(p)=="string"){for(k=0,m=l.p.colModel.length;k<m;k++){if(l.p.colModel[k].name==p){h=l.p.colModel[k].editrules;p=k;try{r=l.p.colModel[k].formoptions.label}catch(o){}break}}}else{if(p>=0){h=l.p.colModel[p].editrules}}}else{h=q;r=j===undefined?"_":j}if(h){if(!r){r=l.p.colNames[p]}if(h.required===true){if(this.isEmpty(d)){return[false,r+": "+a.jgrid.edit.msg.required,""]}}var f=h.required===false?false:true;if(h.number===true){if(!(f===false&&this.isEmpty(d))){if(isNaN(d)){return[false,r+": "+a.jgrid.edit.msg.number,""]}}}if(typeof h.minValue!="undefined"&&!isNaN(h.minValue)){if(parseFloat(d)<parseFloat(h.minValue)){return[false,r+": "+a.jgrid.edit.msg.minValue+" "+h.minValue,""]}}if(typeof h.maxValue!="undefined"&&!isNaN(h.maxValue)){if(parseFloat(d)>parseFloat(h.maxValue)){return[false,r+": "+a.jgrid.edit.msg.maxValue+" "+h.maxValue,""]}}var b;if(h.email===true){if(!(f===false&&this.isEmpty(d))){b=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i;if(!b.test(d)){return[false,r+": "+a.jgrid.edit.msg.email,""]}}}if(h.integer===true){if(!(f===false&&this.isEmpty(d))){if(isNaN(d)){return[false,r+": "+a.jgrid.edit.msg.integer,""]}if((d%1!==0)||(d.indexOf(".")!=-1)){return[false,r+": "+a.jgrid.edit.msg.integer,""]}}}if(h.date===true){if(!(f===false&&this.isEmpty(d))){if(l.p.colModel[p].formatoptions&&l.p.colModel[p].formatoptions.newformat){c=l.p.colModel[p].formatoptions.newformat}else{c=l.p.colModel[p].datefmt||"Y-m-d"}if(!this.checkDate(c,d)){return[false,r+": "+a.jgrid.edit.msg.date+" - "+c,""]}}}if(h.time===true){if(!(f===false&&this.isEmpty(d))){if(!this.checkTime(d)){return[false,r+": "+a.jgrid.edit.msg.date+" - hh:mm (am/pm)",""]}}}if(h.url===true){if(!(f===false&&this.isEmpty(d))){b=/^(((https?)|(ftp)):\/\/([\-\w]+\.)+\w{2,3}(\/[%\-\w]+(\.\w{2,})?)*(([\w\-\.\?\\\/+@&#;`~=%!]*)(\.\w{2,})?)*\/?)/i;if(!b.test(d)){return[false,r+": "+a.jgrid.edit.msg.url,""]}}}if(h.custom===true){if(!(f===false&&this.isEmpty(d))){if(a.isFunction(h.custom_func)){var n=h.custom_func.call(l,d,r);if(a.isArray(n)){return n}else{return[false,a.jgrid.edit.msg.customarray,""]}}else{return[false,a.jgrid.edit.msg.customfcheck,""]}}}}return[true,"",""]}})})(jQuery);(function(a){a.fn.jqFilter=function(b){if(typeof b==="string"){var d=a.fn.jqFilter[b];if(!d){throw ("jqFilter - No such method: "+b)}var c=a.makeArray(arguments).slice(1);return d.apply(this,c)}var e=a.extend(true,{filter:null,columns:[],onChange:null,checkValues:null,error:false,errmsg:"",errorcheck:true,showQuery:true,sopt:null,ops:[{name:"eq",description:"equal",operator:"="},{name:"ne",description:"not equal",operator:"<>"},{name:"lt",description:"less",operator:"<"},{name:"le",description:"less or equal",operator:"<="},{name:"gt",description:"greater",operator:">"},{name:"ge",description:"greater or equal",operator:">="},{name:"bw",description:"begins with",operator:"LIKE"},{name:"bn",description:"does not begin with",operator:"NOT LIKE"},{name:"in",description:"in",operator:"IN"},{name:"ni",description:"not in",operator:"NOT IN"},{name:"ew",description:"ends with",operator:"LIKE"},{name:"en",description:"does not end with",operator:"NOT LIKE"},{name:"cn",description:"contains",operator:"LIKE"},{name:"nc",description:"does not contain",operator:"NOT LIKE"},{name:"nu",description:"is null",operator:"IS NULL"},{name:"nn",description:"is not null",operator:"IS NOT NULL"}],numopts:["eq","ne","lt","le","gt","ge","nu","nn","in","ni"],stropts:["eq","ne","bw","bn","ew","en","cn","nc","nu","nn","in","ni"],_gridsopt:[],groupOps:["AND","OR"],groupButton:true},b||{});return this.each(function(){if(this.filter){return}this.p=e;if(this.p.filter===null||this.p.filter===undefined){this.p.filter={groupOp:this.p.groupOps[0],rules:[],groups:[]}}var j,f=this.p.columns.length,g,k=/msie/i.test(navigator.userAgent)&&!window.opera;if(this.p._gridsopt.length){for(j=0;j<this.p._gridsopt.length;j++){this.p.ops[j].description=this.p._gridsopt[j]}}this.p.initFilter=a.extend(true,{},this.p.filter);if(!f){return}for(j=0;j<f;j++){g=this.p.columns[j];if(g.stype){g.inputtype=g.stype}else{if(!g.inputtype){g.inputtype="text"}}if(g.sorttype){g.searchtype=g.sorttype}else{if(!g.searchtype){g.searchtype="string"}}if(g.hidden===undefined){g.hidden=false}if(!g.label){g.label=g.name}if(g.index){g.name=g.index}if(!g.hasOwnProperty("searchoptions")){g.searchoptions={}}if(!g.hasOwnProperty("searchrules")){g.searchrules={}}}if(this.p.showQuery){a(this).append("<table class='queryresult ui-widget-grid ui-widget-content-grid' style='display:block;max-width:440px;border:0px none;'><tbody><tr><td class='query'></td></tr></tbody></table>")}var h=function(o,l){var m=[true,""];if(a.isFunction(l.searchrules)){m=l.searchrules(o,l)}else{if(a.jgrid&&a.jgrid.checkValues){try{m=a.jgrid.checkValues(o,-1,null,l.searchrules,l.label)}catch(n){}}}if(m&&m.length&&m[0]===false){e.error=!m[0];e.errmsg=m[1]}};this.onchange=function(){this.p.error=false;this.p.errmsg="";return a.isFunction(this.p.onChange)?this.p.onChange.call(this,this.p):false};this.reDraw=function(){a("table.group:first",this).remove();var l=this.createTableForGroup(e.filter,null);a(this).append(l)};this.createTableForGroup=function(z,A){var s=this,p;var B=a("<table class='group ui-widget-grid ui-widget-content-grid' style='border:0px none;'><tbody></tbody></table>");if(A===null){a(B).append("<tr class='error' style='display:none;'><th colspan='5' class='ui-state-error' align='left'></th></tr>")}var w=a("<tr></tr>");a(B).append(w);var l=a("<th colspan='5' align='left'></th>");w.append(l);var r=a("<select class='opsel'></select>");l.append(r);var v="",o;for(p=0;p<e.groupOps.length;p++){o=z.groupOp===s.p.groupOps[p]?" selected='selected'":"";v+="<option value='"+s.p.groupOps[p]+"'"+o+">"+s.p.groupOps[p]+"</option>"}r.append(v).bind("change",function(){z.groupOp=a(r).val();s.onchange()});var t="<span></span>";if(this.p.groupButton){t=a("<input type='button' value='+ {}' title='Add subgroup' class='add-group'/>");t.bind("click",function(){if(z.groups===undefined){z.groups=[]}z.groups.push({groupOp:e.groupOps[0],rules:[],groups:[]});s.reDraw();s.onchange();return false})}l.append(t);var n=a("<input type='button' value='+' title='Add rule' class='add-rule ui-add'/>"),y;n.bind("click",function(){if(z.rules===undefined){z.rules=[]}for(p=0;p<s.p.columns.length;p++){var C=(typeof s.p.columns[p].search==="undefined")?true:s.p.columns[p].search,F=(s.p.columns[p].hidden===true),E=(s.p.columns[p].searchoptions.searchhidden===true);if((E&&C)||(C&&!F)){y=s.p.columns[p];break}}var D;if(y.searchoptions.sopt){D=y.searchoptions.sopt}else{if(s.p.sopt){D=s.p.sopt}else{if(y.searchtype==="string"){D=s.p.stropts}else{D=s.p.numopts}}}z.rules.push({field:y.name,op:D[0],data:""});s.reDraw();return false});l.append(n);if(A!==null){var u=a("<input type='button' value='-' title='Delete group' class='delete-group'/>");l.append(u);u.bind("click",function(){for(p=0;p<A.groups.length;p++){if(A.groups[p]===z){A.groups.splice(p,1);break}}s.reDraw();s.onchange();return false})}if(z.groups!==undefined){for(p=0;p<z.groups.length;p++){var q=a("<tr></tr>");B.append(q);var m=a("<td class='first'></td>");q.append(m);var x=a("<td colspan='4'></td>");x.append(this.createTableForGroup(z.groups[p],z));q.append(x)}}if(z.groupOp===undefined){z.groupOp=s.p.groupOps[0]}if(z.rules!==undefined){for(p=0;p<z.rules.length;p++){B.append(this.createTableRowForRule(z.rules[p],z))}}return B};this.createTableRowForRule=function(u,w){var v=this,m=a("<tr></tr>"),G,y,o,x,B="",A;m.append("<td class='first'></td>");var p=a("<td class='columns'></td>");m.append(p);var H=a("<select></select>"),z,D=[];p.append(H);H.bind("change",function(){u.field=a(H).val();o=a(this).parents("tr:first");for(G=0;G<v.p.columns.length;G++){if(v.p.columns[G].name===u.field){x=v.p.columns[G];break}}if(!x){return}x.searchoptions.id=a.jgrid.randId();if(k&&x.inputtype==="text"){if(!x.searchoptions.size){x.searchoptions.size=10}}var L=a.jgrid.createEl(x.inputtype,x.searchoptions,"",true,v.p.ajaxSelectOptions,true);a(L).addClass("input-elm");if(x.searchoptions.sopt){y=x.searchoptions.sopt}else{if(v.p.sopt){y=v.p.sopt}else{if(x.searchtype==="string"){y=v.p.stropts}else{y=v.p.numopts}}}var J="",K="";D=[];a.each(v.p.ops,function(){D.push(this.name)});for(G=0;G<y.length;G++){z=a.inArray(y[G],D);if(z!==-1){K="";if(G===0){u.op=v.p.ops[z].name;K=" selected='selected'"}J+="<option value='"+v.p.ops[z].name+"'"+K+">"+v.p.ops[z].description+"</option>"}}a(".selectopts",o).empty().append(J);a(".data",o).empty().append(L);a(".input-elm",o).bind("change",function(){u.data=a(this).val();v.onchange()});setTimeout(function(){u.data=a(L).val();v.onchange()},0)});var E=0;for(G=0;G<v.p.columns.length;G++){var s=(typeof v.p.columns[G].search==="undefined")?true:v.p.columns[G].search,F=(v.p.columns[G].hidden===true),I=(v.p.columns[G].searchoptions.searchhidden===true);if((I&&s)||(s&&!F)){A="";if(u.field===v.p.columns[G].name){A=" selected='selected'";E=G}B+="<option value='"+v.p.columns[G].name+"'"+A+">"+v.p.columns[G].label+"</option>"}}H.append(B);var C=a("<td class='operators'></td>");m.append(C);x=e.columns[E];x.searchoptions.id=a.jgrid.randId();if(k&&x.inputtype==="text"){if(!x.searchoptions.size){x.searchoptions.size=10}}var n=a.jgrid.createEl(x.inputtype,x.searchoptions,u.data,true,v.p.ajaxSelectOptions,true);var l=a("<select class='selectopts'></select>");C.append(l);l.bind("change",function(){u.op=a(l).val();o=a(this).parents("tr:first");var J=a(".input-elm",o)[0];if(u.op==="nu"||u.op==="nn"){u.data="";J.value="";J.setAttribute("readonly","true");J.setAttribute("disabled","true")}else{J.removeAttribute("readonly");J.removeAttribute("disabled")}v.onchange()});if(x.searchoptions.sopt){y=x.searchoptions.sopt}else{if(v.p.sopt){y=v.p.sopt}else{if(x.searchtype==="string"){y=e.stropts}else{y=v.p.numopts}}}B="";a.each(v.p.ops,function(){D.push(this.name)});for(G=0;G<y.length;G++){z=a.inArray(y[G],D);if(z!==-1){A=u.op===v.p.ops[z].name?" selected='selected'":"";B+="<option value='"+v.p.ops[z].name+"'"+A+">"+v.p.ops[z].description+"</option>"}}l.append(B);var r=a("<td class='data'></td>");m.append(r);r.append(n);a(n).addClass("input-elm").bind("change",function(){u.data=a(this).val();v.onchange()});var t=a("<td></td>");m.append(t);var q=a("<input type='button' value='-' title='Delete rule' class='delete-rule ui-del'/>");t.append(q);q.bind("click",function(){for(G=0;G<w.rules.length;G++){if(w.rules[G]===u){w.rules.splice(G,1);break}}v.reDraw();v.onchange();return false});return m};this.getStringForGroup=function(o){var m="(",l;if(o.groups!==undefined){for(l=0;l<o.groups.length;l++){if(m.length>1){m+=" "+o.groupOp+" "}try{m+=this.getStringForGroup(o.groups[l])}catch(p){alert(p)}}}if(o.rules!==undefined){try{for(l=0;l<o.rules.length;l++){if(m.length>1){m+=" "+o.groupOp+" "}m+=this.getStringForRule(o.rules[l])}}catch(n){alert(n)}}m+=")";if(m==="()"){return""}else{return m}};this.getStringForRule=function(q){var n="",s="",p,m,o,r,l=["int","integer","float","number","currency"];for(p=0;p<this.p.ops.length;p++){if(this.p.ops[p].name===q.op){n=this.p.ops[p].operator;s=this.p.ops[p].name;break}}for(p=0;p<this.p.columns.length;p++){if(this.p.columns[p].name===q.field){m=this.p.columns[p];break}}r=q.data;if(s==="bw"||s==="bn"){r=r+"%"}if(s==="ew"||s==="en"){r="%"+r}if(s==="cn"||s==="nc"){r="%"+r+"%"}if(s==="in"||s==="ni"){r=" ("+r+")"}if(e.errorcheck){h(q.data,m)}if(a.inArray(m.searchtype,l)!==-1||s==="nn"||s==="nu"){o=q.field+" "+n+" "+r}else{o=q.field+" "+n+' "'+r+'"'}return o};this.resetFilter=function(){this.p.filter=a.extend(true,{},this.p.initFilter);this.reDraw();this.onchange()};this.hideError=function(){a("th.ui-state-error",this).html("");a("tr.error",this).hide()};this.showError=function(){a("th.ui-state-error",this).html(this.p.errmsg);a("tr.error",this).show()};this.toUserFriendlyString=function(){return this.getStringForGroup(e.filter)};this.toString=function(){var m=this;function n(q){if(m.p.errorcheck){var p,o;for(p=0;p<m.p.columns.length;p++){if(m.p.columns[p].name===q.field){o=m.p.columns[p];break}}if(o){h(q.data,o)}}return q.op+"(item."+q.field+",'"+q.data+"')"}function l(q){var p="(",o;if(q.groups!==undefined){for(o=0;o<q.groups.length;o++){if(p.length>1){if(q.groupOp==="OR"){p+=" || "}else{p+=" && "}}p+=l(q.groups[o])}}if(q.rules!==undefined){for(o=0;o<q.rules.length;o++){if(p.length>1){if(q.groupOp==="OR"){p+=" || "}else{p+=" && "}}p+=n(q.rules[o])}}p+=")";if(p==="()"){return""}else{return p}}return l(this.p.filter)};this.reDraw();if(this.p.showQuery){this.onchange()}this.filter=true})};a.extend(a.fn.jqFilter,{toSQLString:function(){var b="";this.each(function(){b=this.toUserFriendlyString()});return b},filterData:function(){var b;this.each(function(){b=this.p.filter});return b},getParameter:function(b){if(b!==undefined){if(this.p.hasOwnProperty(b)){return this.p[b]}}return this.p},resetFilter:function(){return this.each(function(){this.resetFilter()})},addFilter:function(b){if(typeof b==="string"){b=jQuery.jgrid.parse(b)}this.each(function(){this.p.filter=b;this.reDraw();this.onchange()})}})})(jQuery);(function(b){var a=null;b.jgrid.extend({searchGrid:function(c){c=b.extend({recreateFilter:false,drag:true,sField:"searchField",sValue:"searchString",sOper:"searchOper",sFilter:"filters",loadDefaults:true,beforeShowSearch:null,afterShowSearch:null,onInitializeSearch:null,closeAfterSearch:false,closeAfterReset:false,closeOnEscape:false,multipleSearch:false,multipleGroup:false,top:0,left:0,jqModal:true,modal:false,resize:false,width:450,height:"auto",dataheight:"auto",showQuery:false,errorcheck:true,sopt:null,stringResult:undefined,onClose:null,onSearch:null,onReset:null,toTop:true,overlay:10,columns:[],tmplNames:null,tmplFilters:null,tmplLabel:" Template: ",showOnLoad:false,layer:null},b.jgrid.search,c||{});return this.each(function(){var r=this;if(!r.grid){return}var d="fbox_"+r.p.id,j=true,f={themodal:"searchmod"+d,modalhead:"searchhd"+d,modalcontent:"searchcnt"+d,scrollelm:d},g=r.p.postData[c.sFilter];if(typeof(g)==="string"){g=b.jgrid.parse(g)}if(c.recreateFilter===true){b("#"+f.themodal).remove()}function h(){if(b.isFunction(c.beforeShowSearch)){j=c.beforeShowSearch(b("#"+d));if(typeof(j)==="undefined"){j=true}}if(j){b.jgrid.viewModal("#"+f.themodal,{gbox:"#gbox_"+d,jqm:c.jqModal,modal:c.modal,overlay:c.overlay,toTop:c.toTop});if(b.isFunction(c.afterShowSearch)){c.afterShowSearch(b("#"+d))}}}function s(){b(".add-rule","#"+d).hide();b(".delete-rule","#"+d).hide();b(".opsel","#"+d).hide()}if(b("#"+f.themodal).html()!==null){h()}else{var t=b("<span><div id='"+d+"' class='searchFilter' style='overflow:auto'></div></span>").insertBefore("#gview_"+r.p.id);if(b.isFunction(c.onInitializeSearch)){c.onInitializeSearch(b("#"+d))}var e=b.extend([],r.p.colModel),o="<a href='javascript:void(0)' id='"+d+"_search' class='fm-button ui-state-default-grid ui-corner-all-grid fm-button-icon-right ui-reset'><span class='ui-icon-os ui-icon-search'></span>"+c.Find+"</a>",v="<a href='javascript:void(0)' id='"+d+"_reset' class='fm-button ui-state-default-grid ui-corner-all-grid fm-button-icon-left ui-search'><span class='ui-icon-os ui-icon-arrowreturnthick-1-w'></span>"+c.Reset+"</a>",p="",k="",m,n=false,u,q=-1;if(c.showQuery){p="<a href='javascript:void(0)' id='"+d+"_query' class='fm-button ui-state-default-grid ui-corner-all-grid fm-button-icon-left'><span class='ui-icon-os ui-icon-comment'></span>Query</a>"}if(!c.columns.length){b.each(e,function(x,A){if(!A.label){A.label=r.p.colNames[x]}if(!n){var w=(typeof A.search==="undefined")?true:A.search,z=(A.hidden===true),y=(A.searchoptions&&A.searchoptions.searchhidden===true);if((y&&w)||(w&&!z)){n=true;m=A.index||A.name;q=x}}})}else{e=c.columns}if((!g&&m)||c.multipleSearch===false){var l="eq";if(q>=0&&e[q].searchoptions&&e[q].searchoptions.sopt){l=e[q].searchoptions.sopt[0]}else{if(c.sopt&&c.sopt.length){l=c.sopt[0]}}g={groupOp:"AND",rules:[{field:m,op:l,data:""}]}}n=false;if(c.tmplNames&&c.tmplNames.length){n=true;k=c.tmplLabel;k+="<select class='ui-template'>";k+="<option value='default'>Default</option>";b.each(c.tmplNames,function(w,x){k+="<option value='"+w+"'>"+x+"</option>"});k+="</select>"}u="<table class='EditTable' style='border:0px none;margin-top:5px' id='"+d+"_2'><tbody><tr><td colspan='2'><hr class='ui-widget-content-grid' style='margin:1px'/></td></tr><tr><td class='EditButton' style='text-align:left'>"+v+k+"</td><td class='EditButton'>"+p+o+"</td></tr></tbody></table>";b("#"+d).jqFilter({columns:e,filter:c.loadDefaults?g:null,showQuery:c.showQuery,errorcheck:c.errorcheck,sopt:c.sopt,groupButton:c.multipleGroup,_gridsopt:b.jgrid.search.odata,onChange:function(w){if(this.p.showQuery){b(".query",this).html(this.toUserFriendlyString())}}});t.append(u);if(n&&c.tmplFilters&&c.tmplFilters.length){b(".ui-template",t).bind("change",function(x){var w=b(this).val();if(w=="default"){b("#"+d).jqFilter("addFilter",g)}else{b("#"+d).jqFilter("addFilter",c.tmplFilters[parseInt(w,10)])}return false})}if(c.multipleSearch===false){s()}if(b.isFunction(c.onInitializeSearch)){c.onInitializeSearch(b("#"+d))}if(c.layer){b.jgrid.createModal(f,t,c,"#gview_"+r.p.id,b("#gbox_"+r.p.id)[0],"#"+c.layer,{position:"relative"})}else{b.jgrid.createModal(f,t,c,"#gview_"+r.p.id,b("#gbox_"+r.p.id)[0])}if(p){b("#"+d+"_query").bind("click",function(w){b(".queryresult",t).toggle();return false})}if(c.stringResult===undefined){c.stringResult=c.multipleSearch}b("#"+d+"_search").bind("click",function(){var z=b("#"+d),x={},w,y=z.jqFilter("filterData");if(c.errorcheck){z[0].hideError();if(!c.showQuery){z.jqFilter("toSQLString")}if(z[0].p.error){z[0].showError();return false}}if(c.stringResult){try{w=xmlJsonClass.toJson(y,"","",false)}catch(B){try{w=JSON.stringify(y)}catch(A){}}if(typeof(w)==="string"){x[c.sFilter]=w;b.each([c.sField,c.sValue,c.sOper],function(){x[this]=""})}}else{if(c.multipleSearch){x[c.sFilter]=y;b.each([c.sField,c.sValue,c.sOper],function(){x[this]=""})}else{x[c.sField]=y.rules[0].field;x[c.sValue]=y.rules[0].data;x[c.sOper]=y.rules[0].op;x[c.sFilter]=""}}r.p.search=true;b.extend(r.p.postData,x);if(b.isFunction(c.onSearch)){c.onSearch()}b(r).trigger("reloadGrid",[{page:1}]);if(c.closeAfterSearch){b.jgrid.hideModal("#"+f.themodal,{gb:"#gbox_"+r.p.id,jqm:c.jqModal,onClose:c.onClose})}return false});b("#"+d+"_reset").bind("click",function(){var w={},x=b("#"+d);r.p.search=false;if(c.multipleSearch===false){w[c.sField]=w[c.sValue]=w[c.sOper]=""}else{w[c.sFilter]=""}x[0].resetFilter();if(n){b(".ui-template",t).val("default")}b.extend(r.p.postData,w);if(b.isFunction(c.onReset)){c.onReset()}if(c.multipleSearch===false){s()}b(r).trigger("reloadGrid",[{page:1}]);return false});h();b(".fm-button:not(.ui-state-disabled)",t).hover(function(){b(this).addClass("ui-state-hover")},function(){b(this).removeClass("ui-state-hover")})}})},editGridRow:function(c,d){d=b.extend({top:0,left:0,width:300,height:"auto",dataheight:"auto",modal:false,overlay:10,drag:true,resize:true,url:null,mtype:"POST",clearAfterAdd:true,closeAfterEdit:false,reloadAfterSubmit:true,onInitializeForm:null,beforeInitData:null,beforeShowForm:null,afterShowForm:null,beforeSubmit:null,afterSubmit:null,onclickSubmit:null,afterComplete:null,onclickPgButtons:null,afterclickPgButtons:null,editData:{},recreateForm:false,jqModal:true,closeOnEscape:false,addedrow:"first",topinfo:"",bottominfo:"",saveicon:[],closeicon:[],savekey:[false,13],navkeys:[false,38,40],checkOnSubmit:false,checkOnUpdate:false,_savedData:{},processing:false,onClose:null,ajaxEditOptions:{},serializeEditData:null,viewPagerButtons:true},b.jgrid.edit,d||{});a=d;return this.each(function(){var e=this;if(!e.grid||!c){return}var B=e.p.id,y="FrmGrid_"+B,v="TblGrid_"+B,j={themodal:"editmod"+B,modalhead:"edithd"+B,modalcontent:"editcnt"+B,scrollelm:y},C=b.isFunction(a.beforeShowForm)?a.beforeShowForm:false,M=b.isFunction(a.afterShowForm)?a.afterShowForm:false,L=b.isFunction(a.beforeInitData)?a.beforeInitData:false,p=b.isFunction(a.onInitializeForm)?a.onInitializeForm:false,G=null,X=true,H=1,r=0,D,P,F,A;if(c==="new"){c="_empty";d.caption=a.addCaption}else{d.caption=a.editCaption}if(d.recreateForm===true&&b("#"+j.themodal).html()!==null){b("#"+j.themodal).remove()}var m=true;if(d.checkOnUpdate&&d.jqModal&&!d.modal){m=false}function W(){b(".FormElement","#"+v).each(function(ab){var ae=b(".customelement",this);if(ae.length){var ac=ae[0],Z=b(ac).attr("name");b.each(e.p.colModel,function(af,ah){if(this.name===Z&&this.editoptions&&b.isFunction(this.editoptions.custom_value)){try{D[Z]=this.editoptions.custom_value(b("#"+b.jgrid.jqID(Z),"#"+v),"get");if(D[Z]===undefined){throw"e1"}}catch(ag){if(ag==="e1"){b.jgrid.info_dialog(jQuery.jgrid.errors.errcap,"function 'custom_value' "+b.jgrid.edit.msg.novalue,jQuery.jgrid.edit.bClose)}else{b.jgrid.info_dialog(jQuery.jgrid.errors.errcap,ag.message,jQuery.jgrid.edit.bClose)}}return true}})}else{switch(b(this).get(0).type){case"checkbox":if(b(this).attr("checked")){D[this.name]=b(this).val()}else{var aa=b(this).attr("offval");D[this.name]=aa}break;case"select-one":D[this.name]=b("option:selected",this).val();P[this.name]=b("option:selected",this).text();break;case"select-multiple":D[this.name]=b(this).val();if(D[this.name]){D[this.name]=D[this.name].join(",")}else{D[this.name]=""}var ad=[];b("option:selected",this).each(function(af,ag){ad[af]=b(ag).text()});P[this.name]=ad.join(",");break;case"password":case"text":case"textarea":case"button":D[this.name]=b(this).val();break}if(e.p.autoencode){D[this.name]=b.jgrid.htmlEncode(D[this.name])}}});return true}function t(ab,ai,af,ad){var ap,aj,aa,ae=0,ah,ao,Z,al=[],ac=false,ak="<td class='CaptionTD'>&#160;</td><td class='DataTD'>&#160;</td>",an="",ag;for(ag=1;ag<=ad;ag++){an+=ak}if(ab!="_empty"){ac=b(ai).jqGrid("getInd",ab)}b(ai.p.colModel).each(function(at){ap=this.name;if(this.editrules&&this.editrules.edithidden===true){aj=false}else{aj=this.hidden===true?true:false}ao=aj?"style='display:none'":"";if(ap!=="cb"&&ap!=="subgrid"&&this.editable===true&&ap!=="rn"){if(ac===false){ah=""}else{if(ap==ai.p.ExpandColumn&&ai.p.treeGrid===true){ah=b("td:eq("+at+")",ai.rows[ac]).text()}else{try{ah=b.unformat(b("td:eq("+at+")",ai.rows[ac]),{rowId:ab,colModel:this},at)}catch(aq){ah=(this.edittype&&this.edittype=="textarea")?b("td:eq("+at+")",ai.rows[ac]).text():b("td:eq("+at+")",ai.rows[ac]).html()}if(ah=="&nbsp;"||ah=="&#160;"||(ah.length==1&&ah.charCodeAt(0)==160)){ah=""}}}var ar=b.extend({},this.editoptions||{},{id:ap,name:ap}),ax=b.extend({},{elmprefix:"",elmsuffix:"",rowabove:false,rowcontent:""},this.formoptions||{}),au=parseInt(ax.rowpos,10)||ae+1,aw=parseInt((parseInt(ax.colpos,10)||1)*2,10);if(ab=="_empty"&&ar.defaultValue){ah=b.isFunction(ar.defaultValue)?ar.defaultValue():ar.defaultValue}if(!this.edittype){this.edittype="text"}if(e.p.autoencode){ah=b.jgrid.htmlDecode(ah)}Z=b.jgrid.createEl(this.edittype,ar,ah,false,b.extend({},b.jgrid.ajaxOptions,ai.p.ajaxSelectOptions||{}));if(ah===""&&this.edittype=="checkbox"){ah=b(Z).attr("offval")}if(ah===""&&this.edittype=="select"){ah=b("option:eq(0)",Z).text()}if(a.checkOnSubmit||a.checkOnUpdate){a._savedData[ap]=ah}b(Z).addClass("FormElement");if(this.edittype=="text"||this.edittype=="textarea"){b(Z).addClass("ui-widget-content-grid ui-corner-all-grid")}aa=b(af).find("tr[rowpos="+au+"]");if(ax.rowabove){var av=b("<tr><td class='contentinfo' colspan='"+(ad*2)+"'>"+ax.rowcontent+"</td></tr>");b(af).append(av);av[0].rp=au}if(aa.length===0){aa=b("<tr "+ao+" rowpos='"+au+"'></tr>").addClass("FormData").attr("id","tr_"+ap);b(aa).append(an);b(af).append(aa);aa[0].rp=au}b("td:eq("+(aw-2)+")",aa[0]).html(typeof ax.label==="undefined"?ai.p.colNames[at]:ax.label);b("td:eq("+(aw-1)+")",aa[0]).append(ax.elmprefix).append(Z).append(ax.elmsuffix);al[ae]=at;ae++}});if(ae>0){var am=b("<tr class='FormData' style='display:none'><td class='CaptionTD'></td><td colspan='"+(ad*2-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='"+ai.p.id+"_id' value='"+ab+"'/></td></tr>");am[0].rp=ae+999;b(af).append(am);if(a.checkOnSubmit||a.checkOnUpdate){a._savedData[ai.p.id+"_id"]=ab}}return al}function q(Z,ag,ac){var ak,ad=0,ah,af,aa,ae,ai;if(a.checkOnSubmit||a.checkOnUpdate){a._savedData={};a._savedData[ag.p.id+"_id"]=Z}var aj=ag.p.colModel;if(Z=="_empty"){b(aj).each(function(al){ak=this.name;aa=b.extend({},this.editoptions||{});af=b("#"+b.jgrid.jqID(ak),"#"+ac);if(af&&af.length&&af[0]!==null){ae="";if(aa.defaultValue){ae=b.isFunction(aa.defaultValue)?aa.defaultValue():aa.defaultValue;if(af[0].type=="checkbox"){ai=ae.toLowerCase();if(ai.search(/(false|0|no|off|undefined)/i)<0&&ai!==""){af[0].checked=true;af[0].defaultChecked=true;af[0].value=ae}else{af.attr({checked:"",defaultChecked:""})}}else{af.val(ae)}}else{if(af[0].type=="checkbox"){af[0].checked=false;af[0].defaultChecked=false;ae=b(af).attr("offval")}else{if(af[0].type&&af[0].type.substr(0,6)=="select"){af[0].selectedIndex=0}else{af.val(ae)}}}if(a.checkOnSubmit===true||a.checkOnUpdate){a._savedData[ak]=ae}}});b("#id_g","#"+ac).val(Z);return}var ab=b(ag).jqGrid("getInd",Z,true);if(!ab){return}b("td",ab).each(function(ao){ak=aj[ao].name;if(ak!=="cb"&&ak!=="subgrid"&&ak!=="rn"&&aj[ao].editable===true){if(ak==ag.p.ExpandColumn&&ag.p.treeGrid===true){ah=b(this).text()}else{try{ah=b.unformat(b(this),{rowId:Z,colModel:aj[ao]},ao)}catch(an){ah=aj[ao].edittype=="textarea"?b(this).text():b(this).html()}}if(e.p.autoencode){ah=b.jgrid.htmlDecode(ah)}if(a.checkOnSubmit===true||a.checkOnUpdate){a._savedData[ak]=ah}ak=b.jgrid.jqID(ak);switch(aj[ao].edittype){case"password":case"text":case"button":case"image":case"textarea":if(ah=="&nbsp;"||ah=="&#160;"||(ah.length==1&&ah.charCodeAt(0)==160)){ah=""}b("#"+ak,"#"+ac).val(ah);break;case"select":var am=ah.split(",");am=b.map(am,function(aq){return b.trim(aq)});b("#"+ak+" option","#"+ac).each(function(aq){if(!aj[ao].editoptions.multiple&&(am[0]==b.trim(b(this).text())||am[0]==b.trim(b(this).val()))){this.selected=true}else{if(aj[ao].editoptions.multiple){if(b.inArray(b.trim(b(this).text()),am)>-1||b.inArray(b.trim(b(this).val()),am)>-1){this.selected=true}else{this.selected=false}}else{this.selected=false}}});break;case"checkbox":ah=ah+"";if(aj[ao].editoptions&&aj[ao].editoptions.value){var al=aj[ao].editoptions.value.split(":");if(al[0]==ah){b("#"+ak,"#"+ac).attr("checked",true);b("#"+ak,"#"+ac).attr("defaultChecked",true)}else{b("#"+ak,"#"+ac).attr("checked",false);b("#"+ak,"#"+ac).attr("defaultChecked","")}}else{ah=ah.toLowerCase();if(ah.search(/(false|0|no|off|undefined)/i)<0&&ah!==""){b("#"+ak,"#"+ac).attr("checked",true);b("#"+ak,"#"+ac).attr("defaultChecked",true)}else{b("#"+ak,"#"+ac).attr("checked",false);b("#"+ak,"#"+ac).attr("defaultChecked","")}}break;case"custom":try{if(aj[ao].editoptions&&b.isFunction(aj[ao].editoptions.custom_value)){aj[ao].editoptions.custom_value(b("#"+ak,"#"+ac),"set",ah)}else{throw"e1"}}catch(ap){if(ap=="e1"){b.jgrid.info_dialog(jQuery.jgrid.errors.errcap,"function 'custom_value' "+b.jgrid.edit.msg.nodefined,jQuery.jgrid.edit.bClose)}else{b.jgrid.info_dialog(jQuery.jgrid.errors.errcap,ap.message,jQuery.jgrid.edit.bClose)}}break}ad++}});if(ad>0){b("#id_g","#"+v).val(Z)}}function k(){var ai,ah=[true,"",""],Z={},ad=e.p.prmNames,ag,ac,ak,ae;if(b.isFunction(a.beforeCheckValues)){var af=a.beforeCheckValues(D,b("#"+y),D[e.p.id+"_id"]=="_empty"?ad.addoper:ad.editoper);if(af&&typeof(af)==="object"){D=af}}for(ak in D){if(D.hasOwnProperty(ak)){ah=b.jgrid.checkValues(D[ak],ak,e);if(ah[0]===false){break}}}if(ah[0]){if(b.isFunction(a.onclickSubmit)){Z=a.onclickSubmit(a,D)||{}}if(b.isFunction(a.beforeSubmit)){ah=a.beforeSubmit(D,b("#"+y))}}if(ah[0]&&!a.processing){a.processing=true;b("#sData","#"+v+"_2").addClass("ui-state-active");ac=ad.oper;ag=ad.id;D[ac]=(b.trim(D[e.p.id+"_id"])=="_empty")?ad.addoper:ad.editoper;if(D[ac]!=ad.addoper){D[ag]=D[e.p.id+"_id"]}else{if(D[ag]===undefined){D[ag]=D[e.p.id+"_id"]}}delete D[e.p.id+"_id"];D=b.extend(D,a.editData,Z);if(e.p.treeGrid===true){if(D[ac]==ad.addoper){ae=b(e).jqGrid("getGridParam","selrow");var aa=e.p.treeGridModel=="adjacency"?e.p.treeReader.parent_id_field:"parent_id";D[aa]=ae}for(i in e.p.treeReader){var aj=e.p.treeReader[i];if(D.hasOwnProperty(aj)){if(D[ac]==ad.addoper&&i==="parent_id_field"){continue}delete D[aj]}}}var ab=b.extend({url:a.url?a.url:b(e).jqGrid("getGridParam","editurl"),type:a.mtype,data:b.isFunction(a.serializeEditData)?a.serializeEditData(D):D,complete:function(an,al){if(al!="success"){ah[0]=false;if(b.isFunction(a.errorTextFormat)){ah[1]=a.errorTextFormat(an)}else{ah[1]=al+" Status: '"+an.statusText+"'. Error code: "+an.status}}else{if(b.isFunction(a.afterSubmit)){ah=a.afterSubmit(an,D)}}if(ah[0]===false){b("#FormError>td","#"+v).html(ah[1]);b("#FormError","#"+v).show()}else{b.each(e.p.colModel,function(ap,ar){if(P[this.name]&&this.formatter&&this.formatter=="select"){try{delete P[this.name]}catch(aq){}}});D=b.extend(D,P);if(e.p.autoencode){b.each(D,function(aq,ap){D[aq]=b.jgrid.htmlDecode(ap)})}a.reloadAfterSubmit=a.reloadAfterSubmit&&e.p.datatype!="local";if(D[ac]==ad.addoper){if(!ah[2]){ah[2]=b.jgrid.randId()}D[ag]=ah[2];if(a.closeAfterAdd){if(a.reloadAfterSubmit){b(e).trigger("reloadGrid")}else{if(e.p.treeGrid===true){b(e).jqGrid("addChildNode",ah[2],ae,D)}else{b(e).jqGrid("addRowData",ah[2],D,d.addedrow);b(e).jqGrid("setSelection",ah[2])}}b.jgrid.hideModal("#"+j.themodal,{gb:"#gbox_"+B,jqm:d.jqModal,onClose:a.onClose})}else{if(a.clearAfterAdd){if(a.reloadAfterSubmit){b(e).trigger("reloadGrid")}else{if(e.p.treeGrid===true){b(e).jqGrid("addChildNode",ah[2],ae,D)}else{b(e).jqGrid("addRowData",ah[2],D,d.addedrow)}}q("_empty",e,y)}else{if(a.reloadAfterSubmit){b(e).trigger("reloadGrid")}else{if(e.p.treeGrid===true){b(e).jqGrid("addChildNode",ah[2],ae,D)}else{b(e).jqGrid("addRowData",ah[2],D,d.addedrow)}}}}}else{if(a.reloadAfterSubmit){b(e).trigger("reloadGrid");if(!a.closeAfterEdit){setTimeout(function(){b(e).jqGrid("setSelection",D[ag])},1000)}}else{if(e.p.treeGrid===true){b(e).jqGrid("setTreeRow",D[ag],D)}else{b(e).jqGrid("setRowData",D[ag],D)}}if(a.closeAfterEdit){b.jgrid.hideModal("#"+j.themodal,{gb:"#gbox_"+B,jqm:d.jqModal,onClose:a.onClose})}}if(b.isFunction(a.afterComplete)){ai=an;setTimeout(function(){a.afterComplete(ai,D,b("#"+y));ai=null},500)}if(a.checkOnSubmit||a.checkOnUpdate){b("#"+y).data("disabled",false);if(a._savedData[e.p.id+"_id"]!="_empty"){for(var am in a._savedData){if(D[am]){a._savedData[am]=D[am]}}}}}a.processing=false;b("#sData","#"+v+"_2").removeClass("ui-state-active");try{b(":input:visible","#"+y)[0].focus()}catch(ao){}}},b.jgrid.ajaxOptions,a.ajaxEditOptions);if(!ab.url&&!a.useDataProxy){if(b.isFunction(e.p.dataProxy)){a.useDataProxy=true}else{ah[0]=false;ah[1]+=" "+b.jgrid.errors.nourl}}if(ah[0]){if(a.useDataProxy){e.p.dataProxy.call(e,ab,"set_"+e.p.id)}else{b.ajax(ab)}}}if(ah[0]===false){b("#FormError>td","#"+v).html(ah[1]);b("#FormError","#"+v).show()}}function J(ac,Z){var aa=false,ab;for(ab in ac){if(ac[ab]!=Z[ab]){aa=true;break}}return aa}function T(){b.each(e.p.colModel,function(Z,aa){if(aa.editoptions&&aa.editoptions.NullIfEmpty===true){if(D.hasOwnProperty(aa.name)&&D[aa.name]==""){D[aa.name]="null"}}})}function g(){var Z=true;b("#FormError","#"+v).hide();if(a.checkOnUpdate){D={};P={};W();F=b.extend({},D,P);A=J(F,a._savedData);if(A){b("#"+y).data("disabled",true);b(".confirm","#"+j.themodal).show();Z=false}else{T()}}return Z}function V(){if(c!=="_empty"&&typeof(e.p.savedRow)!=="undefined"&&e.p.savedRow.length>0&&b.isFunction(b.fn.jqGrid.restoreRow)){for(var Z=0;Z<e.p.savedRow.length;Z++){if(e.p.savedRow[Z].id==c){b(e).jqGrid("restoreRow",c);break}}}}function I(Z,aa){if(Z===0){b("#pData","#"+v+"_2").addClass("ui-state-disabled")}else{b("#pData","#"+v+"_2").removeClass("ui-state-disabled")}if(Z==aa){b("#nData","#"+v+"_2").addClass("ui-state-disabled")}else{b("#nData","#"+v+"_2").removeClass("ui-state-disabled")}}function Y(){var aa=b(e).jqGrid("getDataIDs"),Z=b("#id_g","#"+v).val(),ab=b.inArray(Z,aa);return[ab,aa]}if(b("#"+j.themodal).html()!==null){if(L){X=L(b("#"+y));if(typeof(X)=="undefined"){X=true}}if(X===false){return}V();b(".ui-jqdialog-title","#"+j.modalhead).html(d.caption);b("#FormError","#"+v).hide();if(a.topinfo){b(".topinfo","#"+v+"_2").html(a.topinfo);b(".tinfo","#"+v+"_2").show()}else{b(".tinfo","#"+v+"_2").hide()}if(a.bottominfo){b(".bottominfo","#"+v+"_2").html(a.bottominfo);b(".binfo","#"+v+"_2").show()}else{b(".binfo","#"+v+"_2").hide()}q(c,e,y);if(c=="_empty"||!a.viewPagerButtons){b("#pData, #nData","#"+v+"_2").hide()}else{b("#pData, #nData","#"+v+"_2").show()}if(a.processing===true){a.processing=false;b("#sData","#"+v+"_2").removeClass("ui-state-active")}if(b("#"+y).data("disabled")===true){b(".confirm","#"+j.themodal).hide();b("#"+y).data("disabled",false)}if(C){C(b("#"+y))}b("#"+j.themodal).data("onClose",a.onClose);b.jgrid.viewModal("#"+j.themodal,{gbox:"#gbox_"+B,jqm:d.jqModal,jqM:false,overlay:d.overlay,modal:d.modal});if(!m){b(".jqmOverlay").click(function(){if(!g()){return false}b.jgrid.hideModal("#"+j.themodal,{gb:"#gbox_"+B,jqm:d.jqModal,onClose:a.onClose});return false})}if(M){M(b("#"+y))}}else{var s=isNaN(d.dataheight)?d.dataheight:d.dataheight+"px",S=b("<form name='FormPost' id='"+y+"' class='FormGrid' onSubmit='return false;' style='width:100%;overflow:auto;position:relative;height:"+s+";'></form>").data("disabled",false),z=b("<table id='"+v+"' class='EditTable' cellspacing='0' cellpadding='0' border='0'><tbody></tbody></table>");if(L){X=L(b("#"+y));if(typeof(X)=="undefined"){X=true}}if(X===false){return}V();b(e.p.colModel).each(function(Z){var aa=this.formoptions;H=Math.max(H,aa?aa.colpos||0:0);r=Math.max(r,aa?aa.rowpos||0:0)});b(S).append(z);var K=b("<tr id='FormError' style='display:none'><td class='ui-state-error' colspan='"+(H*2)+"'></td></tr>");K[0].rp=0;b(z).append(K);K=b("<tr style='display:none' class='tinfo'><td class='topinfo' colspan='"+(H*2)+"'>"+a.topinfo+"</td></tr>");K[0].rp=0;b(z).append(K);var f=e.p.direction=="rtl"?true:false,R=f?"nData":"pData",U=f?"pData":"nData";t(c,e,z,H);var l="<a href='javascript:void(0)' id='"+R+"' class='fm-button ui-state-default-grid ui-corner-left'><span class='ui-icon-os ui-icon-triangle-1-w'></span></a>",n="<a href='javascript:void(0)' id='"+U+"' class='fm-button ui-state-default-grid ui-corner-right'><span class='ui-icon-os ui-icon-triangle-1-e'></span></a>",h="<a href='javascript:void(0)' id='sData' class='fm-button ui-state-default-grid ui-corner-all-grid'>"+d.bSubmit+"</a>",u="<a href='javascript:void(0)' id='cData' class='fm-button ui-state-default-grid ui-corner-all-grid'>"+d.bCancel+"</a>";var O="<table border='0' cellspacing='0' cellpadding='0' class='EditTable' id='"+v+"_2'><tbody><tr><td colspan='2'><hr class='ui-widget-content-grid' style='margin:1px'/></td></tr><tr id='Act_Buttons'><td class='navButton'>"+(f?n+l:l+n)+"</td><td class='EditButton'>"+h+u+"</td></tr>";O+="<tr style='display:none' class='binfo'><td class='bottominfo' colspan='2'>"+a.bottominfo+"</td></tr>";O+="</tbody></table>";if(r>0){var x=[];b.each(b(z)[0].rows,function(Z,aa){x[Z]=aa});x.sort(function(aa,Z){if(aa.rp>Z.rp){return 1}if(aa.rp<Z.rp){return -1}return 0});b.each(x,function(Z,aa){b("tbody",z).append(aa)})}d.gbox="#gbox_"+B;var o=false;if(d.closeOnEscape===true){d.closeOnEscape=false;o=true}var N=b("<span></span>").append(S).append(O);b.jgrid.createModal(j,N,d,"#gview_"+e.p.id,b("#gbox_"+e.p.id)[0]);if(f){b("#pData, #nData","#"+v+"_2").css("float","right");b(".EditButton","#"+v+"_2").css("text-align","left")}if(a.topinfo){b(".tinfo","#"+v+"_2").show()}if(a.bottominfo){b(".binfo","#"+v+"_2").show()}N=null;O=null;b("#"+j.themodal).keydown(function(Z){var aa=Z.target;if(b("#"+y).data("disabled")===true){return false}if(a.savekey[0]===true&&Z.which==a.savekey[1]){if(aa.tagName!="TEXTAREA"){b("#sData","#"+v+"_2").trigger("click");return false}}if(Z.which===27){if(!g()){return false}if(o){b.jgrid.hideModal(this,{gb:d.gbox,jqm:d.jqModal,onClose:a.onClose})}return false}if(a.navkeys[0]===true){if(b("#id_g","#"+v).val()=="_empty"){return true}if(Z.which==a.navkeys[1]){b("#pData","#"+v+"_2").trigger("click");return false}if(Z.which==a.navkeys[2]){b("#nData","#"+v+"_2").trigger("click");return false}}});if(d.checkOnUpdate){b("a.ui-jqdialog-titlebar-close span","#"+j.themodal).removeClass("jqmClose");b("a.ui-jqdialog-titlebar-close","#"+j.themodal).unbind("click").click(function(){if(!g()){return false}b.jgrid.hideModal("#"+j.themodal,{gb:"#gbox_"+B,jqm:d.jqModal,onClose:a.onClose});return false})}d.saveicon=b.extend([true,"left","ui-icon-disk"],d.saveicon);d.closeicon=b.extend([true,"left","ui-icon-close"],d.closeicon);if(d.saveicon[0]===true){b("#sData","#"+v+"_2").addClass(d.saveicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+d.saveicon[2]+"'></span>")}if(d.closeicon[0]===true){b("#cData","#"+v+"_2").addClass(d.closeicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+d.closeicon[2]+"'></span>")}if(a.checkOnSubmit||a.checkOnUpdate){h="<a href='javascript:void(0)' id='sNew' class='fm-button ui-state-default-grid ui-corner-all-grid' style='z-index:1002'>"+d.bYes+"</a>";n="<a href='javascript:void(0)' id='nNew' class='fm-button ui-state-default-grid ui-corner-all-grid' style='z-index:1002'>"+d.bNo+"</a>";u="<a href='javascript:void(0)' id='cNew' class='fm-button ui-state-default-grid ui-corner-all-grid' style='z-index:1002'>"+d.bExit+"</a>";var E,w=d.zIndex||999;w++;if(b.browser.msie&&b.browser.version==6){E='<iframe style="display:block;position:absolute;z-index:-1;filter:Alpha(Opacity=\'0\');" src="javascript:false;"></iframe>'}else{E=""}b("<div class='ui-widget-overlay jqgrid-overlay confirm' style='z-index:"+w+";display:none;'>&#160;"+E+"</div><div class='confirm ui-widget-content-grid ui-jqconfirm' style='z-index:"+(w+1)+"'>"+d.saveData+"<br/><br/>"+h+n+u+"</div>").insertAfter("#"+y);b("#sNew","#"+j.themodal).click(function(){k();b("#"+y).data("disabled",false);b(".confirm","#"+j.themodal).hide();return false});b("#nNew","#"+j.themodal).click(function(){b(".confirm","#"+j.themodal).hide();b("#"+y).data("disabled",false);setTimeout(function(){b(":input","#"+y)[0].focus()},0);return false});b("#cNew","#"+j.themodal).click(function(){b(".confirm","#"+j.themodal).hide();b("#"+y).data("disabled",false);b.jgrid.hideModal("#"+j.themodal,{gb:"#gbox_"+B,jqm:d.jqModal,onClose:a.onClose});return false})}if(p){p(b("#"+y))}if(c=="_empty"||!a.viewPagerButtons){b("#pData,#nData","#"+v+"_2").hide()}else{b("#pData,#nData","#"+v+"_2").show()}if(C){C(b("#"+y))}b("#"+j.themodal).data("onClose",a.onClose);b.jgrid.viewModal("#"+j.themodal,{gbox:"#gbox_"+B,jqm:d.jqModal,overlay:d.overlay,modal:d.modal});if(!m){b(".jqmOverlay").click(function(){if(!g()){return false}b.jgrid.hideModal("#"+j.themodal,{gb:"#gbox_"+B,jqm:d.jqModal,onClose:a.onClose});return false})}if(M){M(b("#"+y))}b(".fm-button","#"+j.themodal).hover(function(){b(this).addClass("ui-state-hover")},function(){b(this).removeClass("ui-state-hover")});b("#sData","#"+v+"_2").click(function(Z){D={};P={};b("#FormError","#"+v).hide();W();T();if(D[e.p.id+"_id"]=="_empty"){k()}else{if(d.checkOnSubmit===true){F=b.extend({},D,P);A=J(F,a._savedData);if(A){b("#"+y).data("disabled",true);b(".confirm","#"+j.themodal).show()}else{k()}}else{k()}}return false});b("#cData","#"+v+"_2").click(function(Z){if(!g()){return false}b.jgrid.hideModal("#"+j.themodal,{gb:"#gbox_"+B,jqm:d.jqModal,onClose:a.onClose});return false});b("#nData","#"+v+"_2").click(function(Z){if(!g()){return false}b("#FormError","#"+v).hide();var aa=Y();aa[0]=parseInt(aa[0],10);if(aa[0]!=-1&&aa[1][aa[0]+1]){if(b.isFunction(d.onclickPgButtons)){d.onclickPgButtons("next",b("#"+y),aa[1][aa[0]])}q(aa[1][aa[0]+1],e,y);b(e).jqGrid("setSelection",aa[1][aa[0]+1]);if(b.isFunction(d.afterclickPgButtons)){d.afterclickPgButtons("next",b("#"+y),aa[1][aa[0]+1])}I(aa[0]+1,aa[1].length-1)}return false});b("#pData","#"+v+"_2").click(function(aa){if(!g()){return false}b("#FormError","#"+v).hide();var Z=Y();if(Z[0]!=-1&&Z[1][Z[0]-1]){if(b.isFunction(d.onclickPgButtons)){d.onclickPgButtons("prev",b("#"+y),Z[1][Z[0]])}q(Z[1][Z[0]-1],e,y);b(e).jqGrid("setSelection",Z[1][Z[0]-1]);if(b.isFunction(d.afterclickPgButtons)){d.afterclickPgButtons("prev",b("#"+y),Z[1][Z[0]-1])}I(Z[0]-1,Z[1].length-1)}return false})}var Q=Y();I(Q[0],Q[1].length-1)})},viewGridRow:function(c,d){d=b.extend({top:0,left:0,width:0,height:"auto",dataheight:"auto",modal:false,overlay:10,drag:true,resize:true,jqModal:true,closeOnEscape:false,labelswidth:"30%",closeicon:[],navkeys:[false,38,40],onClose:null,beforeShowForm:null,beforeInitData:null,viewPagerButtons:true},b.jgrid.view,d||{});return this.each(function(){var x=this;if(!x.grid||!c){return}if(!d.imgpath){d.imgpath=x.p.imgpath}var t=x.p.id,B="ViewGrid_"+t,u="ViewTbl_"+t,k={themodal:"viewmod"+t,modalhead:"viewhd"+t,modalcontent:"viewcnt"+t,scrollelm:B},A=b.isFunction(d.beforeInitData)?d.beforeInitData:false,n=true,h=1,g=0;function l(){if(d.closeOnEscape===true||d.navkeys[0]===true){setTimeout(function(){b(".ui-jqdialog-titlebar-close","#"+k.modalhead).focus()},0)}}function p(L,R,P,X){var H,K,S,V=0,aa,ab,Z=[],Q=false,M="<td class='CaptionTD form-view-label ui-widget-content-grid' width='"+d.labelswidth+"'>&#160;</td><td class='DataTD form-view-data ui-helper-reset-os ui-widget-content-grid'>&#160;</td>",O="",I="<td class='CaptionTD form-view-label ui-widget-content-grid'>&#160;</td><td class='DataTD form-view-data ui-widget-content-grid'>&#160;</td>",N=["integer","number","currency"],U=0,T=0,J,G,Y;for(var W=1;W<=X;W++){O+=W==1?M:I}b(R.p.colModel).each(function(ad){if(this.editrules&&this.editrules.edithidden===true){K=false}else{K=this.hidden===true?true:false}if(!K&&this.align==="right"){if(this.formatter&&b.inArray(this.formatter,N)!==-1){U=Math.max(U,parseInt(this.width,10))}else{T=Math.max(T,parseInt(this.width,10))}}});J=U!==0?U:T!==0?T:0;Q=b(R).jqGrid("getInd",L);b(R.p.colModel).each(function(ae){H=this.name;G=false;if(this.editrules&&this.editrules.edithidden===true){K=false}else{K=this.hidden===true?true:false}ab=K?"style='display:none'":"";Y=(typeof this.viewable!="boolean")?true:this.viewable;if(H!=="cb"&&H!=="subgrid"&&H!=="rn"&&Y){if(Q===false){aa=""}else{if(H==R.p.ExpandColumn&&R.p.treeGrid===true){aa=b("td:eq("+ae+")",R.rows[Q]).text()}else{aa=b("td:eq("+ae+")",R.rows[Q]).html()}}G=this.align==="right"&&J!==0?true:false;var ad=b.extend({},this.editoptions||{},{id:H,name:H}),ai=b.extend({},{rowabove:false,rowcontent:""},this.formoptions||{}),af=parseInt(ai.rowpos,10)||V+1,ah=parseInt((parseInt(ai.colpos,10)||1)*2,10);if(ai.rowabove){var ag=b("<tr><td class='contentinfo' colspan='"+(X*2)+"'>"+ai.rowcontent+"</td></tr>");b(P).append(ag);ag[0].rp=af}S=b(P).find("tr[rowpos="+af+"]");if(S.length===0){S=b("<tr "+ab+" rowpos='"+af+"'></tr>").addClass("FormData").attr("id","trv_"+H);b(S).append(O);b(P).append(S);S[0].rp=af}b("td:eq("+(ah-2)+")",S[0]).html("<b>"+(typeof ai.label==="undefined"?R.p.colNames[ae]:ai.label)+"</b>");b("td:eq("+(ah-1)+")",S[0]).append("<span>"+aa+"</span>").attr("id","v_"+H);if(G){b("td:eq("+(ah-1)+") span",S[0]).css({"text-align":"right",width:J+"px"})}Z[V]=ae;V++}});if(V>0){var ac=b("<tr class='FormData' style='display:none'><td class='CaptionTD'></td><td colspan='"+(X*2-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='id' value='"+L+"'/></td></tr>");ac[0].rp=V+99;b(P).append(ac)}return Z}function o(K,M){var G,N,J=0,I,H,L;L=b(M).jqGrid("getInd",K,true);if(!L){return}b("td",L).each(function(O){G=M.p.colModel[O].name;if(M.p.colModel[O].editrules&&M.p.colModel[O].editrules.edithidden===true){N=false}else{N=M.p.colModel[O].hidden===true?true:false}if(G!=="cb"&&G!=="subgrid"&&G!=="rn"){if(G==M.p.ExpandColumn&&M.p.treeGrid===true){I=b(this).text()}else{I=b(this).html()}H=b.extend({},M.p.colModel[O].editoptions||{});G=b.jgrid.jqID("v_"+G);b("#"+G+" span","#"+u).html(I);if(N){b("#"+G,"#"+u).parents("tr:first").hide()}J++}});if(J>0){b("#id_g","#"+u).val(K)}}function q(G,H){if(G===0){b("#pData","#"+u+"_2").addClass("ui-state-disabled")}else{b("#pData","#"+u+"_2").removeClass("ui-state-disabled")}if(G==H){b("#nData","#"+u+"_2").addClass("ui-state-disabled")}else{b("#nData","#"+u+"_2").removeClass("ui-state-disabled")}}function j(){var H=b(x).jqGrid("getDataIDs"),G=b("#id_g","#"+u).val(),I=b.inArray(G,H);return[I,H]}if(b("#"+k.themodal).html()!==null){if(A){n=A(b("#"+B));if(typeof(n)=="undefined"){n=true}}if(n===false){return}b(".ui-jqdialog-title","#"+k.modalhead).html(d.caption);b("#FormError","#"+u).hide();o(c,x);if(b.isFunction(d.beforeShowForm)){d.beforeShowForm(b("#"+B))}b.jgrid.viewModal("#"+k.themodal,{gbox:"#gbox_"+t,jqm:d.jqModal,jqM:false,overlay:d.overlay,modal:d.modal});l()}else{var z=isNaN(d.dataheight)?d.dataheight:d.dataheight+"px";var D=b("<form name='FormPost' id='"+B+"' class='FormGrid' style='width:100%;overflow:auto;position:relative;height:"+z+";'></form>"),m=b("<table id='"+u+"' class='EditTable' cellspacing='1' cellpadding='2' border='0' style='table-layout:fixed'><tbody></tbody></table>");if(A){n=A(b("#"+B));if(typeof(n)=="undefined"){n=true}}if(n===false){return}b(x.p.colModel).each(function(G){var H=this.formoptions;h=Math.max(h,H?H.colpos||0:0);g=Math.max(g,H?H.rowpos||0:0)});b(D).append(m);p(c,x,m,h);var y=x.p.direction=="rtl"?true:false,F=y?"nData":"pData",f=y?"pData":"nData",v="<a href='javascript:void(0)' id='"+F+"' class='fm-button ui-state-default-grid ui-corner-left'><span class='ui-icon-os ui-icon-triangle-1-w'></span></a>",w="<a href='javascript:void(0)' id='"+f+"' class='fm-button ui-state-default-grid ui-corner-right'><span class='ui-icon-os ui-icon-triangle-1-e'></span></a>",E="<a href='javascript:void(0)' id='cData' class='fm-button ui-state-default-grid ui-corner-all-grid'>"+d.bClose+"</a>";if(g>0){var e=[];b.each(b(m)[0].rows,function(G,H){e[G]=H});e.sort(function(H,G){if(H.rp>G.rp){return 1}if(H.rp<G.rp){return -1}return 0});b.each(e,function(G,H){b("tbody",m).append(H)})}d.gbox="#gbox_"+t;var s=false;if(d.closeOnEscape===true){d.closeOnEscape=false;s=true}var C=b("<span></span>").append(D).append("<table border='0' class='EditTable' id='"+u+"_2'><tbody><tr id='Act_Buttons'><td class='navButton' width='"+d.labelswidth+"'>"+(y?w+v:v+w)+"</td><td class='EditButton'>"+E+"</td></tr></tbody></table>");b.jgrid.createModal(k,C,d,"#gview_"+x.p.id,b("#gview_"+x.p.id)[0]);if(y){b("#pData, #nData","#"+u+"_2").css("float","right");b(".EditButton","#"+u+"_2").css("text-align","left")}if(!d.viewPagerButtons){b("#pData, #nData","#"+u+"_2").hide()}C=null;b("#"+k.themodal).keydown(function(G){if(G.which===27){if(s){b.jgrid.hideModal(this,{gb:d.gbox,jqm:d.jqModal,onClose:d.onClose})}return false}if(d.navkeys[0]===true){if(G.which===d.navkeys[1]){b("#pData","#"+u+"_2").trigger("click");return false}if(G.which===d.navkeys[2]){b("#nData","#"+u+"_2").trigger("click");return false}}});d.closeicon=b.extend([true,"left","ui-icon-close"],d.closeicon);if(d.closeicon[0]===true){b("#cData","#"+u+"_2").addClass(d.closeicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+d.closeicon[2]+"'></span>")}if(b.isFunction(d.beforeShowForm)){d.beforeShowForm(b("#"+B))}b.jgrid.viewModal("#"+k.themodal,{gbox:"#gbox_"+t,jqm:d.jqModal,modal:d.modal});b(".fm-button:not(.ui-state-disabled)","#"+u+"_2").hover(function(){b(this).addClass("ui-state-hover")},function(){b(this).removeClass("ui-state-hover")});l();b("#cData","#"+u+"_2").click(function(G){b.jgrid.hideModal("#"+k.themodal,{gb:"#gbox_"+t,jqm:d.jqModal,onClose:d.onClose});return false});b("#nData","#"+u+"_2").click(function(G){b("#FormError","#"+u).hide();var H=j();H[0]=parseInt(H[0],10);if(H[0]!=-1&&H[1][H[0]+1]){if(b.isFunction(d.onclickPgButtons)){d.onclickPgButtons("next",b("#"+B),H[1][H[0]])}o(H[1][H[0]+1],x);b(x).jqGrid("setSelection",H[1][H[0]+1]);if(b.isFunction(d.afterclickPgButtons)){d.afterclickPgButtons("next",b("#"+B),H[1][H[0]+1])}q(H[0]+1,H[1].length-1)}l();return false});b("#pData","#"+u+"_2").click(function(H){b("#FormError","#"+u).hide();var G=j();if(G[0]!=-1&&G[1][G[0]-1]){if(b.isFunction(d.onclickPgButtons)){d.onclickPgButtons("prev",b("#"+B),G[1][G[0]])}o(G[1][G[0]-1],x);b(x).jqGrid("setSelection",G[1][G[0]-1]);if(b.isFunction(d.afterclickPgButtons)){d.afterclickPgButtons("prev",b("#"+B),G[1][G[0]-1])}q(G[0]-1,G[1].length-1)}l();return false})}var r=j();q(r[0],r[1].length-1)})},delGridRow:function(c,d){d=b.extend({top:0,left:0,width:240,height:"auto",dataheight:"auto",modal:false,overlay:10,drag:true,resize:true,url:"",mtype:"POST",reloadAfterSubmit:true,beforeShowForm:null,beforeInitData:null,afterShowForm:null,beforeSubmit:null,onclickSubmit:null,afterSubmit:null,jqModal:true,closeOnEscape:false,delData:{},delicon:[],cancelicon:[],onClose:null,ajaxDelOptions:{},processing:false,serializeDelData:null,useDataProxy:false},b.jgrid.del,d||{});a=d;return this.each(function(){var p=this;if(!p.grid){return}if(!c){return}var q=b.isFunction(d.beforeShowForm),g=b.isFunction(d.afterShowForm),t=b.isFunction(d.beforeInitData)?d.beforeInitData:false,e=p.p.id,f={},l=true,m="DelTbl_"+e,s,r,o,k,h={themodal:"delmod"+e,modalhead:"delhd"+e,modalcontent:"delcnt"+e,scrollelm:m};if(jQuery.isArray(c)){c=c.join()}if(b("#"+h.themodal).html()!==null){if(t){l=t(b("#"+m));if(typeof(l)=="undefined"){l=true}}if(l===false){return}b("#DelData>td","#"+m).text(c);b("#DelError","#"+m).hide();if(a.processing===true){a.processing=false;b("#dData","#"+m).removeClass("ui-state-active")}if(q){d.beforeShowForm(b("#"+m))}b.jgrid.viewModal("#"+h.themodal,{gbox:"#gbox_"+e,jqm:d.jqModal,jqM:false,overlay:d.overlay,modal:d.modal});if(g){d.afterShowForm(b("#"+m))}}else{var u=isNaN(d.dataheight)?d.dataheight:d.dataheight+"px";var n="<div id='"+m+"' class='formdata' style='width:100%;overflow:auto;position:relative;height:"+u+";'>";n+="<table class='DelTable'><tbody>";n+="<tr id='DelError' style='display:none'><td class='ui-state-error'></td></tr>";n+="<tr id='DelData' style='display:none'><td >"+c+"</td></tr>";n+='<tr><td class="delmsg" style="white-space:pre;">'+d.msg+"</td></tr><tr><td >&#160;</td></tr>";n+="</tbody></table></div>";var j="<a href='javascript:void(0)' id='dData' class='fm-button ui-state-default-grid ui-corner-all-grid'>"+d.bSubmit+"</a>",v="<a href='javascript:void(0)' id='eData' class='fm-button ui-state-default-grid ui-corner-all-grid'>"+d.bCancel+"</a>";n+="<table cellspacing='0' cellpadding='0' border='0' class='EditTable' id='"+m+"_2'><tbody><tr><td><hr class='ui-widget-content-grid' style='margin:1px'/></td></tr></tr><tr><td class='DelButton EditButton'>"+j+"&#160;"+v+"</td></tr></tbody></table>";d.gbox="#gbox_"+e;b.jgrid.createModal(h,n,d,"#gview_"+p.p.id,b("#gview_"+p.p.id)[0]);if(t){l=t(b("#"+m));if(typeof(l)=="undefined"){l=true}}if(l===false){return}b(".fm-button","#"+m+"_2").hover(function(){b(this).addClass("ui-state-hover")},function(){b(this).removeClass("ui-state-hover")});d.delicon=b.extend([true,"left","ui-icon-scissors"],d.delicon);d.cancelicon=b.extend([true,"left","ui-icon-cancel"],d.cancelicon);if(d.delicon[0]===true){b("#dData","#"+m+"_2").addClass(d.delicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+d.delicon[2]+"'></span>")}if(d.cancelicon[0]===true){b("#eData","#"+m+"_2").addClass(d.cancelicon[1]=="right"?"fm-button-icon-right":"fm-button-icon-left").append("<span class='ui-icon "+d.cancelicon[2]+"'></span>")}b("#dData","#"+m+"_2").click(function(z){var x=[true,""];f={};var y=b("#DelData>td","#"+m).text();if(b.isFunction(d.onclickSubmit)){f=d.onclickSubmit(a,y)||{}}if(b.isFunction(d.beforeSubmit)){x=d.beforeSubmit(y)}if(x[0]&&!a.processing){a.processing=true;b(this).addClass("ui-state-active");o=p.p.prmNames;s=b.extend({},a.delData,f);k=o.oper;s[k]=o.deloper;r=o.id;s[r]=y;var w=b.extend({url:a.url?a.url:b(p).jqGrid("getGridParam","editurl"),type:d.mtype,data:b.isFunction(d.serializeDelData)?d.serializeDelData(s):s,complete:function(D,B){if(B!="success"){x[0]=false;if(b.isFunction(a.errorTextFormat)){x[1]=a.errorTextFormat(D)}else{x[1]=B+" Status: '"+D.statusText+"'. Error code: "+D.status}}else{if(b.isFunction(a.afterSubmit)){x=a.afterSubmit(D,s)}}if(x[0]===false){b("#DelError>td","#"+m).html(x[1]);b("#DelError","#"+m).show()}else{if(a.reloadAfterSubmit&&p.p.datatype!="local"){b(p).trigger("reloadGrid")}else{var A=[];A=y.split(",");if(p.p.treeGrid===true){try{b(p).jqGrid("delTreeNode",A[0])}catch(E){}}else{for(var C=0;C<A.length;C++){b(p).jqGrid("delRowData",A[C])}}p.p.selrow=null;p.p.selarrrow=[]}if(b.isFunction(a.afterComplete)){setTimeout(function(){a.afterComplete(D,y)},500)}}a.processing=false;b("#dData","#"+m+"_2").removeClass("ui-state-active");if(x[0]){b.jgrid.hideModal("#"+h.themodal,{gb:"#gbox_"+e,jqm:d.jqModal,onClose:a.onClose})}}},b.jgrid.ajaxOptions,d.ajaxDelOptions);if(!w.url&&!a.useDataProxy){if(b.isFunction(p.p.dataProxy)){a.useDataProxy=true}else{x[0]=false;x[1]+=" "+b.jgrid.errors.nourl}}if(x[0]){if(a.useDataProxy){p.p.dataProxy.call(p,w,"del_"+p.p.id)}else{b.ajax(w)}}}if(x[0]===false){b("#DelError>td","#"+m).html(x[1]);b("#DelError","#"+m).show()}return false});b("#eData","#"+m+"_2").click(function(w){b.jgrid.hideModal("#"+h.themodal,{gb:"#gbox_"+e,jqm:d.jqModal,onClose:a.onClose});return false});if(q){d.beforeShowForm(b("#"+m))}b.jgrid.viewModal("#"+h.themodal,{gbox:"#gbox_"+e,jqm:d.jqModal,overlay:d.overlay,modal:d.modal});if(g){d.afterShowForm(b("#"+m))}}if(d.closeOnEscape===true){setTimeout(function(){b(".ui-jqdialog-titlebar-close","#"+h.modalhead).focus()},0)}})},navGrid:function(f,h,e,g,d,c,j){h=b.extend({edit:true,editicon:"ui-icon-pencil",add:true,addicon:"ui-icon-plus",del:true,delicon:"ui-icon-trash",search:true,searchicon:"ui-icon-search",refresh:true,refreshicon:"ui-icon-refresh",refreshstate:"firstpage",view:false,viewicon:"ui-icon-document",position:"left",closeOnEscape:true,beforeRefresh:null,afterRefresh:null,cloneToTop:false},b.jgrid.nav,h||{});return this.each(function(){if(this.nav){return}var k={themodal:"alertmod",modalhead:"alerthd",modalcontent:"alertcnt"},o=this,n,w,q,l;if(!o.grid||typeof f!="string"){return}if(b("#"+k.themodal).html()===null){if(typeof window.innerWidth!="undefined"){n=window.innerWidth;w=window.innerHeight}else{if(typeof document.documentElement!="undefined"&&typeof document.documentElement.clientWidth!="undefined"&&document.documentElement.clientWidth!==0){n=document.documentElement.clientWidth;w=document.documentElement.clientHeight}else{n=1024;w=768}}b.jgrid.createModal(k,"<div>"+h.alerttext+"</div><span tabindex='0'><span tabindex='-1' id='jqg_alrt'></span></span>",{gbox:"#gbox_"+o.p.id,jqModal:true,drag:true,resize:true,caption:h.alertcap,top:w/2-25,left:n/2-100,width:200,height:"auto",closeOnEscape:h.closeOnEscape},"","",true)}var r=1;if(h.cloneToTop&&o.p.toppager){r=2}for(var p=0;p<r;p++){var s,u=b("<table cellspacing='0' cellpadding='0' border='0' class='ui-pg-table navtable' style='float:left;table-layout:auto;'><tbody><tr></tr></tbody></table>"),v="<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='ui-separator'></span></td>",m,t;if(p===0){m=f;t=o.p.id;if(m==o.p.toppager){t+="_top";r=1}}else{m=o.p.toppager;t=o.p.id+"_top"}if(o.p.direction=="rtl"){b(u).attr("dir","rtl").css("float","right")}if(h.add){g=g||{};s=b("<td class='ui-pg-button ui-corner-all-grid'></td>");b(s).append("<div class='ui-pg-div'><span class='ui-icon-os "+h.addicon+"'></span>"+h.addtext+"</div>");b("tr",u).append(s);b(s,u).attr({title:h.addtitle||"",id:g.id||"add_"+t}).click(function(){if(!b(this).hasClass("ui-state-disabled")){if(b.isFunction(h.addfunc)){h.addfunc()}else{b(o).jqGrid("editGridRow","new",g)}}return false}).hover(function(){if(!b(this).hasClass("ui-state-disabled")){b(this).addClass("ui-state-hover")}},function(){b(this).removeClass("ui-state-hover")});s=null}if(h.edit){s=b("<td class='ui-pg-button ui-corner-all-grid'></td>");e=e||{};b(s).append("<div class='ui-pg-div'><span class='ui-icon-os "+h.editicon+"'></span>"+h.edittext+"</div>");b("tr",u).append(s);b(s,u).attr({title:h.edittitle||"",id:e.id||"edit_"+t}).click(function(){if(!b(this).hasClass("ui-state-disabled")){var x=o.p.selrow;if(x){if(b.isFunction(h.editfunc)){h.editfunc(x)}else{b(o).jqGrid("editGridRow",x,e)}}else{b.jgrid.viewModal("#"+k.themodal,{gbox:"#gbox_"+o.p.id,jqm:true});b("#jqg_alrt").focus()}}return false}).hover(function(){if(!b(this).hasClass("ui-state-disabled")){b(this).addClass("ui-state-hover")}},function(){b(this).removeClass("ui-state-hover")});s=null}if(h.view){s=b("<td class='ui-pg-button ui-corner-all-grid'></td>");j=j||{};b(s).append("<div class='ui-pg-div'><span class='ui-icon-os "+h.viewicon+"'></span>"+h.viewtext+"</div>");b("tr",u).append(s);b(s,u).attr({title:h.viewtitle||"",id:j.id||"view_"+t}).click(function(){if(!b(this).hasClass("ui-state-disabled")){var x=o.p.selrow;if(x){if(b.isFunction(h.viewfunc)){h.viewfunc(x)}else{b(o).jqGrid("viewGridRow",x,j)}}else{b.jgrid.viewModal("#"+k.themodal,{gbox:"#gbox_"+o.p.id,jqm:true});b("#jqg_alrt").focus()}}return false}).hover(function(){if(!b(this).hasClass("ui-state-disabled")){b(this).addClass("ui-state-hover")}},function(){b(this).removeClass("ui-state-hover")});s=null}if(h.del){s=b("<td class='ui-pg-button ui-corner-all-grid'></td>");d=d||{};b(s).append("<div class='ui-pg-div'><span class='ui-icon-os "+h.delicon+"'></span>"+h.deltext+"</div>");b("tr",u).append(s);b(s,u).attr({title:h.deltitle||"",id:d.id||"del_"+t}).click(function(){if(!b(this).hasClass("ui-state-disabled")){var x;if(o.p.multiselect){x=o.p.selarrrow;if(x.length===0){x=null}}else{x=o.p.selrow}if(x){if("function"==typeof h.delfunc){h.delfunc(x)}else{b(o).jqGrid("delGridRow",x,d)}}else{b.jgrid.viewModal("#"+k.themodal,{gbox:"#gbox_"+o.p.id,jqm:true});b("#jqg_alrt").focus()}}return false}).hover(function(){if(!b(this).hasClass("ui-state-disabled")){b(this).addClass("ui-state-hover")}},function(){b(this).removeClass("ui-state-hover")});s=null}if(h.add||h.edit||h.del||h.view){b("tr",u).append(v)}if(h.search){s=b("<td class='ui-pg-button ui-corner-all-grid'></td>");c=c||{};b(s).append("<div class='ui-pg-div'><span class='ui-icon-os "+h.searchicon+"'></span>"+h.searchtext+"</div>");b("tr",u).append(s);b(s,u).attr({title:h.searchtitle||"",id:c.id||"search_"+t}).click(function(){if(!b(this).hasClass("ui-state-disabled")){b(o).jqGrid("searchGrid",c)}return false}).hover(function(){if(!b(this).hasClass("ui-state-disabled")){b(this).addClass("ui-state-hover")}},function(){b(this).removeClass("ui-state-hover")});if(c.showOnLoad&&c.showOnLoad===true){b(s,u).click()}s=null}if(h.refresh){s=b("<td class='ui-pg-button ui-corner-all-grid'></td>");b(s).append("<div class='ui-pg-div'><span class='ui-icon-os "+h.refreshicon+"'></span>"+h.refreshtext+"</div>");b("tr",u).append(s);b(s,u).attr({title:h.refreshtitle||"",id:"refresh_"+t}).click(function(){if(!b(this).hasClass("ui-state-disabled")){if(b.isFunction(h.beforeRefresh)){h.beforeRefresh()}o.p.search=false;try{var x=o.p.id;o.p.postData.filters="";b("#fbox_"+x).jqFilter("resetFilter");if(b.isFunction(o.clearToolbar)){o.clearToolbar(false)}}catch(y){}switch(h.refreshstate){case"firstpage":b(o).trigger("reloadGrid",[{page:1}]);break;case"current":b(o).trigger("reloadGrid",[{current:true}]);break}if(b.isFunction(h.afterRefresh)){h.afterRefresh()}}return false}).hover(function(){if(!b(this).hasClass("ui-state-disabled")){b(this).addClass("ui-state-hover")}},function(){b(this).removeClass("ui-state-hover")});s=null}l=b(".ui-jqgrid").css("font-size")||"11px";b("body").append("<div id='testpg2' class='ui-jqgrid ui-widget-grid ui-widget-content-grid' style='font-size:"+l+";visibility:hidden;' ></div>");q=b(u).clone().appendTo("#testpg2").width();b("#testpg2").remove();b(m+"_"+h.position,m).append(u);if(o.p._nvtd){if(q>o.p._nvtd[0]){b(m+"_"+h.position,m).width(q);o.p._nvtd[0]=q}o.p._nvtd[1]=q}l=null;q=null;u=null;this.nav=true}})},navButtonAdd:function(c,d){d=b.extend({caption:"newButton",title:"",buttonicon:"ui-icon-newwin",onClickButton:null,position:"last",cursor:"pointer"},d||{});return this.each(function(){if(!this.grid){return}if(c.indexOf("#")!==0){c="#"+c}var e=b(".navtable",c)[0],g=this;if(e){if(d.id&&b("#"+d.id,e).html()!==null){return}var f=b("<td></td>");if(d.buttonicon.toString().toUpperCase()=="NONE"){b(f).addClass("ui-pg-button ui-corner-all-grid").append("<div class='ui-pg-div'>"+d.caption+"</div>")}else{b(f).addClass("ui-pg-button ui-corner-all-grid").append("<div class='ui-pg-div'><span class='ui-icon-os "+d.buttonicon+"'></span>"+d.caption+"</div>")}if(d.id){b(f).attr("id",d.id)}if(d.position=="first"){if(e.rows[0].cells.length===0){b("tr",e).append(f)}else{b("tr td:eq(0)",e).before(f)}}else{b("tr",e).append(f)}b(f,e).attr("title",d.title||"").click(function(h){if(!b(this).hasClass("ui-state-disabled")){if(b.isFunction(d.onClickButton)){d.onClickButton.call(g,h)}}return false}).hover(function(){if(!b(this).hasClass("ui-state-disabled")){b(this).addClass("ui-state-hover")}},function(){b(this).removeClass("ui-state-hover")})}})},navSeparatorAdd:function(c,d){d=b.extend({sepclass:"ui-separator",sepcontent:""},d||{});return this.each(function(){if(!this.grid){return}if(c.indexOf("#")!==0){c="#"+c}var f=b(".navtable",c)[0];if(f){var e="<td class='ui-pg-button ui-state-disabled' style='width:4px;'><span class='"+d.sepclass+"'></span>"+d.sepcontent+"</td>";b("tr",f).append(e)}})},GridToForm:function(c,d){return this.each(function(){var g=this;if(!g.grid){return}var f=b(g).jqGrid("getRowData",c);if(f){for(var e in f){if(b("[name="+b.jgrid.jqID(e)+"]",d).is("input:radio")||b("[name="+b.jgrid.jqID(e)+"]",d).is("input:checkbox")){b("[name="+b.jgrid.jqID(e)+"]",d).each(function(){if(b(this).val()==f[e]){b(this).attr("checked","checked")}else{b(this).attr("checked","")}})}else{b("[name="+b.jgrid.jqID(e)+"]",d).val(f[e])}}}})},FormToGrid:function(d,e,f,c){return this.each(function(){var j=this;if(!j.grid){return}if(!f){f="set"}if(!c){c="first"}var g=b(e).serializeArray();var h={};b.each(g,function(k,l){h[l.name]=l.value});if(f=="add"){b(j).jqGrid("addRowData",d,h,c)}else{if(f=="set"){b(j).jqGrid("setRowData",d,h)}}})}})})(jQuery);(function(a){a.jgrid.extend({editRow:function(c,n,m,g,b,h,f,j,k){var e={keys:n||false,oneditfunc:m||null,successfunc:g||null,url:b||null,extraparam:h||{},aftersavefunc:f||null,errorfunc:j||null,afterrestorefunc:k||null,restoreAfterErorr:true},l=a.makeArray(arguments).slice(1),d;if(l[0]&&typeof(l[0])=="object"&&!a.isFunction(l[0])){d=a.extend(e,l[0])}else{d=e}return this.each(function(){var r=this,w,s,p,q=0,v=null,u={},o,t;if(!r.grid){return}o=a(r).jqGrid("getInd",c,true);if(o===false){return}p=a(o).attr("editable")||"0";if(p=="0"&&!a(o).hasClass("not-editable-row")){t=r.p.colModel;a("td",o).each(function(A){w=t[A].name;var z=r.p.treeGrid===true&&w==r.p.ExpandColumn;if(z){s=a("span:first",this).html()}else{try{s=a.unformat(this,{rowId:c,colModel:t[A]},A)}catch(x){s=(t[A].edittype&&t[A].edittype=="textarea")?a(this).text():a(this).html()}}if(w!="cb"&&w!="subgrid"&&w!="rn"){if(r.p.autoencode){s=a.jgrid.htmlDecode(s)}u[w]=s;if(t[A].editable===true){if(v===null){v=A}if(z){a("span:first",this).html("")}else{a(this).html("")}var y=a.extend({},t[A].editoptions||{},{id:c+"_"+w,name:w});if(!t[A].edittype){t[A].edittype="text"}if(s=="&nbsp;"||s=="&#160;"||(s.length==1&&s.charCodeAt(0)==160)){s=""}var B=a.jgrid.createEl(t[A].edittype,y,s,true,a.extend({},a.jgrid.ajaxOptions,r.p.ajaxSelectOptions||{}));a(B).addClass("editable");if(z){a("span:first",this).append(B)}else{a(this).append(B)}if(t[A].edittype=="select"&&t[A].editoptions.multiple===true&&a.browser.msie){a(B).width(a(B).width())}q++}}});if(q>0){u.id=c;r.p.savedRow.push(u);a(o).attr("editable","1");a("td:eq("+v+") input",o).focus();if(d.keys===true){a(o).bind("keydown",function(y){if(y.keyCode===27){a(r).jqGrid("restoreRow",c,k)}if(y.keyCode===13){var x=y.target;if(x.tagName=="TEXTAREA"){return true}a(r).jqGrid("saveRow",c,d);return false}y.stopPropagation()})}if(a.isFunction(d.oneditfunc)){d.oneditfunc.call(r,c)}}}})},saveRow:function(m,j,g,h,r,p,b){var F={successfunc:j||null,url:g||null,extraparam:h||{},aftersavefunc:r||null,errorfunc:p||null,afterrestorefunc:b||null,restoreAfterErorr:true},d=a.makeArray(arguments).slice(1),A;if(d[0]&&typeof(d[0])=="object"&&!a.isFunction(d[0])){A=a.extend(F,d[0])}else{A=F}var n=false;var D=this[0],c,G={},z={},y={},B,l,f,u;if(!D.grid){return n}u=a(D).jqGrid("getInd",m,true);if(u===false){return n}B=a(u).attr("editable");A.url=A.url?A.url:D.p.editurl;if(B==="1"){var s;a("td",u).each(function(o){s=D.p.colModel[o];c=s.name;if(c!="cb"&&c!="subgrid"&&s.editable===true&&c!="rn"&&!a(this).hasClass("not-editable-cell")){switch(s.edittype){case"checkbox":var k=["Yes","No"];if(s.editoptions){k=s.editoptions.value.split(":")}G[c]=a("input",this).attr("checked")?k[0]:k[1];break;case"text":case"password":case"textarea":case"button":G[c]=a("input, textarea",this).val();break;case"select":if(!s.editoptions.multiple){G[c]=a("select>option:selected",this).val();z[c]=a("select>option:selected",this).text()}else{var H=a("select",this),J=[];G[c]=a(H).val();if(G[c]){G[c]=G[c].join(",")}else{G[c]=""}a("select > option:selected",this).each(function(e,K){J[e]=a(K).text()});z[c]=J.join(",")}if(s.formatter&&s.formatter=="select"){z={}}break;case"custom":try{if(s.editoptions&&a.isFunction(s.editoptions.custom_value)){G[c]=s.editoptions.custom_value.call(D,a(".customelement",this),"get");if(G[c]===undefined){throw"e2"}}else{throw"e1"}}catch(I){if(I=="e1"){a.jgrid.info_dialog(jQuery.jgrid.errors.errcap,"function 'custom_value' "+a.jgrid.edit.msg.nodefined,jQuery.jgrid.edit.bClose)}if(I=="e2"){a.jgrid.info_dialog(jQuery.jgrid.errors.errcap,"function 'custom_value' "+a.jgrid.edit.msg.novalue,jQuery.jgrid.edit.bClose)}else{a.jgrid.info_dialog(jQuery.jgrid.errors.errcap,I.message,jQuery.jgrid.edit.bClose)}}break}f=a.jgrid.checkValues(G[c],o,D);if(f[0]===false){f[1]=G[c]+" "+f[1];return false}if(D.p.autoencode){G[c]=a.jgrid.htmlEncode(G[c])}if(A.url!=="clientArray"&&s.editoptions&&s.editoptions.NullIfEmpty===true){if(G[c]==""){y[c]="null"}}}});if(f[0]===false){try{var q=a.jgrid.findPos(a("#"+a.jgrid.jqID(m),D.grid.bDiv)[0]);a.jgrid.info_dialog(a.jgrid.errors.errcap,f[1],a.jgrid.edit.bClose,{left:q[0],top:q[1]})}catch(E){alert(f[1])}return n}if(G){var w,t,v;t=D.p.prmNames;v=t.oper;w=t.id;G[v]=t.editoper;G[w]=m;if(typeof(D.p.inlineData)=="undefined"){D.p.inlineData={}}G=a.extend({},G,D.p.inlineData,A.extraparam)}if(A.url=="clientArray"){G=a.extend({},G,z);if(D.p.autoencode){a.each(G,function(k,e){G[k]=a.jgrid.htmlDecode(e)})}var x=a(D).jqGrid("setRowData",m,G);a(u).attr("editable","0");for(var C=0;C<D.p.savedRow.length;C++){if(D.p.savedRow[C].id==m){l=C;break}}if(l>=0){D.p.savedRow.splice(l,1)}if(a.isFunction(A.aftersavefunc)){A.aftersavefunc.call(D,m,x)}n=true}else{a("#lui_"+D.p.id).show();y=a.extend({},G,y);a.ajax(a.extend({url:A.url,data:a.isFunction(D.p.serializeRowData)?D.p.serializeRowData.call(D,y):y,type:"POST",async:false,complete:function(H,I){a("#lui_"+D.p.id).hide();if(I==="success"){var o;if(a.isFunction(A.successfunc)){o=A.successfunc.call(D,H)}else{o=true}if(o===true){if(D.p.autoencode){a.each(G,function(J,k){G[J]=a.jgrid.htmlDecode(k)})}G=a.extend({},G,z);a(D).jqGrid("setRowData",m,G);a(u).attr("editable","0");for(var e=0;e<D.p.savedRow.length;e++){if(D.p.savedRow[e].id==m){l=e;break}}if(l>=0){D.p.savedRow.splice(l,1)}if(a.isFunction(A.aftersavefunc)){A.aftersavefunc.call(D,m,H)}n=true}else{if(a.isFunction(A.errorfunc)){A.errorfunc.call(D,m,H,I)}if(A.restoreAfterError===true){a(D).jqGrid("restoreRow",m,A.afterrestorefunc)}}}},error:function(k,o){a("#lui_"+D.p.id).hide();if(a.isFunction(A.errorfunc)){A.errorfunc.call(D,m,k,o)}else{try{jQuery.jgrid.info_dialog(jQuery.jgrid.errors.errcap,'<div class="ui-state-error">'+k.responseText+"</div>",jQuery.jgrid.edit.bClose,{buttonalign:"right"})}catch(H){alert(k.responseText)}}if(A.restoreAfterError===true){a(D).jqGrid("restoreRow",m,A.afterrestorefunc)}}},a.jgrid.ajaxOptions,D.p.ajaxRowOptions||{}))}a(u).unbind("keydown")}return n},restoreRow:function(c,b){return this.each(function(){var l=this,d,g,j={};if(!l.grid){return}g=a(l).jqGrid("getInd",c,true);if(g===false){return}for(var f=0;f<l.p.savedRow.length;f++){if(l.p.savedRow[f].id==c){d=f;break}}if(d>=0){if(a.isFunction(a.fn.datepicker)){try{a("input.hasDatepicker","#"+a.jgrid.jqID(g.id)).datepicker("hide")}catch(h){}}a.each(l.p.colModel,function(e,k){if(this.editable===true&&this.name in l.p.savedRow[d]&&!a(this).hasClass("not-editable-cell")){j[this.name]=l.p.savedRow[d][this.name]}});a(l).jqGrid("setRowData",c,j);a(g).attr("editable","0").unbind("keydown");l.p.savedRow.splice(d,1)}if(a.isFunction(b)){b.call(l,c)}})}})})(jQuery);(function(a){a.jgrid.extend({editCell:function(d,c,b){return this.each(function(){var j=this,n,k,g,l;if(!j.grid||j.p.cellEdit!==true){return}c=parseInt(c,10);j.p.selrow=j.rows[d].id;if(!j.p.knv){a(j).jqGrid("GridNav")}if(j.p.savedRow.length>0){if(b===true){if(d==j.p.iRow&&c==j.p.iCol){return}}a(j).jqGrid("saveCell",j.p.savedRow[0].id,j.p.savedRow[0].ic)}else{window.setTimeout(function(){a("#"+j.p.knv).attr("tabindex","-1").focus()},0)}l=j.p.colModel[c];n=l.name;if(n=="subgrid"||n=="cb"||n=="rn"){return}g=a("td:eq("+c+")",j.rows[d]);if(l.editable===true&&b===true&&!g.hasClass("not-editable-cell")){if(parseInt(j.p.iCol,10)>=0&&parseInt(j.p.iRow,10)>=0){a("td:eq("+j.p.iCol+")",j.rows[j.p.iRow]).removeClass("edit-cell ui-state-highlight");a(j.rows[j.p.iRow]).removeClass("selected-row ui-state-hover")}a(g).addClass("edit-cell ui-state-highlight");a(j.rows[d]).addClass("selected-row ui-state-hover");try{k=a.unformat(g,{rowId:j.rows[d].id,colModel:l},c)}catch(m){k=(l.edittype&&l.edittype=="textarea")?a(g).text():a(g).html()}if(j.p.autoencode){k=a.jgrid.htmlDecode(k)}if(!l.edittype){l.edittype="text"}j.p.savedRow.push({id:d,ic:c,name:n,v:k});if(k=="&nbsp;"||k=="&#160;"||(k.length==1&&k.charCodeAt(0)==160)){k=""}if(a.isFunction(j.p.formatCell)){var h=j.p.formatCell.call(j,j.rows[d].id,n,k,d,c);if(h!==undefined){k=h}}var f=a.extend({},l.editoptions||{},{id:d+"_"+n,name:n});var e=a.jgrid.createEl(l.edittype,f,k,true,a.extend({},a.jgrid.ajaxOptions,j.p.ajaxSelectOptions||{}));if(a.isFunction(j.p.beforeEditCell)){j.p.beforeEditCell.call(j,j.rows[d].id,n,k,d,c)}a(g).html("").append(e).attr("tabindex","0");window.setTimeout(function(){a(e).focus()},0);a("input, select, textarea",g).bind("keydown",function(o){if(o.keyCode===27){if(a("input.hasDatepicker",g).length>0){if(a(".ui-datepicker").is(":hidden")){a(j).jqGrid("restoreCell",d,c)}else{a("input.hasDatepicker",g).datepicker("hide")}}else{a(j).jqGrid("restoreCell",d,c)}}if(o.keyCode===13){a(j).jqGrid("saveCell",d,c)}if(o.keyCode==9){if(!j.grid.hDiv.loading){if(o.shiftKey){a(j).jqGrid("prevCell",d,c)}else{a(j).jqGrid("nextCell",d,c)}}else{return false}}o.stopPropagation()});if(a.isFunction(j.p.afterEditCell)){j.p.afterEditCell.call(j,j.rows[d].id,n,k,d,c)}}else{if(parseInt(j.p.iCol,10)>=0&&parseInt(j.p.iRow,10)>=0){a("td:eq("+j.p.iCol+")",j.rows[j.p.iRow]).removeClass("edit-cell ui-state-highlight");a(j.rows[j.p.iRow]).removeClass("selected-row ui-state-hover")}g.addClass("edit-cell ui-state-highlight");a(j.rows[d]).addClass("selected-row ui-state-hover");if(a.isFunction(j.p.onSelectCell)){k=g.html().replace(/\&#160\;/ig,"");j.p.onSelectCell.call(j,j.rows[d].id,n,k,d,c)}}j.p.iCol=c;j.p.iRow=d})},saveCell:function(c,b){return this.each(function(){var w=this,h;if(!w.grid||w.p.cellEdit!==true){return}if(w.p.savedRow.length>=1){h=0}else{h=null}if(h!==null){var q=a("td:eq("+b+")",w.rows[c]),o,d,k=w.p.colModel[b],f=k.name,j=a.jgrid.jqID(f);switch(k.edittype){case"select":if(!k.editoptions.multiple){o=a("#"+c+"_"+j+">option:selected",w.rows[c]).val();d=a("#"+c+"_"+j+">option:selected",w.rows[c]).text()}else{var u=a("#"+c+"_"+j,w.rows[c]),t=[];o=a(u).val();if(o){o.join(",")}else{o=""}a("option:selected",u).each(function(e,v){t[e]=a(v).text()});d=t.join(",")}if(k.formatter){d=o}break;case"checkbox":var r=["Yes","No"];if(k.editoptions){r=k.editoptions.value.split(":")}o=a("#"+c+"_"+j,w.rows[c]).attr("checked")?r[0]:r[1];d=o;break;case"password":case"text":case"textarea":case"button":o=a("#"+c+"_"+j,w.rows[c]).val();d=o;break;case"custom":try{if(k.editoptions&&a.isFunction(k.editoptions.custom_value)){o=k.editoptions.custom_value.call(w,a(".customelement",q),"get");if(o===undefined){throw"e2"}else{d=o}}else{throw"e1"}}catch(x){if(x=="e1"){a.jgrid.info_dialog(jQuery.jgrid.errors.errcap,"function 'custom_value' "+a.jgrid.edit.msg.nodefined,jQuery.jgrid.edit.bClose)}if(x=="e2"){a.jgrid.info_dialog(jQuery.jgrid.errors.errcap,"function 'custom_value' "+a.jgrid.edit.msg.novalue,jQuery.jgrid.edit.bClose)}else{a.jgrid.info_dialog(jQuery.jgrid.errors.errcap,x.message,jQuery.jgrid.edit.bClose)}}break}if(d!=w.p.savedRow[h].v){if(a.isFunction(w.p.beforeSaveCell)){var s=w.p.beforeSaveCell.call(w,w.rows[c].id,f,o,c,b);if(s){o=s;d=s}}var g=a.jgrid.checkValues(o,b,w);if(g[0]===true){var m={};if(a.isFunction(w.p.beforeSubmitCell)){m=w.p.beforeSubmitCell.call(w,w.rows[c].id,f,o,c,b);if(!m){m={}}}if(a("input.hasDatepicker",q).length>0){a("input.hasDatepicker",q).datepicker("hide")}if(w.p.cellsubmit=="remote"){if(w.p.cellurl){var y={};if(w.p.autoencode){o=a.jgrid.htmlEncode(o)}y[f]=o;var p,n,l;l=w.p.prmNames;p=l.id;n=l.oper;y[p]=w.rows[c].id;y[n]=l.editoper;y=a.extend(m,y);a("#lui_"+w.p.id).show();w.grid.hDiv.loading=true;a.ajax(a.extend({url:w.p.cellurl,data:a.isFunction(w.p.serializeCellData)?w.p.serializeCellData.call(w,y):y,type:"POST",complete:function(e,z){a("#lui_"+w.p.id).hide();w.grid.hDiv.loading=false;if(z=="success"){if(a.isFunction(w.p.afterSubmitCell)){var v=w.p.afterSubmitCell.call(w,e,y.id,f,o,c,b);if(v[0]===true){a(q).empty();a(w).jqGrid("setCell",w.rows[c].id,b,d,false,false,true);a(q).addClass("dirty-cell");a(w.rows[c]).addClass("edited");if(a.isFunction(w.p.afterSaveCell)){w.p.afterSaveCell.call(w,w.rows[c].id,f,o,c,b)}w.p.savedRow.splice(0,1)}else{a.jgrid.info_dialog(a.jgrid.errors.errcap,v[1],a.jgrid.edit.bClose);a(w).jqGrid("restoreCell",c,b)}}else{a(q).empty();a(w).jqGrid("setCell",w.rows[c].id,b,d,false,false,true);a(q).addClass("dirty-cell");a(w.rows[c]).addClass("edited");if(a.isFunction(w.p.afterSaveCell)){w.p.afterSaveCell.call(w,w.rows[c].id,f,o,c,b)}w.p.savedRow.splice(0,1)}}},error:function(e,v){a("#lui_"+w.p.id).hide();w.grid.hDiv.loading=false;if(a.isFunction(w.p.errorCell)){w.p.errorCell.call(w,e,v);a(w).jqGrid("restoreCell",c,b)}else{a.jgrid.info_dialog(a.jgrid.errors.errcap,e.status+" : "+e.statusText+"<br/>"+v,a.jgrid.edit.bClose);a(w).jqGrid("restoreCell",c,b)}}},a.jgrid.ajaxOptions,w.p.ajaxCellOptions||{}))}else{try{a.jgrid.info_dialog(a.jgrid.errors.errcap,a.jgrid.errors.nourl,a.jgrid.edit.bClose);a(w).jqGrid("restoreCell",c,b)}catch(x){}}}if(w.p.cellsubmit=="clientArray"){a(q).empty();a(w).jqGrid("setCell",w.rows[c].id,b,d,false,false,true);a(q).addClass("dirty-cell");a(w.rows[c]).addClass("edited");if(a.isFunction(w.p.afterSaveCell)){w.p.afterSaveCell.call(w,w.rows[c].id,f,o,c,b)}w.p.savedRow.splice(0,1)}}else{try{window.setTimeout(function(){a.jgrid.info_dialog(a.jgrid.errors.errcap,o+" "+g[1],a.jgrid.edit.bClose)},100);a(w).jqGrid("restoreCell",c,b)}catch(x){}}}else{a(w).jqGrid("restoreCell",c,b)}}if(a.browser.opera){a("#"+w.p.knv).attr("tabindex","-1").focus()}else{window.setTimeout(function(){a("#"+w.p.knv).attr("tabindex","-1").focus()},0)}})},restoreCell:function(c,b){return this.each(function(){var h=this,d;if(!h.grid||h.p.cellEdit!==true){return}if(h.p.savedRow.length>=1){d=0}else{d=null}if(d!==null){var g=a("td:eq("+b+")",h.rows[c]);if(a.isFunction(a.fn.datepicker)){try{a("input.hasDatepicker",g).datepicker("hide")}catch(f){}}a(g).empty().attr("tabindex","-1");a(h).jqGrid("setCell",h.rows[c].id,b,h.p.savedRow[d].v,false,false,true);if(a.isFunction(h.p.afterRestoreCell)){h.p.afterRestoreCell.call(h,h.rows[c].id,h.p.savedRow[d].v,c,b)}h.p.savedRow.splice(0,1)}window.setTimeout(function(){a("#"+h.p.knv).attr("tabindex","-1").focus()},0)})},nextCell:function(c,b){return this.each(function(){var f=this,e=false;if(!f.grid||f.p.cellEdit!==true){return}for(var d=b+1;d<f.p.colModel.length;d++){if(f.p.colModel[d].editable===true){e=d;break}}if(e!==false){a(f).jqGrid("editCell",c,e,true)}else{if(f.p.savedRow.length>0){a(f).jqGrid("saveCell",c,b)}}})},prevCell:function(c,b){return this.each(function(){var f=this,e=false;if(!f.grid||f.p.cellEdit!==true){return}for(var d=b-1;d>=0;d--){if(f.p.colModel[d].editable===true){e=d;break}}if(e!==false){a(f).jqGrid("editCell",c,e,true)}else{if(f.p.savedRow.length>0){a(f).jqGrid("saveCell",c,b)}}})},GridNav:function(){return this.each(function(){var g=this;if(!g.grid||g.p.cellEdit!==true){return}g.p.knv=g.p.id+"_kn";var f=a("<span style='width:0px;height:0px;background-color:black;' tabindex='0'><span tabindex='-1' style='width:0px;height:0px;background-color:grey' id='"+g.p.knv+"'></span></span>"),d,c;a(f).insertBefore(g.grid.cDiv);a("#"+g.p.knv).focus().keydown(function(h){c=h.keyCode;if(g.p.direction=="rtl"){if(c==37){c=39}else{if(c==39){c=37}}}switch(c){case 38:if(g.p.iRow-1>0){e(g.p.iRow-1,g.p.iCol,"vu");a(g).jqGrid("editCell",g.p.iRow-1,g.p.iCol,false)}break;case 40:if(g.p.iRow+1<=g.rows.length-1){e(g.p.iRow+1,g.p.iCol,"vd");a(g).jqGrid("editCell",g.p.iRow+1,g.p.iCol,false)}break;case 37:if(g.p.iCol-1>=0){d=b(g.p.iCol-1,"lft");e(g.p.iRow,d,"h");a(g).jqGrid("editCell",g.p.iRow,d,false)}break;case 39:if(g.p.iCol+1<=g.p.colModel.length-1){d=b(g.p.iCol+1,"rgt");e(g.p.iRow,d,"h");a(g).jqGrid("editCell",g.p.iRow,d,false)}break;case 13:if(parseInt(g.p.iCol,10)>=0&&parseInt(g.p.iRow,10)>=0){a(g).jqGrid("editCell",g.p.iRow,g.p.iCol,true)}break}return false});function e(q,o,p){if(p.substr(0,1)=="v"){var h=a(g.grid.bDiv)[0].clientHeight,r=a(g.grid.bDiv)[0].scrollTop,s=g.rows[q].offsetTop+g.rows[q].clientHeight,m=g.rows[q].offsetTop;if(p=="vd"){if(s>=h){a(g.grid.bDiv)[0].scrollTop=a(g.grid.bDiv)[0].scrollTop+g.rows[q].clientHeight}}if(p=="vu"){if(m<r){a(g.grid.bDiv)[0].scrollTop=a(g.grid.bDiv)[0].scrollTop-g.rows[q].clientHeight}}}if(p=="h"){var l=a(g.grid.bDiv)[0].clientWidth,k=a(g.grid.bDiv)[0].scrollLeft,j=g.rows[q].cells[o].offsetLeft+g.rows[q].cells[o].clientWidth,n=g.rows[q].cells[o].offsetLeft;if(j>=l+parseInt(k,10)){a(g.grid.bDiv)[0].scrollLeft=a(g.grid.bDiv)[0].scrollLeft+g.rows[q].cells[o].clientWidth}else{if(n<k){a(g.grid.bDiv)[0].scrollLeft=a(g.grid.bDiv)[0].scrollLeft-g.rows[q].cells[o].clientWidth}}}}function b(l,h){var k,j;if(h=="lft"){k=l+1;for(j=l;j>=0;j--){if(g.p.colModel[j].hidden!==true){k=j;break}}}if(h=="rgt"){k=l-1;for(j=l;j<g.p.colModel.length;j++){if(g.p.colModel[j].hidden!==true){k=j;break}}}return k}})},getChangedCells:function(c){var b=[];if(!c){c="all"}this.each(function(){var e=this,d;if(!e.grid||e.p.cellEdit!==true){return}a(e.rows).each(function(f){var g={};if(a(this).hasClass("edited")){a("td",this).each(function(h){d=e.p.colModel[h].name;if(d!=="cb"&&d!=="subgrid"){if(c=="dirty"){if(a(this).hasClass("dirty-cell")){try{g[d]=a.unformat(this,{rowId:e.rows[f].id,colModel:e.p.colModel[h]},h)}catch(j){g[d]=a.jgrid.htmlDecode(a(this).html())}}}else{try{g[d]=a.unformat(this,{rowId:e.rows[f].id,colModel:e.p.colModel[h]},h)}catch(j){g[d]=a.jgrid.htmlDecode(a(this).html())}}}});g.id=this.id;b.push(g)}})});return b}})})(jQuery);(function(a){a.jgrid.extend({setSubGrid:function(){return this.each(function(){var e=this,b,c={plusicon:"ui-icon-plus",minusicon:"ui-icon-minus",openicon:"ui-icon-carat-1-sw",expandOnLoad:false,delayOnLoad:50,selectOnExpand:false,reloadOnExpand:true};e.p.subGridOptions=a.extend(c,e.p.subGridOptions||{});e.p.colNames.unshift("");e.p.colModel.unshift({name:"subgrid",width:a.browser.safari?e.p.subGridWidth+e.p.cellLayout:e.p.subGridWidth,sortable:false,resizable:false,hidedlg:true,search:false,fixed:true});b=e.p.subGridModel;if(b[0]){b[0].align=a.extend([],b[0].align||[]);for(var d=0;d<b[0].name.length;d++){b[0].align[d]=b[0].align[d]||"left"}}})},addSubGridCell:function(f,e){var d="",b,c;this.each(function(){d=this.formatCol(f,e);c=this.p.id;b=this.p.subGridOptions.plusicon});return'<td role="grid" aria-describedby="'+c+'_subgrid" class="ui-sgcollapsed sgcollapsed" '+d+"><a href='javascript:void(0);'><span class='ui-icon-os "+b+"'></span></a></td>"},addSubGrid:function(c,b){return this.each(function(){var n=this;if(!n.grid){return}var f=function(s,r,u){var t=a("<td align='"+n.p.subGridModel[0].align[u]+"'></td>").html(r);a(s).append(t)};var e=function(s,y){var x,v,u,w=a("<table cellspacing='0' cellpadding='0' border='0'><tbody></tbody></table>"),r=a("<tr></tr>");for(v=0;v<n.p.subGridModel[0].name.length;v++){x=a("<th class='ui-state-default-grid ui-th-subgrid ui-th-column ui-th-"+n.p.direction+"'></th>");a(x).html(n.p.subGridModel[0].name[v]);a(x).width(n.p.subGridModel[0].width[v]);a(r).append(x)}a(w).append(r);if(s){u=n.p.xmlReader.subgrid;a(u.root+" "+u.row,s).each(function(){r=a("<tr class='ui-widget-content-grid ui-subtblcell'></tr>");if(u.repeatitems===true){a(u.cell,this).each(function(A){f(r,a(this).text()||"&#160;",A)})}else{var z=n.p.subGridModel[0].mapping||n.p.subGridModel[0].name;if(z){for(v=0;v<z.length;v++){f(r,a(z[v],this).text()||"&#160;",v)}}}a(w).append(r)})}var t=a("table:first",n.grid.bDiv).attr("id")+"_";a("#"+t+y).append(w);n.grid.hDiv.loading=false;a("#load_"+n.p.id).hide();return false};var g=function(y,v){var A,C,w,z,r,u,t=a("<table cellspacing='0' cellpadding='0' border='0'><tbody></tbody></table>"),s=a("<tr></tr>");for(w=0;w<n.p.subGridModel[0].name.length;w++){A=a("<th class='ui-state-default-grid ui-th-subgrid ui-th-column ui-th-"+n.p.direction+"'></th>");a(A).html(n.p.subGridModel[0].name[w]);a(A).width(n.p.subGridModel[0].width[w]);a(s).append(A)}a(t).append(s);if(y){r=n.p.jsonReader.subgrid;C=y[r.root];if(typeof C!=="undefined"){for(w=0;w<C.length;w++){z=C[w];s=a("<tr class='ui-widget-content-grid ui-subtblcell'></tr>");if(r.repeatitems===true){if(r.cell){z=z[r.cell]}for(u=0;u<z.length;u++){f(s,z[u]||"&#160;",u)}}else{var x=n.p.subGridModel[0].mapping||n.p.subGridModel[0].name;if(x.length){for(u=0;u<x.length;u++){f(s,z[x[u]]||"&#160;",u)}}}a(t).append(s)}}}var B=a("table:first",n.grid.bDiv).attr("id")+"_";a("#"+B+v).append(t);n.grid.hDiv.loading=false;a("#load_"+n.p.id).hide();return false};var o=function(u){var r,v,t,s;r=a(u).attr("id");v={nd_:(new Date().getTime())};v[n.p.prmNames.subgridid]=r;if(!n.p.subGridModel[0]){return false}if(n.p.subGridModel[0].params){for(s=0;s<n.p.subGridModel[0].params.length;s++){for(t=0;t<n.p.colModel.length;t++){if(n.p.colModel[t].name==n.p.subGridModel[0].params[s]){v[n.p.colModel[t].name]=a("td:eq("+t+")",u).text().replace(/\&#160\;/ig,"")}}}}if(!n.grid.hDiv.loading){n.grid.hDiv.loading=true;a("#load_"+n.p.id).show();if(!n.p.subgridtype){n.p.subgridtype=n.p.datatype}if(a.isFunction(n.p.subgridtype)){n.p.subgridtype.call(n,v)}else{n.p.subgridtype=n.p.subgridtype.toLowerCase()}switch(n.p.subgridtype){case"xml":case"json":a.ajax(a.extend({type:n.p.mtype,url:n.p.subGridUrl,dataType:n.p.subgridtype,data:a.isFunction(n.p.serializeSubGridData)?n.p.serializeSubGridData.call(n,v):v,complete:function(w){if(n.p.subgridtype=="xml"){e(w.responseXML,r)}else{g(a.jgrid.parse(w.responseText),r)}w=null}},a.jgrid.ajaxOptions,n.p.ajaxSubgridOptions||{}));break}}return false};var p,q,j,l=0,h,d;a.each(n.p.colModel,function(s,r){if(this.hidden===true||this.name=="rn"||this.name=="cb"){l++}});var m=n.rows.length,k=1;if(b!==undefined&&b>0){k=b;m=b+1}while(k<m){if(a(n.rows[k]).hasClass("jqgrow")){a(n.rows[k].cells[c]).bind("click",function(s){var r=a(this).parent("tr")[0];d=r.nextSibling;if(a(this).hasClass("sgcollapsed")){q=n.p.id;p=r.id;if(n.p.subGridOptions.reloadOnExpand===true||(n.p.subGridOptions.reloadOnExpand===false&&!a(d).hasClass("ui-subgrid"))){j=c>=1?"<td colspan='"+c+"'>&#160;</td>":"";h=true;if(a.isFunction(n.p.subGridBeforeExpand)){h=n.p.subGridBeforeExpand.call(n,q+"_"+p,p)}if(h===false){return false}a(r).after("<tr role='row' class='ui-subgrid'>"+j+"<td class='ui-widget-content-grid subgrid-cell'><span class='ui-icon-os "+n.p.subGridOptions.openicon+"'></span></td><td colspan='"+parseInt(n.p.colNames.length-1-l,10)+"' class='ui-widget-content-grid subgrid-data'><div id="+q+"_"+p+" class='tablediv'></div></td></tr>");if(a.isFunction(n.p.subGridRowExpanded)){n.p.subGridRowExpanded.call(n,q+"_"+p,p)}else{o(r)}}else{a(d).show()}a(this).html("<a href='javascript:void(0);'><span class='ui-icon-os "+n.p.subGridOptions.minusicon+"'></span></a>").removeClass("sgcollapsed").addClass("sgexpanded");if(n.p.subGridOptions.selectOnExpand){a(n).jqGrid("setSelection",p)}}else{if(a(this).hasClass("sgexpanded")){h=true;if(a.isFunction(n.p.subGridRowColapsed)){p=r.id;h=n.p.subGridRowColapsed.call(n,q+"_"+p,p)}if(h===false){return false}if(n.p.subGridOptions.reloadOnExpand===true){a(d).remove(".ui-subgrid")}else{if(a(d).hasClass("ui-subgrid")){a(d).hide()}}a(this).html("<a href='javascript:void(0);'><span class='ui-icon-os "+n.p.subGridOptions.plusicon+"'></span></a>").removeClass("sgexpanded").addClass("sgcollapsed")}}return false});if(n.p.subGridOptions.expandOnLoad===true){setTimeout(function(){a(tr.cells[c]).trigger("click")},k*n.p.subGridOptions.delayOnLoad)}}k++}n.subGridXml=function(s,r){e(s,r)};n.subGridJson=function(s,r){g(s,r)}})},expandSubGridRow:function(b){return this.each(function(){var e=this;if(!e.grid&&!b){return}if(e.p.subGrid===true){var c=a(this).jqGrid("getInd",b,true);if(c){var d=a("td.sgcollapsed",c)[0];if(d){a(d).trigger("click")}}}})},collapseSubGridRow:function(b){return this.each(function(){var e=this;if(!e.grid&&!b){return}if(e.p.subGrid===true){var c=a(this).jqGrid("getInd",b,true);if(c){var d=a("td.sgexpanded",c)[0];if(d){a(d).trigger("click")}}}})},toggleSubGridRow:function(b){return this.each(function(){var e=this;if(!e.grid&&!b){return}if(e.p.subGrid===true){var c=a(this).jqGrid("getInd",b,true);if(c){var d=a("td.sgcollapsed",c)[0];if(d){a(d).trigger("click")}else{d=a("td.sgexpanded",c)[0];if(d){a(d).trigger("click")}}}}})}})})(jQuery);(function(a){a.jgrid.extend({setTreeNode:function(c,b){return this.each(function(){var q=this;if(!q.grid||!q.p.treeGrid){return}var k=q.p.expColInd,m=q.p.treeReader.expanded_field,t=q.p.treeReader.leaf_field,d=q.p.treeReader.level_field,s=q.p.treeReader.icon_field,o=q.p.treeReader.loaded,v,l,e,h,n,w,u,j;while(c<b){var g=q.rows[c].id,f=q.p._index[g],r;u=q.p.data[f];if(q.p.treeGridModel=="nested"){if(!u[t]){v=parseInt(u[q.p.treeReader.left_field],10);l=parseInt(u[q.p.treeReader.right_field],10);u[t]=(l===v+1)?"true":"false";q.rows[c].cells[q.p._treeleafpos].innerHTML=u[t]}}e=parseInt(u[d],10);if(q.p.tree_root_level===0){h=e+1;n=e}else{h=e;n=e-1}w="<div class='tree-wrap tree-wrap-"+q.p.direction+"' style='width:"+(h*18)+"px;'>";w+="<div style='"+(q.p.direction=="rtl"?"right:":"left:")+(n*18)+"px;' class='ui-icon-os ";if(u[o]!==undefined){if(u[o]=="true"||u[o]===true){u[o]=true}else{u[o]=false}}if(u[t]=="true"||u[t]===true){w+=((u[s]!==undefined&&u[s]!=="")?u[s]:q.p.treeIcons.leaf)+" tree-leaf treeclick'";u[t]=true;j="leaf"}else{u[t]=false;j=""}u[m]=((u[m]=="true"||u[m]===true)?true:false)&&u[o];if(u[m]===true){w+=q.p.treeIcons.minus+" tree-minus treeclick'"}else{w+=q.p.treeIcons.plus+" tree-plus treeclick'"}w+="</div></div>";a(q.rows[c].cells[k]).wrapInner("<span class='cell-wrapper"+j+"'></span>").prepend(w);if(e!==parseInt(q.p.tree_root_level,10)){var p=a(q).jqGrid("getNodeParent",u);r=p&&p.hasOwnProperty(m)?p[m]:true;if(!r){a(q.rows[c]).css("display","none")}}a(q.rows[c].cells[k]).find("div.treeclick").bind("click",function(y){var x=y.target||y.srcElement,A=a(x,q.rows).closest("tr.jqgrow")[0].id,z=q.p._index[A];if(!q.p.data[z][t]){if(q.p.data[z][m]){a(q).jqGrid("collapseRow",q.p.data[z]);a(q).jqGrid("collapseNode",q.p.data[z])}else{a(q).jqGrid("expandRow",q.p.data[z]);a(q).jqGrid("expandNode",q.p.data[z])}}return false});if(q.p.ExpandColClick===true){a(q.rows[c].cells[k]).find("span.cell-wrapper").css("cursor","pointer").bind("click",function(y){var x=y.target||y.srcElement,A=a(x,q.rows).closest("tr.jqgrow")[0].id,z=q.p._index[A];if(!q.p.data[z][t]){if(q.p.data[z][m]){a(q).jqGrid("collapseRow",q.p.data[z]);a(q).jqGrid("collapseNode",q.p.data[z])}else{a(q).jqGrid("expandRow",q.p.data[z]);a(q).jqGrid("expandNode",q.p.data[z])}}a(q).jqGrid("setSelection",A);return false})}c++}})},setTreeGrid:function(){return this.each(function(){var j=this,f=0,d,h=false,c,e,b=[];if(!j.p.treeGrid){return}if(!j.p.treedatatype){a.extend(j.p,{treedatatype:j.p.datatype})}j.p.subGrid=false;j.p.altRows=false;j.p.pgbuttons=false;j.p.pginput=false;j.p.gridview=true;j.p.multiselect=false;j.p.rowList=[];j.p.expColInd=0;d="ui-icon-triangle-1-"+(j.p.direction=="rtl"?"w":"e");j.p.treeIcons=a.extend({plus:d,minus:"ui-icon-triangle-1-s",leaf:"ui-icon-radio-off"},j.p.treeIcons||{});if(j.p.treeGridModel=="nested"){j.p.treeReader=a.extend({level_field:"level",left_field:"lft",right_field:"rgt",leaf_field:"isLeaf",expanded_field:"expanded",loaded:"loaded",icon_field:"icon"},j.p.treeReader)}else{if(j.p.treeGridModel=="adjacency"){j.p.treeReader=a.extend({level_field:"level",parent_id_field:"parent",leaf_field:"isLeaf",expanded_field:"expanded",loaded:"loaded",icon_field:"icon"},j.p.treeReader)}}for(e in j.p.colModel){if(j.p.colModel.hasOwnProperty(e)){c=j.p.colModel[e].name;if(c==j.p.ExpandColumn&&!h){h=true;j.p.expColInd=f}f++;for(var g in j.p.treeReader){if(j.p.treeReader[g]==c){b.push(c)}}}}a.each(j.p.treeReader,function(k,l){if(l&&a.inArray(l,b)===-1){if(k==="leaf_field"){j.p._treeleafpos=f}f++;j.p.colNames.push(l);j.p.colModel.push({name:l,width:1,hidden:true,sortable:false,resizable:false,hidedlg:true,editable:true,search:false})}})})},expandRow:function(b){this.each(function(){var e=this;if(!e.grid||!e.p.treeGrid){return}var d=a(e).jqGrid("getNodeChildren",b),c=e.p.treeReader.expanded_field;a(d).each(function(f){var g=a.jgrid.getAccessor(this,e.p.localReader.id);a("#"+g,e.grid.bDiv).css("display","");if(this[c]){a(e).jqGrid("expandRow",this)}})})},collapseRow:function(b){this.each(function(){var e=this;if(!e.grid||!e.p.treeGrid){return}var d=a(e).jqGrid("getNodeChildren",b),c=e.p.treeReader.expanded_field;a(d).each(function(f){var g=a.jgrid.getAccessor(this,e.p.localReader.id);a("#"+g,e.grid.bDiv).css("display","none");if(this[c]){a(e).jqGrid("collapseRow",this)}})})},getRootNodes:function(){var b=[];this.each(function(){var e=this;if(!e.grid||!e.p.treeGrid){return}switch(e.p.treeGridModel){case"nested":var d=e.p.treeReader.level_field;a(e.p.data).each(function(f){if(parseInt(this[d],10)===parseInt(e.p.tree_root_level,10)){b.push(this)}});break;case"adjacency":var c=e.p.treeReader.parent_id_field;a(e.p.data).each(function(f){if(this[c]===null||String(this[c]).toLowerCase()=="null"){b.push(this)}});break}});return b},getNodeDepth:function(c){var b=null;this.each(function(){if(!this.grid||!this.p.treeGrid){return}var e=this;switch(e.p.treeGridModel){case"nested":var d=e.p.treeReader.level_field;b=parseInt(c[d],10)-parseInt(e.p.tree_root_level,10);break;case"adjacency":b=a(e).jqGrid("getNodeAncestors",c).length;break}});return b},getNodeParent:function(c){var b=null;this.each(function(){var g=this;if(!g.grid||!g.p.treeGrid){return}switch(g.p.treeGridModel){case"nested":var f=g.p.treeReader.left_field,m=g.p.treeReader.right_field,h=g.p.treeReader.level_field,l=parseInt(c[f],10),k=parseInt(c[m],10),d=parseInt(c[h],10);a(this.p.data).each(function(){if(parseInt(this[h],10)===d-1&&parseInt(this[f],10)<l&&parseInt(this[m],10)>k){b=this;return false}});break;case"adjacency":var j=g.p.treeReader.parent_id_field,e=g.p.localReader.id;a(this.p.data).each(function(n,o){if(this[e]==c[j]){b=this;return false}});break}});return b},getNodeChildren:function(c){var b=[];this.each(function(){var g=this;if(!g.grid||!g.p.treeGrid){return}switch(g.p.treeGridModel){case"nested":var f=g.p.treeReader.left_field,m=g.p.treeReader.right_field,h=g.p.treeReader.level_field,l=parseInt(c[f],10),k=parseInt(c[m],10),d=parseInt(c[h],10);a(this.p.data).each(function(n){if(parseInt(this[h],10)===d+1&&parseInt(this[f],10)>l&&parseInt(this[m],10)<k){b.push(this)}});break;case"adjacency":var j=g.p.treeReader.parent_id_field,e=g.p.localReader.id;a(this.p.data).each(function(n,o){if(this[j]==c[e]){b.push(this)}});break}});return b},getFullTreeNode:function(c){var b=[];this.each(function(){var g=this,h;if(!g.grid||!g.p.treeGrid){return}switch(g.p.treeGridModel){case"nested":var f=g.p.treeReader.left_field,n=g.p.treeReader.right_field,j=g.p.treeReader.level_field,m=parseInt(c[f],10),l=parseInt(c[n],10),d=parseInt(c[j],10);a(this.p.data).each(function(o){if(parseInt(this[j],10)>=d&&parseInt(this[f],10)>=m&&parseInt(this[f],10)<=l){b.push(this)}});break;case"adjacency":if(c){b.push(c);var k=g.p.treeReader.parent_id_field,e=g.p.localReader.id;a(this.p.data).each(function(o){h=b.length;for(o=0;o<h;o++){if(b[o][e]==this[k]){b.push(this);break}}})}break}});return b},getNodeAncestors:function(c){var b=[];this.each(function(){if(!this.grid||!this.p.treeGrid){return}var d=a(this).jqGrid("getNodeParent",c);while(d){b.push(d);d=a(this).jqGrid("getNodeParent",d)}});return b},isVisibleNode:function(c){var b=true;this.each(function(){var f=this;if(!f.grid||!f.p.treeGrid){return}var e=a(f).jqGrid("getNodeAncestors",c),d=f.p.treeReader.expanded_field;a(e).each(function(){b=b&&this[d];if(!b){return false}})});return b},isNodeLoaded:function(c){var b;this.each(function(){var e=this;if(!e.grid||!e.p.treeGrid){return}var d=e.p.treeReader.leaf_field;if(c!==undefined){if(c.loaded!==undefined){b=c.loaded}else{if(c[d]||a(e).jqGrid("getNodeChildren",c).length>0){b=true}else{b=false}}}else{b=false}});return b},expandNode:function(b){return this.each(function(){if(!this.grid||!this.p.treeGrid){return}var h=this.p.treeReader.expanded_field,j=this.p.treeReader.parent_id_field,f=this.p.treeReader.loaded,c=this.p.treeReader.level_field,l=this.p.treeReader.left_field,k=this.p.treeReader.right_field;if(!b[h]){var d=a.jgrid.getAccessor(b,this.p.localReader.id);var e=a("#"+d,this.grid.bDiv)[0];var g=this.p._index[d];if(a(this).jqGrid("isNodeLoaded",this.p.data[g])){b[h]=true;a("div.treeclick",e).removeClass(this.p.treeIcons.plus+" tree-plus").addClass(this.p.treeIcons.minus+" tree-minus")}else{b[h]=true;a("div.treeclick",e).removeClass(this.p.treeIcons.plus+" tree-plus").addClass(this.p.treeIcons.minus+" tree-minus");this.p.treeANode=e.rowIndex;this.p.datatype=this.p.treedatatype;if(this.p.treeGridModel=="nested"){a(this).jqGrid("setGridParam",{postData:{nodeid:d,n_left:b[l],n_right:b[k],n_level:b[c]}})}else{a(this).jqGrid("setGridParam",{postData:{nodeid:d,parentid:b[j],n_level:b[c]}})}a(this).trigger("reloadGrid");b[f]=true;if(this.p.treeGridModel=="nested"){a(this).jqGrid("setGridParam",{postData:{nodeid:"",n_left:"",n_right:"",n_level:""}})}else{a(this).jqGrid("setGridParam",{postData:{nodeid:"",parentid:"",n_level:""}})}}}})},collapseNode:function(b){return this.each(function(){if(!this.grid||!this.p.treeGrid){return}if(b.expanded){b.expanded=false;var d=a.jgrid.getAccessor(b,this.p.localReader.id);var c=a("#"+d,this.grid.bDiv)[0];a("div.treeclick",c).removeClass(this.p.treeIcons.minus+" tree-minus").addClass(this.p.treeIcons.plus+" tree-plus")}})},SortTree:function(e,c,b,d){return this.each(function(){if(!this.grid||!this.p.treeGrid){return}var k,f,m,j=[],n=this,l,h,g=a(this).jqGrid("getRootNodes");l=a.jgrid.from(g);l.orderBy(e,c,b,d);h=l.select();for(k=0,f=h.length;k<f;k++){m=h[k];j.push(m);a(this).jqGrid("collectChildrenSortTree",j,m,e,c,b,d)}a.each(j,function(o,p){var q=a.jgrid.getAccessor(this,n.p.localReader.id);a("#"+n.p.id+" tbody tr:eq("+o+")").after(a("tr#"+q,n.grid.bDiv))});l=null;h=null;j=null})},collectChildrenSortTree:function(b,f,g,d,c,e){return this.each(function(){if(!this.grid||!this.p.treeGrid){return}var k,h,n,l,m,j;l=a(this).jqGrid("getNodeChildren",f);m=a.jgrid.from(l);m.orderBy(g,d,c,e);j=m.select();for(k=0,h=j.length;k<h;k++){n=j[k];b.push(n);a(this).jqGrid("collectChildrenSortTree",b,n,g,d,c,e)}})},setTreeRow:function(b,c){var d=false;this.each(function(){var e=this;if(!e.grid||!e.p.treeGrid){return}d=a(e).jqGrid("setRowData",b,c)});return d},delTreeNode:function(b){return this.each(function(){var j=this,n=j.p.localReader.id,g=j.p.treeReader.left_field,l=j.p.treeReader.right_field,d,e,k,m;if(!j.grid||!j.p.treeGrid){return}var c=j.p._index[b];if(c!==undefined){d=parseInt(j.p.data[c][l],10);e=d-parseInt(j.p.data[c][g],10)+1;var f=a(j).jqGrid("getFullTreeNode",j.p.data[c]);if(f.length>0){for(var h=0;h<f.length;h++){a(j).jqGrid("delRowData",f[h][n])}}if(j.p.treeGridModel==="nested"){k=a.jgrid.from(j.p.data).greater(g,d,{stype:"integer"}).select();if(k.length){for(m in k){k[m][g]=parseInt(k[m][g],10)-e}}k=a.jgrid.from(j.p.data).greater(l,d,{stype:"integer"}).select();if(k.length){for(m in k){k[m][l]=parseInt(k[m][l],10)-e}}}}})},addChildNode:function(g,m,z){var s=this[0];if(z){var n=s.p.treeReader.expanded_field,w=s.p.treeReader.leaf_field,b=s.p.treeReader.level_field,v=s.p.treeReader.icon_field,h=s.p.treeReader.parent_id_field,d=s.p.treeReader.left_field,x=s.p.treeReader.right_field,o=s.p.treeReader.loaded,c,y,j,l,q,r,p=0,k=m,u,t;if(!g){q=s.p.data.length-1;if(q>=0){while(q>=0){p=Math.max(p,parseInt(s.p.data[q][s.p.localReader.id],10));q--}}g=p+1}var C=a(s).jqGrid("getInd",m);u=false;if(m===undefined||m===null||m===""){m=null;k=null;c="last";l=s.p.tree_root_level;q=s.p.data.length+1}else{c="after";y=s.p._index[m];j=s.p.data[y];m=j[s.p.localReader.id];l=parseInt(j[b],10)+1;var e=a(s).jqGrid("getFullTreeNode",j);if(e.length){q=e[e.length-1][s.p.localReader.id];k=q;q=a(s).jqGrid("getInd",k)+1}else{q=a(s).jqGrid("getInd",m)+1}if(j[w]){u=true;j[n]=true;a(s.rows[C]).find("span.cell-wrapperleaf").removeClass("cell-wrapperleaf").addClass("cell-wrapper").end().find("div.tree-leaf").removeClass(s.p.treeIcons.leaf+" tree-leaf").addClass(s.p.treeIcons.minus+" tree-minus");s.p.data[y][w]=false;j[o]=true}}r=q+1;z[n]=false;z[o]=true;z[b]=l;z[w]=true;if(s.p.treeGridModel==="adjacency"){z[h]=m}if(s.p.treeGridModel==="nested"){var f,B,A;if(m!==null){t=parseInt(j[x],10);f=a.jgrid.from(s.p.data);f=f.greaterOrEquals(x,t,{stype:"integer"});B=f.select();if(B.length){for(A in B){B[A][d]=B[A][d]>t?parseInt(B[A][d],10)+2:B[A][d];B[A][x]=B[A][x]>=t?parseInt(B[A][x],10)+2:B[A][x]}}z[d]=t;z[x]=t+1}else{t=parseInt(a(s).jqGrid("getCol",x,false,"max"),10);B=a.jgrid.from(s.p.data).greater(d,t,{stype:"integer"}).select();if(B.length){for(A in B){B[A][d]=parseInt(B[A][d],10)+2}}B=a.jgrid.from(s.p.data).greater(x,t,{stype:"integer"}).select();if(B.length){for(A in B){B[A][x]=parseInt(B[A][x],10)+2}}z[d]=t+1;z[x]=t+2}}if(m===null||a(s).jqGrid("isNodeLoaded",j)||u){a(s).jqGrid("addRowData",g,z,c,k);a(s).jqGrid("setTreeNode",q,r)}if(j&&!j[n]){a(s.rows[C]).find("div.treeclick").click()}}}})})(jQuery);(function(a){a.jgrid.extend({groupingSetup:function(){return this.each(function(){var g=this,c=g.p.groupingView;if(c!==null&&((typeof c==="object")||a.isFunction(c))){if(!c.groupField.length){g.p.grouping=false}else{if(typeof(c.visibiltyOnNextGrouping)=="undefined"){c.visibiltyOnNextGrouping=[]}for(var e=0;e<c.groupField.length;e++){if(!c.groupOrder[e]){c.groupOrder[e]="asc"}if(!c.groupText[e]){c.groupText[e]="{0}"}if(typeof(c.groupColumnShow[e])!="boolean"){c.groupColumnShow[e]=true}if(typeof(c.groupSummary[e])!="boolean"){c.groupSummary[e]=false}if(c.groupColumnShow[e]===true){c.visibiltyOnNextGrouping[e]=true;a(g).jqGrid("showCol",c.groupField[e])}else{c.visibiltyOnNextGrouping[e]=a("#"+g.p.id+"_"+c.groupField[e]).is(":visible");a(g).jqGrid("hideCol",c.groupField[e])}c.sortitems[e]=[];c.sortnames[e]=[];c.summaryval[e]=[];if(c.groupSummary[e]){c.summary[e]=[];var b=g.p.colModel;for(var d=0,f=b.length;d<f;d++){if(b[d].summaryType){c.summary[e].push({nm:b[d].name,st:b[d].summaryType,v:""})}}}}g.p.scroll=false;g.p.rownumbers=false;g.p.subGrid=false;g.p.treeGrid=false;g.p.gridview=true}}else{g.p.grouping=false}})},groupingPrepare:function(d,c,e,b){this.each(function(){c[0]+="";var h=c[0].toString().split(" ").join("");var f=this.p.groupingView,g=this;if(e.hasOwnProperty(h)){e[h].push(d)}else{e[h]=[];e[h].push(d);f.sortitems[0].push(h);f.sortnames[0].push(a.trim(c[0].toString()));f.summaryval[0][h]=a.extend(true,[],f.summary[0])}if(f.groupSummary[0]){a.each(f.summaryval[0][h],function(j,k){if(a.isFunction(this.st)){this.v=this.st.call(g,this.v,this.nm,b)}else{this.v=a(g).jqGrid("groupingCalculations."+this.st,this.v,this.nm,b)}})}});return e},groupingToggle:function(b){this.each(function(){var g=this,n=g.p.groupingView,d=b.lastIndexOf("_"),l=b.substring(0,d+1),h=parseInt(b.substring(d+1),10)+1,e=n.minusicon,k=n.plusicon,j=a("#"+b),c=j[0].nextSibling,m=a("#"+b+" span.tree-wrap-"+g.p.direction),f=false;if(m.hasClass(e)){if(n.showSummaryOnHide&&n.groupSummary[0]){if(c){while(c){if(a(c).hasClass("jqfoot")){break}a(c).hide();c=c.nextSibling}}}else{if(c){while(c){if(a(c).attr("id")==l+String(h)){break}a(c).hide();c=c.nextSibling}}}m.removeClass(e).addClass(k);f=true}else{if(c){while(c){if(a(c).attr("id")==l+String(h)){break}a(c).show();c=c.nextSibling}}m.removeClass(k).addClass(e);f=false}if(a.isFunction(g.p.onClickGroup)){g.p.onClickGroup.call(g,b,f)}});return false},groupingRender:function(b,c){return this.each(function(){var e=this,l=e.p.groupingView,g="",j="",k,f="",d,h,m;if(!l.groupDataSorted){l.sortitems[0].sort();l.sortnames[0].sort();if(l.groupOrder[0].toLowerCase()=="desc"){l.sortitems[0].reverse();l.sortnames[0].reverse()}}if(l.groupCollapse){f=l.plusicon}else{f=l.minusicon}f+=" tree-wrap-"+e.p.direction;m=0;while(m<c){if(e.p.colModel[m].name==l.groupField[0]){h=m;break}m++}a.each(l.sortitems[0],function(s,q){k=e.p.id+"ghead_"+s;j="<span style='cursor:pointer;' class='ui-icon-os "+f+"' onclick=\"jQuery('#"+e.p.id+"').jqGrid('groupingToggle','"+k+"');return false;\"></span>";try{d=e.formatter(k,l.sortnames[0][s],h,l.sortitems[0])}catch(z){d=l.sortnames[0][s]}g+='<tr id="'+k+'" role="row" class= "ui-widget-content-grid jqgroup ui-row-'+e.p.direction+'"><td colspan="'+c+'">'+j+a.jgrid.format(l.groupText[0],d,b[q].length)+"</td></tr>";for(var p=0;p<b[q].length;p++){g+=b[q][p].join("")}if(l.groupSummary[0]){var u="";if(l.groupCollapse&&!l.showSummaryOnHide){u=' style="display:none;"'}g+="<tr"+u+' role="row" class="ui-widget-content-grid jqfoot ui-row-'+e.p.direction+'">';var t=l.summaryval[0][q],w=e.p.colModel,v,x=b[q].length;for(var r=0;r<c;r++){var o="<td "+e.formatCol(r,1,"")+">&#160;</td>",y="{0}";a.each(t,function(){if(this.nm==w[r].name){if(w[r].summaryTpl){y=w[r].summaryTpl}if(this.st=="avg"){if(this.v&&x>0){this.v=(this.v/x)}}try{v=e.formatter("",this.v,r,this)}catch(n){v=this.v}o="<td "+e.formatCol(r,1,"")+">"+a.jgrid.format(y,v)+"</td>";return false}});g+=o}g+="</tr>"}});a("#"+e.p.id+" tbody:first").append(g);g=null})},groupingGroupBy:function(c,b,d){return this.each(function(){var g=this;if(typeof(c)=="string"){c=[c]}var e=g.p.groupingView;g.p.grouping=true;for(var f=0;f<e.groupField.length;f++){if(!e.groupColumnShow[f]&&e.visibiltyOnNextGrouping[f]){a(g).jqGrid("showCol",e.groupField[f])}}for(var f=0;f<c.length;f++){e.visibiltyOnNextGrouping[f]=a("#"+g.p.id+"_"+c[f]).is(":visible")}g.p.groupingView=a.extend(g.p.groupingView,b||{});e.groupField=c;a(g).trigger("reloadGrid")})},groupingRemove:function(b){return this.each(function(){var e=this;if(typeof(b)=="undefined"){b=true}e.p.grouping=false;if(b===true){var c=e.p.groupingView;for(var d=0;d<c.groupField.length;d++){if(!c.groupColumnShow[d]&&c.visibiltyOnNextGrouping[d]){a(e).jqGrid("showCol",c.groupField)}}a("tr.jqgroup, tr.jqfoot","#"+e.p.id+" tbody:first").remove();a("tr.jqgrow:hidden","#"+e.p.id+" tbody:first").show()}else{a(e).trigger("reloadGrid")}})},groupingCalculations:{sum:function(b,d,c){return parseFloat(b||0)+parseFloat((c[d]||0))},min:function(b,d,c){if(b===""){return parseFloat(c[d]||0)}return Math.min(parseFloat(b),parseFloat(c[d]||0))},max:function(b,d,c){if(b===""){return parseFloat(c[d]||0)}return Math.max(parseFloat(b),parseFloat(c[d]||0))},count:function(b,d,c){if(b===""){b=0}if(c.hasOwnProperty(d)){return b+1}else{return 0}},avg:function(b,d,c){return parseFloat(b||0)+parseFloat((c[d]||0))}}})})(jQuery);(function(a){a.jgrid.extend({jqGridImport:function(b){b=a.extend({imptype:"xml",impstring:"",impurl:"",mtype:"GET",impData:{},xmlGrid:{config:"roots>grid",data:"roots>rows"},jsonGrid:{config:"grid",data:"data"},ajaxOptions:{}},b||{});return this.each(function(){var f=this;var d=function(h,n){var g=a(n.xmlGrid.config,h)[0];var m=a(n.xmlGrid.data,h)[0],p,k;if(xmlJsonClass.xml2json&&a.jgrid.parse){p=xmlJsonClass.xml2json(g," ");p=a.jgrid.parse(p);for(var j in p){if(p.hasOwnProperty(j)){k=p[j]}}if(m){var l=p.grid.datatype;p.grid.datatype="xmlstring";p.grid.datastr=h;a(f).jqGrid(k).jqGrid("setGridParam",{datatype:l})}else{a(f).jqGrid(k)}p=null;k=null}else{alert("xml2json or parse are not present")}};var e=function(h,l){if(h&&typeof h=="string"){var g=a.jgrid.parse(h);var m=g[l.jsonGrid.config];var j=g[l.jsonGrid.data];if(j){var k=m.datatype;m.datatype="jsonstring";m.datastr=j;a(f).jqGrid(m).jqGrid("setGridParam",{datatype:k})}else{a(f).jqGrid(m)}}};switch(b.imptype){case"xml":a.ajax(a.extend({url:b.impurl,type:b.mtype,data:b.impData,dataType:"xml",complete:function(g,h){if(h=="success"){d(g.responseXML,b);if(a.isFunction(b.importComplete)){b.importComplete(g)}}g=null}},b.ajaxOptions));break;case"xmlstring":if(b.impstring&&typeof b.impstring=="string"){var c=a.jgrid.stringToDoc(b.impstring);if(c){d(c,b);if(a.isFunction(b.importComplete)){b.importComplete(c)}b.impstring=null}c=null}break;case"json":a.ajax(a.extend({url:b.impurl,type:b.mtype,data:b.impData,dataType:"json",complete:function(g,h){if(h=="success"){e(g.responseText,b);if(a.isFunction(b.importComplete)){b.importComplete(g)}}g=null}},b.ajaxOptions));break;case"jsonstring":if(b.impstring&&typeof b.impstring=="string"){e(b.impstring,b);if(a.isFunction(b.importComplete)){b.importComplete(b.impstring)}b.impstring=null}break}})},jqGridExport:function(c){c=a.extend({exptype:"xmlstring",root:"grid",ident:"\t"},c||{});var b=null;this.each(function(){if(!this.grid){return}var e=a.extend({},a(this).jqGrid("getGridParam"));if(e.rownumbers){e.colNames.splice(0,1);e.colModel.splice(0,1)}if(e.multiselect){e.colNames.splice(0,1);e.colModel.splice(0,1)}if(e.subGrid){e.colNames.splice(0,1);e.colModel.splice(0,1)}e.knv=null;if(e.treeGrid){for(var d in e.treeReader){if(e.treeReader.hasOwnProperty(d)){e.colNames.splice(e.colNames.length-1);e.colModel.splice(e.colModel.length-1)}}}switch(c.exptype){case"xmlstring":b="<"+c.root+">"+xmlJsonClass.json2xml(e,c.ident)+"</"+c.root+">";break;case"jsonstring":b="{"+xmlJsonClass.toJson(e,c.root,c.ident,false)+"}";if(e.postData.filters!==undefined){b=b.replace(/filters":"/,'filters":');b=b.replace(/}]}"/,"}]}")}break}});return b},excelExport:function(b){b=a.extend({exptype:"remote",url:null,oper:"oper",tag:"excel",exportOptions:{}},b||{});return this.each(function(){if(!this.grid){return}var c;if(b.exptype=="remote"){var d=a.extend({},this.p.postData);d[b.oper]=b.tag;var e=jQuery.param(d);if(b.url.indexOf("?")!=-1){c=b.url+"&"+e}else{c=b.url+"?"+e}window.location=c}})}})})(jQuery);(function($){if($.browser.msie&&$.browser.version==8){$.expr[":"].hidden=function(elem){return elem.offsetWidth===0||elem.offsetHeight===0||elem.style.display=="none"}}$.jgrid._multiselect=false;if($.ui){if($.ui.multiselect){if($.ui.multiselect.prototype._setSelected){var setSelected=$.ui.multiselect.prototype._setSelected;$.ui.multiselect.prototype._setSelected=function(item,selected){var ret=setSelected.call(this,item,selected);if(selected&&this.selectedList){var elt=this.element;this.selectedList.find("li").each(function(){if($(this).data("optionLink")){$(this).data("optionLink").remove().appendTo(elt)}})}return ret}}if($.ui.multiselect.prototype.destroy){$.ui.multiselect.prototype.destroy=function(){this.element.show();this.container.remove();if($.Widget===undefined){$.widget.prototype.destroy.apply(this,arguments)}else{$.Widget.prototype.destroy.apply(this,arguments)}}}$.jgrid._multiselect=true}}$.jgrid.extend({sortableColumns:function(tblrow){return this.each(function(){var ts=this,tid=ts.p.id;function start(){ts.p.disableClick=true}var sortable_opts={tolerance:"pointer",axis:"x",scrollSensitivity:"1",items:">th:not(:has(#jqgh_"+tid+"_cb,#jqgh_"+tid+"_rn,#jqgh_"+tid+"_subgrid),:hidden)",placeholder:{element:function(item){var el=$(document.createElement(item[0].nodeName)).addClass(item[0].className+" ui-sortable-placeholder ui-state-highlight").removeClass("ui-sortable-helper")[0];return el},update:function(self,p){p.height(self.currentItem.innerHeight()-parseInt(self.currentItem.css("paddingTop")||0,10)-parseInt(self.currentItem.css("paddingBottom")||0,10));p.width(self.currentItem.innerWidth()-parseInt(self.currentItem.css("paddingLeft")||0,10)-parseInt(self.currentItem.css("paddingRight")||0,10))}},update:function(event,ui){var p=$(ui.item).parent(),th=$(">th",p),colModel=ts.p.colModel,cmMap={},tid=ts.p.id+"_";$.each(colModel,function(i){cmMap[this.name]=i});var permutation=[];th.each(function(i){var id=$(">div",this).get(0).id.replace(/^jqgh_/,"").replace(tid,"");if(id in cmMap){permutation.push(cmMap[id])}});$(ts).jqGrid("remapColumns",permutation,true,true);if($.isFunction(ts.p.sortable.update)){ts.p.sortable.update(permutation)}setTimeout(function(){ts.p.disableClick=false},50)}};if(ts.p.sortable.options){$.extend(sortable_opts,ts.p.sortable.options)}else{if($.isFunction(ts.p.sortable)){ts.p.sortable={update:ts.p.sortable}}}if(sortable_opts.start){var s=sortable_opts.start;sortable_opts.start=function(e,ui){start();s.call(this,e,ui)}}else{sortable_opts.start=start}if(ts.p.sortable.exclude){sortable_opts.items+=":not("+ts.p.sortable.exclude+")"}tblrow.sortable(sortable_opts).data("sortable").floating=true})},columnChooser:function(opts){var self=this;if($("#colchooser_"+self[0].p.id).length){return}var selector=$('<div id="colchooser_'+self[0].p.id+'" style="position:relative;overflow:hidden"><div><select multiple="multiple"></select></div></div>');var select=$("select",selector);function insert(perm,i,v){if(i>=0){var a=perm.slice();var b=a.splice(i,Math.max(perm.length-i,i));if(i>perm.length){i=perm.length}a[i]=v;return a.concat(b)}}opts=$.extend({width:420,height:240,classname:null,done:function(perm){if(perm){self.jqGrid("remapColumns",perm,true)}},msel:"multiselect",dlog:"dialog",dlog_opts:function(opts){var buttons={};buttons[opts.bSubmit]=function(){opts.apply_perm();opts.cleanup(false)};buttons[opts.bCancel]=function(){opts.cleanup(true)};return{buttons:buttons,close:function(){opts.cleanup(true)},modal:opts.modal?opts.modal:false,resizable:opts.resizable?opts.resizable:true,width:opts.width+20}},apply_perm:function(){$("option",select).each(function(i){if(this.selected){self.jqGrid("showCol",colModel[this.value].name)}else{self.jqGrid("hideCol",colModel[this.value].name)}});var perm=[];$("option[selected]",select).each(function(){perm.push(parseInt(this.value,10))});$.each(perm,function(){delete colMap[colModel[parseInt(this,10)].name]});$.each(colMap,function(){var ti=parseInt(this,10);perm=insert(perm,ti,ti)});if(opts.done){opts.done.call(self,perm)}},cleanup:function(calldone){call(opts.dlog,selector,"destroy");call(opts.msel,select,"destroy");selector.remove();if(calldone&&opts.done){opts.done.call(self)}},msel_opts:{}},$.jgrid.col,opts||{});if($.ui){if($.ui.multiselect){if(opts.msel=="multiselect"){if(!$.jgrid._multiselect){alert("Multiselect plugin loaded after jqGrid. Please load the plugin before the jqGrid!");return}opts.msel_opts=$.extend($.ui.multiselect.defaults,opts.msel_opts)}}}if(opts.caption){selector.attr("title",opts.caption)}if(opts.classname){selector.addClass(opts.classname);select.addClass(opts.classname)}if(opts.width){$(">div",selector).css({width:opts.width,margin:"0 auto"});select.css("width",opts.width)}if(opts.height){$(">div",selector).css("height",opts.height);select.css("height",opts.height-10)}var colModel=self.jqGrid("getGridParam","colModel");var colNames=self.jqGrid("getGridParam","colNames");var colMap={},fixedCols=[];select.empty();$.each(colModel,function(i){colMap[this.name]=i;if(this.hidedlg){if(!this.hidden){fixedCols.push(i)}return}select.append("<option value='"+i+"' "+(this.hidden?"":"selected='selected'")+">"+colNames[i]+"</option>")});function call(fn,obj){if(!fn){return}if(typeof fn=="string"){if($.fn[fn]){$.fn[fn].apply(obj,$.makeArray(arguments).slice(2))}}else{if($.isFunction(fn)){fn.apply(obj,$.makeArray(arguments).slice(2))}}}var dopts=$.isFunction(opts.dlog_opts)?opts.dlog_opts.call(self,opts):opts.dlog_opts;call(opts.dlog,selector,dopts);var mopts=$.isFunction(opts.msel_opts)?opts.msel_opts.call(self,opts):opts.msel_opts;call(opts.msel,select,mopts)},sortableRows:function(opts){return this.each(function(){var $t=this;if(!$t.grid){return}if($t.p.treeGrid){return}if($.fn.sortable){opts=$.extend({cursor:"move",axis:"y",items:".jqgrow"},opts||{});if(opts.start&&$.isFunction(opts.start)){opts._start_=opts.start;delete opts.start}else{opts._start_=false}if(opts.update&&$.isFunction(opts.update)){opts._update_=opts.update;delete opts.update}else{opts._update_=false}opts.start=function(ev,ui){$(ui.item).css("border-width","0px");$("td",ui.item).each(function(i){this.style.width=$t.grid.cols[i].style.width});if($t.p.subGrid){var subgid=$(ui.item).attr("id");try{$($t).jqGrid("collapseSubGridRow",subgid)}catch(e){}}if(opts._start_){opts._start_.apply(this,[ev,ui])}};opts.update=function(ev,ui){$(ui.item).css("border-width","");if($t.p.rownumbers===true){$("td.jqgrid-rownum",$t.rows).each(function(i){$(this).html(i+1)})}if(opts._update_){opts._update_.apply(this,[ev,ui])}};$("tbody:first",$t).sortable(opts);$("tbody:first",$t).disableSelection()}})},gridDnD:function(opts){return this.each(function(){var $t=this;if(!$t.grid){return}if($t.p.treeGrid){return}if(!$.fn.draggable||!$.fn.droppable){return}function updateDnD(){var datadnd=$.data($t,"dnd");$("tr.jqgrow:not(.ui-draggable)",$t).draggable($.isFunction(datadnd.drag)?datadnd.drag.call($($t),datadnd):datadnd.drag)}var appender="<table id='jqgrid_dnd' class='ui-jqgrid-dnd'></table>";if($("#jqgrid_dnd").html()===null){$("body").append(appender)}if(typeof opts=="string"&&opts=="updateDnD"&&$t.p.jqgdnd===true){updateDnD();return}opts=$.extend({drag:function(opts){return $.extend({start:function(ev,ui){if($t.p.subGrid){var subgid=$(ui.helper).attr("id");try{$($t).jqGrid("collapseSubGridRow",subgid)}catch(e){}}for(var i=0;i<$.data($t,"dnd").connectWith.length;i++){if($($.data($t,"dnd").connectWith[i]).jqGrid("getGridParam","reccount")=="0"){$($.data($t,"dnd").connectWith[i]).jqGrid("addRowData","jqg_empty_row",{})}}ui.helper.addClass("ui-state-highlight");$("td",ui.helper).each(function(i){this.style.width=$t.grid.headers[i].width+"px"});if(opts.onstart&&$.isFunction(opts.onstart)){opts.onstart.call($($t),ev,ui)}},stop:function(ev,ui){if(ui.helper.dropped){var ids=$(ui.helper).attr("id");$($t).jqGrid("delRowData",ids)}for(var i=0;i<$.data($t,"dnd").connectWith.length;i++){$($.data($t,"dnd").connectWith[i]).jqGrid("delRowData","jqg_empty_row")}if(opts.onstop&&$.isFunction(opts.onstop)){opts.onstop.call($($t),ev,ui)}}},opts.drag_opts||{})},drop:function(opts){return $.extend({accept:function(d){if(!$(d).hasClass("jqgrow")){return d}var tid=$(d).closest("table.ui-jqgrid-btable");if(tid.length>0&&$.data(tid[0],"dnd")!==undefined){var cn=$.data(tid[0],"dnd").connectWith;return $.inArray("#"+this.id,cn)!=-1?true:false}return d},drop:function(ev,ui){if(!$(ui.draggable).hasClass("jqgrow")){return}var accept=$(ui.draggable).attr("id");var getdata=ui.draggable.parent().parent().jqGrid("getRowData",accept);if(!opts.dropbyname){var j=0,tmpdata={},dropname;var dropmodel=$("#"+this.id).jqGrid("getGridParam","colModel");try{for(var key in getdata){if(getdata.hasOwnProperty(key)&&dropmodel[j]){dropname=dropmodel[j].name;tmpdata[dropname]=getdata[key]}j++}getdata=tmpdata}catch(e){}}ui.helper.dropped=true;if(opts.beforedrop&&$.isFunction(opts.beforedrop)){var datatoinsert=opts.beforedrop.call(this,ev,ui,getdata,$("#"+$t.id),$(this));if(typeof datatoinsert!="undefined"&&datatoinsert!==null&&typeof datatoinsert=="object"){getdata=datatoinsert}}if(ui.helper.dropped){var grid;if(opts.autoid){if($.isFunction(opts.autoid)){grid=opts.autoid.call(this,getdata)}else{grid=Math.ceil(Math.random()*1000);grid=opts.autoidprefix+grid}}$("#"+this.id).jqGrid("addRowData",grid,getdata,opts.droppos)}if(opts.ondrop&&$.isFunction(opts.ondrop)){opts.ondrop.call(this,ev,ui,getdata)}}},opts.drop_opts||{})},onstart:null,onstop:null,beforedrop:null,ondrop:null,drop_opts:{activeClass:"ui-state-active",hoverClass:"ui-state-hover"},drag_opts:{revert:"invalid",helper:"clone",cursor:"move",appendTo:"#jqgrid_dnd",zIndex:5000},dropbyname:false,droppos:"first",autoid:true,autoidprefix:"dnd_"},opts||{});if(!opts.connectWith){return}opts.connectWith=opts.connectWith.split(",");opts.connectWith=$.map(opts.connectWith,function(n){return $.trim(n)});$.data($t,"dnd",opts);if($t.p.reccount!="0"&&!$t.p.jqgdnd){updateDnD()}$t.p.jqgdnd=true;for(var i=0;i<opts.connectWith.length;i++){var cn=opts.connectWith[i];$(cn).droppable($.isFunction(opts.drop)?opts.drop.call($($t),opts):opts.drop)}})},gridResize:function(opts){return this.each(function(){var $t=this;if(!$t.grid||!$.fn.resizable){return}opts=$.extend({},opts||{});if(opts.alsoResize){opts._alsoResize_=opts.alsoResize;delete opts.alsoResize}else{opts._alsoResize_=false}if(opts.stop&&$.isFunction(opts.stop)){opts._stop_=opts.stop;delete opts.stop}else{opts._stop_=false}opts.stop=function(ev,ui){$($t).jqGrid("setGridParam",{height:$("#gview_"+$t.p.id+" .ui-jqgrid-bdiv").height()});$($t).jqGrid("setGridWidth",ui.size.width,opts.shrinkToFit);if(opts._stop_){opts._stop_.call($t,ev,ui)}};if(opts._alsoResize_){var optstest="{'#gview_"+$t.p.id+" .ui-jqgrid-bdiv':true,'"+opts._alsoResize_+"':true}";opts.alsoResize=eval("("+optstest+")")}else{opts.alsoResize=$(".ui-jqgrid-bdiv","#gview_"+$t.p.id)}delete opts._alsoResize_;$("#gbox_"+$t.p.id).resizable(opts)})}})})(jQuery);function tableToGrid(a,b){jQuery(a).each(function(){if(this.grid){return}jQuery(this).width("99%");var n=jQuery(this).width();var p=jQuery("input[type=checkbox]:first",jQuery(this));var h=jQuery("input[type=radio]:first",jQuery(this));var d=p.length>0;var g=!d&&h.length>0;var j=d||g;var l=[];var o=[];jQuery("th",jQuery(this)).each(function(){if(l.length===0&&j){l.push({name:"__selection__",index:"__selection__",width:0,hidden:true});o.push("__selection__")}else{l.push({name:jQuery(this).attr("id")||jQuery.trim(jQuery.jgrid.stripHtml(jQuery(this).html())).split(" ").join("_"),index:jQuery(this).attr("id")||jQuery.trim(jQuery.jgrid.stripHtml(jQuery(this).html())).split(" ").join("_"),width:jQuery(this).width()||150});o.push(jQuery(this).html())}});var f=[];var e=[];var m=[];jQuery("tbody > tr",jQuery(this)).each(function(){var r={};var q=0;jQuery("td",jQuery(this)).each(function(){if(q===0&&j){var s=jQuery("input",jQuery(this));var t=s.attr("value");e.push(t||f.length);if(s.attr("checked")){m.push(t)}r[l[q].name]=s.attr("value")}else{r[l[q].name]=jQuery(this).html()}q++});if(q>0){f.push(r)}});jQuery(this).empty();jQuery(this).addClass("scroll");jQuery(this).jqGrid(jQuery.extend({datatype:"local",width:n,colNames:o,colModel:l,multiselect:d},b||{}));var k;for(k=0;k<f.length;k++){var c=null;if(e.length>0){c=e[k];if(c&&c.replace){c=encodeURIComponent(c).replace(/[.\-%]/g,"_")}}if(c===null){c=k+1}jQuery(this).jqGrid("addRowData",c,f[k])}for(k=0;k<m.length;k++){jQuery(this).jqGrid("setSelection",m[k])}})}var tuiJqgridColSpanInit_kkccddqq=false;jQuery.fn.tuiJqgridColSpan=function(options){options=$.extend({},{UnbindDragEvent:true,cols:null},options);if(options.cols==null||options.cols.length==0){return}var error=false;for(var i=0;i<options.cols.length;i++){var colIndexs=eval("(["+options.cols[i].indexes+"])");for(var j=0;j<colIndexs.length;j++){if(j==colIndexs.length-1){break}if(colIndexs[j]!=colIndexs[j+1]-1){error=true;break}}if(error){break}}if(error){return}var resizing=false,currentMoveObj,startX=0;var tableId=$(this).attr("id");var jqHead=$("table[aria-labelledby='gbox_"+tableId+"']");var jqDiv=$("div#gbox_"+tableId);var oldTr=$("thead tr",jqHead);var oldThs=$("thead tr:first th",jqHead);var ftr=$("<tr/>").css("height","auto").addClass("ui-jqgrid-labels").attr("role","rowheader").insertBefore(oldTr);var ntr=$("<tr/>").addClass("ui-jqgrid-labels").attr("role","rowheader").insertAfter(oldTr);oldThs.each(function(index){var cth=$(this);var cH=cth.css("height"),cW=cth.css("width"),nth=$("<th/>").css("height",cH),fth=$("<th/>").css("height",0);if(($.browser.msie&&$.browser.version=="8.0")||$.browser.mozilla){fth.css({"border-top":"solid 0px #fff","border-bottom":"solid 0px #fff"})}if(cth.css("display")=="none"){nth.css({display:"none","white-space":"nowrap",width:0});fth.css({display:"none","white-space":"nowrap",width:0})}else{nth.css("width",cW);fth.css("width",cW);var res=cth.children("span.ui-jqgrid-resize");res&&res.bind("mousedown",function(e){currentMoveObj=$(this);startX=getEventPos(e).x;resizing=true;document.onselectstart=new Function("return false")})}fth.addClass(cth.attr("class")).attr("role","columnheader").appendTo(ftr);cth.children().clone().appendTo(nth);nth.addClass(cth.attr("class")).attr("role","columnheader").appendTo(ntr)});for(var i=0;i<options.cols.length;i++){var colIndexs=eval("(["+options.cols[i].indexes+"])");var colTitle=options.cols[i].title;var isrowSpan=false;for(var j=0;j<colIndexs.length;j++){oldThs.eq(colIndexs[j]).attr({colSpan:colIndexs.length,rowSpan:"1"});if(j!=0){oldThs.eq(colIndexs[j]).attr("colSpan","1").hide()}$("thead tr:last th",jqHead).eq(colIndexs[j]).attr("tuidel","false");if(j==0){var div=oldThs.eq(colIndexs[j]).find("div.ui-jqgrid-sortable");var divCld=div.children();div.text(colTitle);div.append(divCld)}}}$("thead tr:last th[tuidel!='false']",jqHead).remove();oldThs.each(function(){if($(this).attr("colSpan")==1){$(this).attr("rowSpan",2)}});var jqBody=$(this);$(document).bind("mouseup",function(e){var ret=true;if(resizing){var parentTh=currentMoveObj.parent();var currentIndex=parentTh.parents("tr").find("th").index(parentTh);var width,diff;var tbodyTd=$("tbody tr td",jqBody);var currentTh=$("thead tr:first th",jqHead).eq(currentIndex);if(tbodyTd.length>0){diff=0;width=parseInt(tbodyTd.eq(currentIndex).css("width"))}else{diff=getEventPos(e).x-startX;width=parseInt(currentTh.css("width"))}var lastWidth=diff+width;currentTh.css("width",lastWidth+"px");resizing=false;ret=false}document.onselectstart=new Function("return true");return ret});tuiJqgridColSpanInit_kkccddqq=true;getEvent=function(evt){evt=window.event||evt;if(!evt){var fun=getEvent.caller;while(fun!=null){evt=fun.arguments[0];if(evt&&evt.constructor==Event){break}fun=fun.caller}}return evt};getAbsPos=function(pTarget){var x_=y_=0;if(pTarget.style.position!="absolute"){while(pTarget.offsetParent){x_+=pTarget.offsetLeft;y_+=pTarget.offsetTop;pTarget=pTarget.offsetParent}}x_+=pTarget.offsetLeft;y_+=pTarget.offsetTop;return{x:x_,y:y_}};getEventPos=function(evt){var _x,_y;evt=getEvent(evt);if(evt.pageX||evt.pageY){_x=evt.pageX;_y=evt.pageY}else{if(evt.clientX||evt.clientY){_x=evt.clientX+(document.body.scrollLeft||document.documentElement.scrollLeft)-(document.body.clientLeft||document.documentElement.clientLeft);_y=evt.clientY+(document.body.scrollTop||document.documentElement.scrollTop)-(document.body.clientTop||document.documentElement.clientTop)}else{return getAbsPos(evt.target)}}return{x:_x,y:_y}}};