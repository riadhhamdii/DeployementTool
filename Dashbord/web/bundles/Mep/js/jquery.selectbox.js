(function(c){function b(e,d){var g=c(e).text().toUpperCase();var f=c(d).text().toUpperCase();return(g<f)?-1:(g>f)?1:0}var a={init:function(d){var e={selectedPosition:"right",moveOptions:true,labelTop:"Top",labelBottom:"Bottom",labelUp:"Up",labelDown:"Down",labelSort:"Sort",labelsx:"Available",labeldx:"Selected",maxSelected:-1,autoSort:false,autoSortAvailable:false,search:false,caseSensitive:false,delay:200,optGroupSearch:false,minSize:6};return this.each(function(){var k=c(this);var D=k.data("multiselect2side");if(d){c.extend(e,d)}if(!D){k.data("multiselect2side",e)}var t=c(this).attr("name");if(t.indexOf("[")!=-1){t=t.substring(0,t.indexOf("["))}var g=t+"ms2side__dx";var m=t+"ms2side__sx";var w=c(this).attr("size");if(w<e.minSize){c(this).attr("size",""+e.minSize);w=e.minSize}var h="<div class='ms2side__updown'><p class='SelSort' title='Sort'>"+e.labelSort+"</p><p class='MoveTop' title='Move on top selected option'>"+e.labelTop+"</p><p class='MoveUp' title='Move up selected option'>"+e.labelUp+"</p><p class='MoveDown' title='Move down selected option'>"+e.labelDown+"</p><p class='MoveBottom' title='Move on bottom selected option'>"+e.labelBottom+"</p></div>";var y=false,z=false;if(e.search!=false&&e.optGroupSearch!=false){var A=e.optGroupSearch+"<select class='small' ><option value=__null__> </option></select> "+e.search+"<input class='small' type='text' /><a href='#'> </a>";if(e.selectedPosition=="right"){y=A}else{z=A}}else{if(e.search!=false){var A=e.search+"<input type='text' /><a href='#'> </a>";if(e.selectedPosition=="right"){y=A}else{z=A}}else{if(e.optGroupSearch!=false){var A=e.optGroupSearch+"<select><option value=__null__> </option></select>";if(e.selectedPosition=="right"){y=A}else{z=A}}}}var s="<div class='ms2side__div'>"+((e.selectedPosition!="right"&&e.moveOptions)?h:"")+"<div class='ms2side__select'>"+((e.labelsx||y!=false)?("<div class='ms2side__header'>"+(y!=false?y:e.labelsx)+"</div>"):"")+"<select title='"+e.labelsx+"' name='"+m+"' id='"+m+"' size='"+w+"' multiple='multiple' ></select></div><div class='ms2side__options'>"+((e.selectedPosition=="right")?("<p class='AddOne' title='Add Selected'>&rsaquo;</p><p class='AddAll' title='Add All'>&raquo;</p><p class='RemoveOne' title='Remove Selected'>&lsaquo;</p><p class='RemoveAll' title='Remove All'>&laquo;</p>"):("<p class='AddOne' title='Add Selected'>&lsaquo;</p><p class='AddAll' title='Add All'>&laquo;</p><p class='RemoveOne' title='Remove Selected'>&rsaquo;</p><p class='RemoveAll' title='Remove All'>&raquo;</p>"))+"</div><div class='ms2side__select'>"+((e.labeldx||z!=false)?("<div class='ms2side__header'>"+(z!=false?z:e.labeldx)+"</div>"):"")+"<select title='"+e.labeldx+"' name='"+g+"' id='"+g+"' size='"+w+"' multiple='multiple' ></select></div>"+((e.selectedPosition=="right"&&e.moveOptions)?h:"")+"</div>";k.after(s).hide();var v=k.next().children(".ms2side__select").children("select");var i=(e.selectedPosition=="right")?v.eq(0):v.eq(1);var n=(e.selectedPosition=="right")?v.eq(1):v.eq(0);var j=c(".ms2side__select").eq(0).height();var C=c();var f=c(this).next().find("input:text");var r=f.next().hide();var q=false;var x=false;if(e.optGroupSearch!=false){var p=false;C=c(this).next().find("select").eq(0);k.children("optgroup").each(function(){if(C.find("[value='"+c(this).attr("label")+"']").size()==0){C.append("<option value='"+c(this).attr("label")+"'>"+c(this).attr("label")+"</option>")}});C.change(function(){var E=c(this);if(E.val()!=p){if(f.val()!=""){clearTimeout(q);r.hide();f.val("");x=""}setTimeout(function(){if(E.val()=="__null__"){els=k.find("option:not(:selected)")}else{els=k.find("optgroup[label='"+E.val()+"']").children("option:not(:selected)")}i.find("option").remove();els.each(function(){i.append(c(this).clone())});p=E.val();i.trigger("change")},100)}})}var u=function(){var E=i.children();var F=k.find("option:not(:selected)");p="__null__";C.val("__null__");if(x==f.val()){return}f.addClass("wait").removeAttr("style");x=f.val();setTimeout(function(){i.children().remove();if(x==""){F.clone().appendTo(i).removeAttr("selected");r.hide()}else{F.each(function(){var G=c(this).text();if(e.caseSensitive){find=G.indexOf(x)}else{find=G.toUpperCase().indexOf(x.toUpperCase())}if(find!=-1){c(this).clone().appendTo(i).removeAttr("selected")}});if(i.children().length==0){f.css({border:"1px red solid"})}r.show();i.trigger("change")}i.trigger("change");f.removeClass("wait")},5)};r.click(function(){clearTimeout(q);f.val("");u();return false});f.keyup(function(){clearTimeout(q);q=setTimeout(u,e.delay)});c(this).next().find(".ms2side__options, .ms2side__updown").each(function(){var E=((j/2)-(c(this).height()/2));if(E>0){c(this).css("padding-top",E+"px")}});c(this).find("option:selected").clone().appendTo(n);c(this).find("option:not(:selected)").clone().appendTo(i);if(!(c.browser.msie&&c.browser.version=="6.0")){i.find("option").eq(0).attr("selected",true);n.children().removeAttr("selected")}var B=0;if(e.autoSort){v.change(function(){var E=n.find("option");if(E.length!=B){E.sort(b);k.find("option:selected").remove();E.each(function(){n.append(c(this).clone());c(this).appendTo(k).attr("selected",true)});B=E.length}})}var l=0;if(e.autoSortAvailable){v.change(function(){var E=i.find("option");if(E.length!=l){E.sort(b);i.find("option").remove();E.each(function(){i.append(c(this).clone())});l=E.length}})}v.change(function(){if(c.browser.msie&&c.browser.version=="6.0"){k.show().hide()}var I=c(this).parent().parent();var F=i.children();var H=n.children();var E=i.find("option:selected");var G=n.find("option:selected");if(E.size()==0||(e.maxSelected>=0&&(E.size()+H.size())>e.maxSelected)){I.find(".AddOne").addClass("ms2side__hide")}else{I.find(".AddOne").removeClass("ms2side__hide")}I.find(".RemoveOne, .MoveUp, .MoveDown, .MoveTop, .MoveBottom, .SelSort").addClass("ms2side__hide");if(H.size()>1){I.find(".SelSort").removeClass("ms2side__hide")}if(G.size()>0){I.find(".RemoveOne").removeClass("ms2side__hide");if(G.size()<H.size()){if(G.val()!=H.val()){I.find(".MoveUp, .MoveTop").removeClass("ms2side__hide")}if(G.last().val()!=H.last().val()){I.find(".MoveDown, .MoveBottom").removeClass("ms2side__hide")}}}if(F.size()==0||(e.maxSelected>=0&&F.size()>=e.maxSelected)){I.find(".AddAll").addClass("ms2side__hide")}else{I.find(".AddAll").removeClass("ms2side__hide")}if(H.size()==0){I.find(".RemoveAll").addClass("ms2side__hide")}else{I.find(".RemoveAll").removeClass("ms2side__hide")}});i.dblclick(function(){c(this).find("option:selected").each(function(E,F){if(e.maxSelected<0||n.children().size()<e.maxSelected){c(this).remove().appendTo(n);k.find("[value='"+c(F).val()+"']").remove().appendTo(k).attr("selected",true)}});c(this).trigger("change")});n.dblclick(function(){c(this).find("option:selected").each(function(E,F){c(this).remove().appendTo(i);k.find("[value='"+c(F).val()+"']").removeAttr("selected").remove().appendTo(k)});c(this).trigger("change");C.val("__null__").trigger("change");r.click()});c(this).next().find(".ms2side__options").children().click(function(){if(!c(this).hasClass("ms2side__hide")){if(c(this).hasClass("AddOne")){i.find("option:selected").each(function(E,F){c(this).remove().appendTo(n);k.find("[value='"+c(F).val()+"']").remove().appendTo(k).attr("selected",true)})}else{if(c(this).hasClass("AddAll")){if(r.is(":visible")||(C.length>0&&C.val()!="__null__")){i.children().each(function(E,F){c(this).remove().appendTo(n);k.find("[value='"+c(F).val()+"']").remove().appendTo(k).attr("selected",true)})}else{i.children().remove().appendTo(n);k.find("option").attr("selected",true)}}else{if(c(this).hasClass("RemoveOne")){n.find("option:selected").each(function(E,F){$p=parseInt(c(this).attr("p"));$pos=$p-1;i.find("option").each(function(){if((parseInt(c(this).attr("p"))<$p)&&(parseInt(c(this).attr("p"))>$pos)){$pos=parseInt(c(this).attr("p"))}});$new=c(this).clone();c(this).remove();if(($pos==($p-1))||(i.children().length==0)){i.prepend($new)}else{i.find('option[p="'+$pos+'"]').after($new)}k.find("[value='"+c(F).val()+"']").remove().appendTo(k).removeAttr("selected")});r.click();C.val("__null__").trigger("change")}else{if(c(this).hasClass("RemoveAll")){n.children().each(function(){$p=parseInt(c(this).attr("p"));$pos=$p-1;i.find("option").each(function(){if((parseInt(c(this).attr("p"))<$p)&&(parseInt(c(this).attr("p"))>$pos)){$pos=parseInt(c(this).attr("p"))}});$new=c(this).clone();c(this).remove();if(($pos==($p-1))||(i.children().length==0)){i.prepend($new)}else{i.find('option[p="'+$pos+'"]').after($new)}});n.children().remove();k.find("option").removeAttr("selected");r.click();C.val("__null__").trigger("change")}}}}}i.trigger("change")});c(this).next().find(".ms2side__updown").children().click(function(){var G=n.find("option:selected");var N=n.find("option");if(!c(this).hasClass("ms2side__hide")){if(c(this).hasClass("SelSort")){N.sort(b);k.find("option:selected").remove();N.each(function(){n.append(c(this).clone().attr("selected",true));k.append(c(this).attr("selected",true))})}else{if(c(this).hasClass("MoveUp")){var H=G.first().prev();var K=k.find("[value='"+H.val()+"']");G.each(function(){c(this).insertBefore(H);k.find("[value='"+c(this).val()+"']").insertBefore(K)})}else{if(c(this).hasClass("MoveDown")){var J=G.last().next();var L=k.find("[value='"+J.val()+"']");G.each(function(){c(this).insertAfter(J);k.find("[value='"+c(this).val()+"']").insertAfter(L)})}else{if(c(this).hasClass("MoveTop")){var I=N.first();var F=k.find("[value='"+I.val()+"']");G.each(function(){c(this).insertBefore(I);k.find("[value='"+c(this).val()+"']").insertBefore(F)})}else{if(c(this).hasClass("MoveBottom")){var M=N.last();var E=k.find("[value='"+M.val()+"']");G.each(function(){M=c(this).insertAfter(M);E=k.find("[value='"+c(this).val()+"']").insertAfter(E)})}}}}}}i.trigger("change")});c(this).next().find(".ms2side__options, .ms2side__updown").children().hover(function(){c(this).addClass("ms2side_hover")},function(){c(this).removeClass("ms2side_hover")});i.trigger("change");c(this).next().show()})},destroy:function(){return this.each(function(){var d=c(this);var e=d.data("multiselect2side");if(!e){return}if(d.show().next().hasClass("ms2side__div")){d.show().next().remove()}})},destroy1:function(e){var d=c(this);d.find("option[value="+e.value+"]").remove()},addOption:function(d){var e={name:false,value:false,selected:false};return this.each(function(){var j=c(this);var k=j.data("multiselect2side");if(!k){return}if(d){c.extend(e,d)}var i="<option p='"+e.id+"' value='"+e.value+"' "+(e.selected?"selected":"")+" >"+e.name+"</option>";j.append(i);var g=j.next().children(".ms2side__select").children("select");var f=(k.selectedPosition=="right")?g.eq(0):g.eq(1);var h=(k.selectedPosition=="right")?g.eq(1):g.eq(0);if(e.selected){h.append(i).trigger("change")}else{f.append(i).trigger("change")}})}};c.fn.multiselect2side=function(d){if(d.type==1){return}if(a[d]){return a[d].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof d==="object"||!d){return a.init.apply(this,arguments)}else{c.error("Method "+d+" does not exist on jQuery.multiselect2side")}}}})(jQuery);$.fn.validateMax=function(a,b){o=this;o.find("option").click(function(){if(o.find("option:selected").length>a.Max){$.validationEngine.buildPrompt($(this),"le nombre maximale est "+a.Max,"error");$(this).parent().find("option").click(function(){$.validationEngine.closePrompt(".formError",true)})}})};$.fn.validateMin=function(a,c){var b=this;b.find("option").click(function(){if(b.find("option:selected").length<a.Min){$.validationEngine.buildPrompt($(this),"le nombre minimale est "+a.Min,"error");$(this).parent().find("option").click(function(){$.validationEngine.closePrompt(".formError",true)})}})};
